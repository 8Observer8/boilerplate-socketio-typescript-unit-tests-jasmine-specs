(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;for(var i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],2:[function(require,module,exports){},{}],3:[function(require,module,exports){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}},{"base64-js":1,ieee754:4}],4:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],5:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],6:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return punycode})}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],7:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],8:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],9:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":7,"./encode":8}],10:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick;var apply=Function.prototype.apply;var slice=Array.prototype.slice;var immediateIds={};var nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout(function onTimeout(){if(item._onTimeout)item._onTimeout()},msecs)}};exports.setImmediate=typeof setImmediate==="function"?setImmediate:function(fn){var id=nextImmediateId++;var args=arguments.length<2?false:slice.call(arguments,1);immediateIds[id]=true;nextTick(function onNextTick(){if(immediateIds[id]){if(args){fn.apply(null,args)}else{fn.call(null)}exports.clearImmediate(id)}});return id};exports.clearImmediate=typeof clearImmediate==="function"?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":5,timers:10}],11:[function(require,module,exports){"use strict";var punycode=require("punycode");var util=require("./util");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(parseQueryString){this.search="";this.query={}}return this}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname)}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1)continue;var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(util.isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&util.isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query)}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)});search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol")result[rkey]=relative[rkey]}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/"}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host)}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(!srcPath.length){result.pathname=null;result.path=null}else{result.pathname=srcPath.join("/")}if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)this.hostname=host}},{"./util":12,punycode:6,querystring:9}],12:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return typeof arg==="string"},isObject:function(arg){return typeof arg==="object"&&arg!==null},isNull:function(arg){return arg===null},isNullOrUndefined:function(arg){return arg==null}}},{}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var utils=require("@pixi/utils");var display=require("@pixi/display");var accessibleTarget={accessible:false,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:false,_accessibleDiv:false};display.DisplayObject.mixin(accessibleTarget);var KEY_CODE_TAB=9;var DIV_TOUCH_SIZE=100;var DIV_TOUCH_POS_X=0;var DIV_TOUCH_POS_Y=0;var DIV_TOUCH_ZINDEX=2;var DIV_HOOK_SIZE=1;var DIV_HOOK_POS_X=-1e3;var DIV_HOOK_POS_Y=-1e3;var DIV_HOOK_ZINDEX=2;var AccessibilityManager=function AccessibilityManager(renderer){this._hookDiv=null;if(utils.isMobile.tablet||utils.isMobile.phone){this.createTouchHook()}var div=document.createElement("div");div.style.width=DIV_TOUCH_SIZE+"px";div.style.height=DIV_TOUCH_SIZE+"px";div.style.position="absolute";div.style.top=DIV_TOUCH_POS_X+"px";div.style.left=DIV_TOUCH_POS_Y+"px";div.style.zIndex=DIV_TOUCH_ZINDEX;this.div=div;this.pool=[];this.renderId=0;this.debug=false;this.renderer=renderer;this.children=[];this._onKeyDown=this._onKeyDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this.isActive=false;this.isMobileAccessibility=false;window.addEventListener("keydown",this._onKeyDown,false)};AccessibilityManager.prototype.createTouchHook=function createTouchHook(){var this$1=this;var hookDiv=document.createElement("button");hookDiv.style.width=DIV_HOOK_SIZE+"px";hookDiv.style.height=DIV_HOOK_SIZE+"px";hookDiv.style.position="absolute";hookDiv.style.top=DIV_HOOK_POS_X+"px";hookDiv.style.left=DIV_HOOK_POS_Y+"px";hookDiv.style.zIndex=DIV_HOOK_ZINDEX;hookDiv.style.backgroundColor="#FF0000";hookDiv.title="HOOK DIV";hookDiv.addEventListener("focus",function(){this$1.isMobileAccessibility=true;this$1.activate();this$1.destroyTouchHook()});document.body.appendChild(hookDiv);this._hookDiv=hookDiv};AccessibilityManager.prototype.destroyTouchHook=function destroyTouchHook(){if(!this._hookDiv){return}document.body.removeChild(this._hookDiv);this._hookDiv=null};AccessibilityManager.prototype.activate=function activate(){if(this.isActive){return}this.isActive=true;window.document.addEventListener("mousemove",this._onMouseMove,true);window.removeEventListener("keydown",this._onKeyDown,false);this.renderer.on("postrender",this.update,this);if(this.renderer.view.parentNode){this.renderer.view.parentNode.appendChild(this.div)}};AccessibilityManager.prototype.deactivate=function deactivate(){if(!this.isActive||this.isMobileAccessibility){return}this.isActive=false;window.document.removeEventListener("mousemove",this._onMouseMove,true);window.addEventListener("keydown",this._onKeyDown,false);this.renderer.off("postrender",this.update);if(this.div.parentNode){this.div.parentNode.removeChild(this.div)}};AccessibilityManager.prototype.updateAccessibleObjects=function updateAccessibleObjects(displayObject){if(!displayObject.visible){return}if(displayObject.accessible&&displayObject.interactive){if(!displayObject._accessibleActive){this.addChild(displayObject)}displayObject.renderId=this.renderId}var children=displayObject.children;for(var i=0;i<children.length;i++){this.updateAccessibleObjects(children[i])}};AccessibilityManager.prototype.update=function update(){if(!this.renderer.renderingToScreen){return}this.updateAccessibleObjects(this.renderer._lastObjectRendered);var rect=this.renderer.view.getBoundingClientRect();var sx=rect.width/this.renderer.width;var sy=rect.height/this.renderer.height;var div=this.div;div.style.left=rect.left+"px";div.style.top=rect.top+"px";div.style.width=this.renderer.width+"px";div.style.height=this.renderer.height+"px";for(var i=0;i<this.children.length;i++){var child=this.children[i];if(child.renderId!==this.renderId){child._accessibleActive=false;utils.removeItems(this.children,i,1);this.div.removeChild(child._accessibleDiv);this.pool.push(child._accessibleDiv);child._accessibleDiv=null;i--;if(this.children.length===0){this.deactivate()}}else{div=child._accessibleDiv;var hitArea=child.hitArea;var wt=child.worldTransform;if(child.hitArea){div.style.left=(wt.tx+hitArea.x*wt.a)*sx+"px";div.style.top=(wt.ty+hitArea.y*wt.d)*sy+"px";div.style.width=hitArea.width*wt.a*sx+"px";div.style.height=hitArea.height*wt.d*sy+"px"}else{hitArea=child.getBounds();this.capHitArea(hitArea);div.style.left=hitArea.x*sx+"px";div.style.top=hitArea.y*sy+"px";div.style.width=hitArea.width*sx+"px";div.style.height=hitArea.height*sy+"px";if(div.title!==child.accessibleTitle&&child.accessibleTitle!==null){div.title=child.accessibleTitle}if(div.getAttribute("aria-label")!==child.accessibleHint&&child.accessibleHint!==null){div.setAttribute("aria-label",child.accessibleHint)}}}}this.renderId++};AccessibilityManager.prototype.capHitArea=function capHitArea(hitArea){if(hitArea.x<0){hitArea.width+=hitArea.x;hitArea.x=0}if(hitArea.y<0){hitArea.height+=hitArea.y;hitArea.y=0}if(hitArea.x+hitArea.width>this.renderer.width){hitArea.width=this.renderer.width-hitArea.x}if(hitArea.y+hitArea.height>this.renderer.height){hitArea.height=this.renderer.height-hitArea.y}};AccessibilityManager.prototype.addChild=function addChild(displayObject){var div=this.pool.pop();if(!div){div=document.createElement("button");div.style.width=DIV_TOUCH_SIZE+"px";div.style.height=DIV_TOUCH_SIZE+"px";div.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent";div.style.position="absolute";div.style.zIndex=DIV_TOUCH_ZINDEX;div.style.borderStyle="none";if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){div.setAttribute("aria-live","off")}else{div.setAttribute("aria-live","polite")}if(navigator.userAgent.match(/rv:.*Gecko\//)){div.setAttribute("aria-relevant","additions")}else{div.setAttribute("aria-relevant","text")}div.addEventListener("click",this._onClick.bind(this));div.addEventListener("focus",this._onFocus.bind(this));div.addEventListener("focusout",this._onFocusOut.bind(this))}if(displayObject.accessibleTitle&&displayObject.accessibleTitle!==null){div.title=displayObject.accessibleTitle}else if(!displayObject.accessibleHint||displayObject.accessibleHint===null){div.title="displayObject "+displayObject.tabIndex}if(displayObject.accessibleHint&&displayObject.accessibleHint!==null){div.setAttribute("aria-label",displayObject.accessibleHint)}displayObject._accessibleActive=true;displayObject._accessibleDiv=div;div.displayObject=displayObject;this.children.push(displayObject);this.div.appendChild(displayObject._accessibleDiv);displayObject._accessibleDiv.tabIndex=displayObject.tabIndex};AccessibilityManager.prototype._onClick=function _onClick(e){var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"click",interactionManager.eventData)};AccessibilityManager.prototype._onFocus=function _onFocus(e){if(!e.target.getAttribute("aria-live","off")){e.target.setAttribute("aria-live","assertive")}var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseover",interactionManager.eventData)};AccessibilityManager.prototype._onFocusOut=function _onFocusOut(e){if(!e.target.getAttribute("aria-live","off")){e.target.setAttribute("aria-live","polite")}var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseout",interactionManager.eventData)};AccessibilityManager.prototype._onKeyDown=function _onKeyDown(e){if(e.keyCode!==KEY_CODE_TAB){return}this.activate()};AccessibilityManager.prototype._onMouseMove=function _onMouseMove(e){if(e.movementX===0&&e.movementY===0){return}this.deactivate()};AccessibilityManager.prototype.destroy=function destroy(){this.destroyTouchHook();this.div=null;for(var i=0;i<this.children.length;i++){this.children[i].div=null}window.document.removeEventListener("mousemove",this._onMouseMove,true);window.removeEventListener("keydown",this._onKeyDown);this.pool=null;this.children=null;this.renderer=null};exports.AccessibilityManager=AccessibilityManager;exports.accessibleTarget=accessibleTarget},{"@pixi/display":17,"@pixi/utils":46}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var display=require("@pixi/display");var core=require("@pixi/core");var Application=function Application(options){var this$1=this;options=Object.assign({forceCanvas:false},options);this.renderer=core.autoDetectRenderer(options);this.stage=new display.Container;Application._plugins.forEach(function(plugin){plugin.init.call(this$1,options)})};var prototypeAccessors={view:{configurable:true},screen:{configurable:true}};Application.registerPlugin=function registerPlugin(plugin){Application._plugins.push(plugin)};Application.prototype.render=function render(){this.renderer.render(this.stage)};prototypeAccessors.view.get=function(){return this.renderer.view};prototypeAccessors.screen.get=function(){return this.renderer.screen};Application.prototype.destroy=function destroy(removeView){var this$1=this;var plugins=Application._plugins.slice(0);plugins.reverse();plugins.forEach(function(plugin){plugin.destroy.call(this$1)});this.stage.destroy();this.stage=null;this.renderer.destroy(removeView);this.renderer=null;this._options=null};Object.defineProperties(Application.prototype,prototypeAccessors);Application._plugins=[];var ResizePlugin=function ResizePlugin(){};ResizePlugin.init=function init(options){var this$1=this;Object.defineProperty(this,"resizeTo",{set:function set(dom){window.removeEventListener("resize",this.resize);this._resizeTo=dom;if(dom){window.addEventListener("resize",this.resize);this.resize()}},get:function get(){return this._resizeTo}});this.resize=function(){if(this$1._resizeTo){if(this$1._resizeTo===window){this$1.renderer.resize(window.innerWidth,window.innerHeight)}else{this$1.renderer.resize(this$1._resizeTo.clientWidth,this$1._resizeTo.clientHeight)}}};this._resizeTo=null;this.resizeTo=options.resizeTo||null};ResizePlugin.destroy=function destroy(){this.resizeTo=null;this.resize=null};Application.registerPlugin(ResizePlugin);exports.Application=Application},{"@pixi/core":16,"@pixi/display":17}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ENV={WEBGL_LEGACY:0,WEBGL:1,WEBGL2:2};var RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2};var BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19,NONE:20,SRC_OVER:0,SRC_IN:21,SRC_OUT:22,SRC_ATOP:23,DST_OVER:24,DST_IN:25,DST_OUT:26,DST_ATOP:27,ERASE:26,SUBTRACT:28};var DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};var FORMATS={RGBA:6408,RGB:6407,ALPHA:6406,LUMINANCE:6409,LUMINANCE_ALPHA:6410,DEPTH_COMPONENT:6402,DEPTH_STENCIL:34041};var TARGETS={TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_2D_ARRAY:35866,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074};var TYPES={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,FLOAT:5126,HALF_FLOAT:36193};var SCALE_MODES={LINEAR:1,NEAREST:0};var WRAP_MODES={CLAMP:33071,REPEAT:10497,MIRRORED_REPEAT:33648};var MIPMAP_MODES={OFF:0,POW2:1,ON:2};var GC_MODES={AUTO:0,MANUAL:1};var PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};exports.BLEND_MODES=BLEND_MODES;exports.DRAW_MODES=DRAW_MODES;exports.ENV=ENV;exports.FORMATS=FORMATS;exports.GC_MODES=GC_MODES;exports.MIPMAP_MODES=MIPMAP_MODES;exports.PRECISION=PRECISION;exports.RENDERER_TYPE=RENDERER_TYPE;exports.SCALE_MODES=SCALE_MODES;exports.TARGETS=TARGETS;exports.TYPES=TYPES;exports.WRAP_MODES=WRAP_MODES},{}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var runner=require("@pixi/runner");var utils=require("@pixi/utils");var settings=require("@pixi/settings");var constants=require("@pixi/constants");var ticker=require("@pixi/ticker");var math=require("@pixi/math");var display=require("@pixi/display");var Resource=function Resource(width,height){if(width===void 0)width=0;if(height===void 0)height=0;this._width=width;this._height=height;this.destroyed=false;this.internal=false;this.onResize=new runner.Runner("setRealSize",2);this.onUpdate=new runner.Runner("update")};var prototypeAccessors={valid:{configurable:true},width:{configurable:true},height:{configurable:true}};Resource.prototype.bind=function bind(baseTexture){this.onResize.add(baseTexture);this.onUpdate.add(baseTexture);if(this._width||this._height){this.onResize.run(this._width,this._height)}};Resource.prototype.unbind=function unbind(baseTexture){this.onResize.remove(baseTexture);this.onUpdate.remove(baseTexture)};Resource.prototype.resize=function resize(width,height){if(width!==this._width||height!==this._height){this._width=width;this._height=height;this.onResize.run(width,height)}};prototypeAccessors.valid.get=function(){return!!this._width&&!!this._height};Resource.prototype.update=function update(){if(!this.destroyed){this.onUpdate.run()}};Resource.prototype.load=function load(){return Promise.resolve()};prototypeAccessors.width.get=function(){return this._width};prototypeAccessors.height.get=function(){return this._height};Resource.prototype.upload=function upload(renderer,baseTexture,glTexture){return false};Resource.prototype.style=function style(renderer,baseTexture,glTexture){return false};Resource.prototype.dispose=function dispose(){};Resource.prototype.destroy=function destroy(){if(!this.destroyed){this.onResize.removeAll();this.onResize=null;this.onUpdate.removeAll();this.onUpdate=null;this.destroyed=true;this.dispose()}};Object.defineProperties(Resource.prototype,prototypeAccessors);var BaseImageResource=function(Resource){function BaseImageResource(source){var width=source.naturalWidth||source.videoWidth||source.width;var height=source.naturalHeight||source.videoHeight||source.height;Resource.call(this,width,height);this.source=source}if(Resource)BaseImageResource.__proto__=Resource;BaseImageResource.prototype=Object.create(Resource&&Resource.prototype);BaseImageResource.prototype.constructor=BaseImageResource;BaseImageResource.crossOrigin=function crossOrigin(element,url,crossorigin){if(crossorigin===undefined&&url.indexOf("data:")!==0){element.crossOrigin=utils.determineCrossOrigin(url)}else if(crossorigin!==false){element.crossOrigin=typeof crossorigin==="string"?crossorigin:"anonymous"}};BaseImageResource.prototype.upload=function upload(renderer,baseTexture,glTexture,source){var gl=renderer.gl;var width=baseTexture.realWidth;var height=baseTexture.realHeight;source=source||this.source;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.premultiplyAlpha);if(baseTexture.target===gl.TEXTURE_2D&&glTexture.width===width&&glTexture.height===height){gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,baseTexture.format,baseTexture.type,source)}else{glTexture.width=width;glTexture.height=height;gl.texImage2D(baseTexture.target,0,baseTexture.format,baseTexture.format,baseTexture.type,source)}return true};BaseImageResource.prototype.update=function update(){if(this.destroyed){return}var width=this.source.naturalWidth||this.source.videoWidth||this.source.width;var height=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(width,height);Resource.prototype.update.call(this)};BaseImageResource.prototype.dispose=function dispose(){this.source=null};return BaseImageResource}(Resource);var ImageResource=function(BaseImageResource){function ImageResource(source,options){options=options||{};if(!(source instanceof HTMLImageElement)){var imageElement=new Image;BaseImageResource.crossOrigin(imageElement,source,options.crossorigin);imageElement.src=source;source=imageElement}BaseImageResource.call(this,source);this.url=source.src;this._process=null;this.preserveBitmap=false;this.createBitmap=(options.createBitmap!==undefined?options.createBitmap:settings.settings.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap;this.premultiplyAlpha=options.premultiplyAlpha!==false;this.bitmap=null;this._load=null;if(options.autoLoad!==false){this.load()}}if(BaseImageResource)ImageResource.__proto__=BaseImageResource;ImageResource.prototype=Object.create(BaseImageResource&&BaseImageResource.prototype);ImageResource.prototype.constructor=ImageResource;ImageResource.prototype.load=function load(createBitmap){var this$1=this;if(createBitmap!==undefined){this.createBitmap=createBitmap}if(this._load){return this._load}this._load=new Promise(function(resolve){this$1.url=this$1.source.src;var ref=this$1;var source=ref.source;var completed=function(){if(this$1.destroyed){return}source.onload=null;source.onerror=null;this$1.resize(source.width,source.height);this$1._load=null;if(this$1.createBitmap){resolve(this$1.process())}else{resolve(this$1)}};if(source.complete&&source.src){completed()}else{source.onload=completed}});return this._load};ImageResource.prototype.process=function process(){var this$1=this;if(this._process!==null){return this._process}if(this.bitmap!==null||!window.createImageBitmap){return Promise.resolve(this)}this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha?"premultiply":"none"}).then(function(bitmap){if(this$1.destroyed){return Promise.reject()}this$1.bitmap=bitmap;this$1.update();this$1._process=null;return Promise.resolve(this$1)});return this._process};ImageResource.prototype.upload=function upload(renderer,baseTexture,glTexture){baseTexture.premultiplyAlpha=this.premultiplyAlpha;if(!this.createBitmap){return BaseImageResource.prototype.upload.call(this,renderer,baseTexture,glTexture)}if(!this.bitmap){this.process();if(!this.bitmap){return false}}BaseImageResource.prototype.upload.call(this,renderer,baseTexture,glTexture,this.bitmap);if(!this.preserveBitmap){var flag=true;for(var key in baseTexture._glTextures){var otherTex=baseTexture._glTextures[key];if(otherTex!==glTexture&&otherTex.dirtyId!==baseTexture.dirtyId){flag=false;break}}if(flag){if(this.bitmap.close){this.bitmap.close()}this.bitmap=null}}return true};ImageResource.prototype.dispose=function dispose(){BaseImageResource.prototype.dispose.call(this);if(this.bitmap){this.bitmap.close();this.bitmap=null}this._process=null;this._load=null};return ImageResource}(BaseImageResource);var INSTALLED=[];function autoDetectResource(source,options){if(!source){return null}var extension="";if(typeof source==="string"){var result=/\.(\w{3,4})(?:$|\?|#)/i.exec(source);if(result){extension=result[1].toLowerCase()}}for(var i=INSTALLED.length-1;i>=0;--i){var ResourcePlugin=INSTALLED[i];if(ResourcePlugin.test&&ResourcePlugin.test(source,extension)){return new ResourcePlugin(source,options)}}return new ImageResource(source,options)}var BufferResource=function(Resource){function BufferResource(source,options){var ref=options||{};var width=ref.width;var height=ref.height;if(!width||!height){throw new Error("BufferResource width or height invalid")}Resource.call(this,width,height);this.data=source}if(Resource)BufferResource.__proto__=Resource;BufferResource.prototype=Object.create(Resource&&Resource.prototype);BufferResource.prototype.constructor=BufferResource;BufferResource.prototype.upload=function upload(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.premultiplyAlpha);if(glTexture.width===baseTexture.width&&glTexture.height===baseTexture.height){gl.texSubImage2D(baseTexture.target,0,0,0,baseTexture.width,baseTexture.height,baseTexture.format,baseTexture.type,this.data)}else{glTexture.width=baseTexture.width;glTexture.height=baseTexture.height;var internalFormat=baseTexture.format;if(renderer.context.webGLVersion===2&&baseTexture.type===renderer.gl.FLOAT&&baseTexture.format===renderer.gl.RGBA){internalFormat=renderer.gl.RGBA32F}gl.texImage2D(baseTexture.target,0,internalFormat,baseTexture.width,baseTexture.height,0,baseTexture.format,baseTexture.type,this.data)}return true};BufferResource.prototype.dispose=function dispose(){this.data=null};BufferResource.test=function test(source){return source instanceof Float32Array||source instanceof Uint8Array||source instanceof Uint32Array};return BufferResource}(Resource);var defaultBufferOptions={scaleMode:constants.SCALE_MODES.NEAREST,format:constants.FORMATS.RGBA,premultiplyAlpha:false};var BaseTexture=function(EventEmitter){function BaseTexture(resource,options){if(resource===void 0)resource=null;if(options===void 0)options=null;EventEmitter.call(this);options=options||{};var premultiplyAlpha=options.premultiplyAlpha;var mipmap=options.mipmap;var scaleMode=options.scaleMode;var width=options.width;var height=options.height;var wrapMode=options.wrapMode;var format=options.format;var type=options.type;var target=options.target;var resolution=options.resolution;var resourceOptions=options.resourceOptions;if(resource&&!(resource instanceof Resource)){resource=autoDetectResource(resource,resourceOptions);resource.internal=true}this.width=width||0;this.height=height||0;this.resolution=resolution||settings.settings.RESOLUTION;this.mipmap=mipmap!==undefined?mipmap:settings.settings.MIPMAP_TEXTURES;this.wrapMode=wrapMode||settings.settings.WRAP_MODE;this.scaleMode=scaleMode!==undefined?scaleMode:settings.settings.SCALE_MODE;this.format=format||constants.FORMATS.RGBA;this.type=type||constants.TYPES.UNSIGNED_BYTE;this.target=target||constants.TARGETS.TEXTURE_2D;this.premultiplyAlpha=premultiplyAlpha!==false;this.uid=utils.uid();this.touched=0;this.isPowerOfTwo=false;this._refreshPOT();this._glTextures={};this.dirtyId=0;this.dirtyStyleId=0;this.cacheId=null;this.valid=width>0&&height>0;this.textureCacheIds=[];this.destroyed=false;this.resource=null;this._batchEnabled=0;this.setResource(resource)}if(EventEmitter)BaseTexture.__proto__=EventEmitter;BaseTexture.prototype=Object.create(EventEmitter&&EventEmitter.prototype);BaseTexture.prototype.constructor=BaseTexture;var prototypeAccessors={realWidth:{configurable:true},realHeight:{configurable:true}};prototypeAccessors.realWidth.get=function(){return this.width*this.resolution};prototypeAccessors.realHeight.get=function(){return this.height*this.resolution};BaseTexture.prototype.setStyle=function setStyle(scaleMode,mipmap){var dirty;if(scaleMode!==undefined&&scaleMode!==this.scaleMode){this.scaleMode=scaleMode;dirty=true}if(mipmap!==undefined&&mipmap!==this.mipmap){this.mipmap=mipmap;dirty=true}if(dirty){this.dirtyStyleId++}return this};BaseTexture.prototype.setSize=function setSize(width,height,resolution){this.resolution=resolution||this.resolution;this.width=width;this.height=height;this._refreshPOT();this.update();return this};BaseTexture.prototype.setRealSize=function setRealSize(realWidth,realHeight,resolution){this.resolution=resolution||this.resolution;this.width=realWidth/this.resolution;this.height=realHeight/this.resolution;this._refreshPOT();this.update();return this};BaseTexture.prototype._refreshPOT=function _refreshPOT(){this.isPowerOfTwo=utils.isPow2(this.realWidth)&&utils.isPow2(this.realHeight)};BaseTexture.prototype.setResolution=function setResolution(resolution){var oldResolution=this.resolution;if(oldResolution===resolution){return this}this.resolution=resolution;if(this.valid){this.width=this.width*oldResolution/resolution;this.height=this.height*oldResolution/resolution;this.emit("update",this)}this._refreshPOT();return this};BaseTexture.prototype.setResource=function setResource(resource){if(this.resource===resource){return this}if(this.resource){throw new Error("Resource can be set only once")}resource.bind(this);this.resource=resource;return this};BaseTexture.prototype.update=function update(){if(!this.valid){if(this.width>0&&this.height>0){this.valid=true;this.emit("loaded",this);this.emit("update",this)}}else{this.dirtyId++;this.dirtyStyleId++;this.emit("update",this)}};BaseTexture.prototype.destroy=function destroy(){if(this.resource){this.resource.unbind(this);if(this.resource.internal){this.resource.destroy()}this.resource=null}if(this.cacheId){delete utils.BaseTextureCache[this.cacheId];delete utils.TextureCache[this.cacheId];this.cacheId=null}this.dispose();BaseTexture.removeFromCache(this);this.textureCacheIds=null;this.destroyed=true};BaseTexture.prototype.dispose=function dispose(){this.emit("dispose",this)};BaseTexture.from=function from(source,options){var cacheId=null;if(typeof source==="string"){cacheId=source}else{if(!source._pixiId){source._pixiId="pixiid_"+utils.uid()}cacheId=source._pixiId}var baseTexture=utils.BaseTextureCache[cacheId];if(!baseTexture){baseTexture=new BaseTexture(source,options);baseTexture.cacheId=cacheId;BaseTexture.addToCache(baseTexture,cacheId)}return baseTexture};BaseTexture.fromBuffer=function fromBuffer(buffer,width,height,options){buffer=buffer||new Float32Array(width*height*4);var resource=new BufferResource(buffer,{width:width,height:height});var type=buffer instanceof Float32Array?constants.TYPES.FLOAT:constants.TYPES.UNSIGNED_BYTE;return new BaseTexture(resource,Object.assign(defaultBufferOptions,options||{width:width,height:height,type:type}))};BaseTexture.addToCache=function addToCache(baseTexture,id){if(id){if(baseTexture.textureCacheIds.indexOf(id)===-1){baseTexture.textureCacheIds.push(id)}if(utils.BaseTextureCache[id]){console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry")}utils.BaseTextureCache[id]=baseTexture}};BaseTexture.removeFromCache=function removeFromCache(baseTexture){if(typeof baseTexture==="string"){var baseTextureFromCache=utils.BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);if(index>-1){baseTextureFromCache.textureCacheIds.splice(index,1)}delete utils.BaseTextureCache[baseTexture];return baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i){delete utils.BaseTextureCache[baseTexture.textureCacheIds[i]]}baseTexture.textureCacheIds.length=0;return baseTexture}return null};Object.defineProperties(BaseTexture.prototype,prototypeAccessors);return BaseTexture}(utils.EventEmitter);BaseTexture._globalBatch=0;var ArrayResource=function(Resource){function ArrayResource(source,options){options=options||{};var urls;var length=source;if(Array.isArray(source)){urls=source;length=source.length}Resource.call(this,options.width,options.height);this.items=[];this.itemDirtyIds=[];for(var i=0;i<length;i++){var partTexture=new BaseTexture;this.items.push(partTexture);this.itemDirtyIds.push(-1)}this.length=length;this._load=null;if(urls){for(var i$1=0;i$1<length;i$1++){this.addResourceAt(autoDetectResource(urls[i$1],options),i$1)}}}if(Resource)ArrayResource.__proto__=Resource;ArrayResource.prototype=Object.create(Resource&&Resource.prototype);ArrayResource.prototype.constructor=ArrayResource;ArrayResource.prototype.dispose=function dispose(){for(var i=0,len=this.length;i<len;i++){this.items[i].destroy()}this.items=null;this.itemDirtyIds=null;this._load=null};ArrayResource.prototype.addResourceAt=function addResourceAt(resource,index){var baseTexture=this.items[index];if(!baseTexture){throw new Error("Index "+index+" is out of bounds")}if(resource.valid&&!this.valid){this.resize(resource.width,resource.height)}this.items[index].setResource(resource);return this};ArrayResource.prototype.bind=function bind(baseTexture){Resource.prototype.bind.call(this,baseTexture);baseTexture.target=constants.TARGETS.TEXTURE_2D_ARRAY;for(var i=0;i<this.length;i++){this.items[i].on("update",baseTexture.update,baseTexture)}};ArrayResource.prototype.unbind=function unbind(baseTexture){Resource.prototype.unbind.call(this,baseTexture);for(var i=0;i<this.length;i++){this.items[i].off("update",baseTexture.update,baseTexture)}};ArrayResource.prototype.load=function load(){var this$1=this;if(this._load){return this._load}var resources=this.items.map(function(item){return item.resource});var promises=resources.map(function(item){return item.load()});this._load=Promise.all(promises).then(function(){var ref=resources[0];var width=ref.width;var height=ref.height;this$1.resize(width,height);return Promise.resolve(this$1)});return this._load};ArrayResource.prototype.upload=function upload(renderer,texture,glTexture){var ref=this;var length=ref.length;var itemDirtyIds=ref.itemDirtyIds;var items=ref.items;var gl=renderer.gl;if(glTexture.dirtyId<0){gl.texImage3D(gl.TEXTURE_2D_ARRAY,0,texture.format,this._width,this._height,length,0,texture.format,texture.type,null)}for(var i=0;i<length;i++){var item=items[i];if(itemDirtyIds[i]<item.dirtyId){itemDirtyIds[i]=item.dirtyId;if(item.valid){gl.texSubImage3D(gl.TEXTURE_2D_ARRAY,0,0,0,i,item.resource.width,item.resource.height,1,texture.format,texture.type,item.resource.source)}}}return true};return ArrayResource}(Resource);var CanvasResource=function(BaseImageResource){function CanvasResource(){BaseImageResource.apply(this,arguments)}if(BaseImageResource)CanvasResource.__proto__=BaseImageResource;CanvasResource.prototype=Object.create(BaseImageResource&&BaseImageResource.prototype);CanvasResource.prototype.constructor=CanvasResource;CanvasResource.test=function test(source){return source instanceof HTMLCanvasElement};return CanvasResource}(BaseImageResource);var CubeResource=function(ArrayResource){function CubeResource(source,options){options=options||{};ArrayResource.call(this,source,options);if(this.length!==CubeResource.SIDES){throw new Error("Invalid length. Got "+this.length+", expected 6")}for(var i=0;i<CubeResource.SIDES;i++){this.items[i].target=constants.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+i}if(options.autoLoad!==false){this.load()}}if(ArrayResource)CubeResource.__proto__=ArrayResource;CubeResource.prototype=Object.create(ArrayResource&&ArrayResource.prototype);CubeResource.prototype.constructor=CubeResource;CubeResource.prototype.bind=function bind(baseTexture){ArrayResource.prototype.bind.call(this,baseTexture);baseTexture.target=constants.TARGETS.TEXTURE_CUBE_MAP};CubeResource.prototype.upload=function upload(renderer,baseTexture,glTexture){var dirty=this.itemDirtyIds;for(var i=0;i<CubeResource.SIDES;i++){var side=this.items[i];if(dirty[i]<side.dirtyId){dirty[i]=side.dirtyId;if(side.valid){side.resource.upload(renderer,side,glTexture)}}}return true};return CubeResource}(ArrayResource);CubeResource.SIDES=6;var SVGResource=function(BaseImageResource){function SVGResource(source,options){options=options||{};BaseImageResource.call(this,document.createElement("canvas"));this.svg=source;this.scale=options.scale||1;this._resolve=null;this._crossorigin=options.crossorigin;this._load=null;if(options.autoLoad!==false){this.load()}}if(BaseImageResource)SVGResource.__proto__=BaseImageResource;SVGResource.prototype=Object.create(BaseImageResource&&BaseImageResource.prototype);SVGResource.prototype.constructor=SVGResource;SVGResource.prototype.load=function load(){var this$1=this;if(this._load){return this._load}this._load=new Promise(function(resolve){this$1._resolve=function(){this$1.resize(this$1.source.width,this$1.source.height);resolve(this$1)};if(/^\<svg/.test(this$1.svg.trim())){if(!btoa){throw new Error("Your browser doesn't support base64 conversions.")}this$1.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this$1.svg)))}this$1._loadSvg()});return this._load};SVGResource.prototype._loadSvg=function _loadSvg(){var this$1=this;var tempImage=new Image;BaseImageResource.crossOrigin(tempImage,this.svg,this._crossorigin);tempImage.src=this.svg;tempImage.onload=function(){var svgWidth=tempImage.width;var svgHeight=tempImage.height;if(!svgWidth||!svgHeight){throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.")}var width=Math.round(svgWidth*this$1.scale);var height=Math.round(svgHeight*this$1.scale);var canvas=this$1.source;canvas.width=width;canvas.height=height;canvas._pixiId="canvas_"+utils.uid();canvas.getContext("2d").drawImage(tempImage,0,0,svgWidth,svgHeight,0,0,width,height);this$1._resolve();this$1._resolve=null}};SVGResource.getSize=function getSize(svgString){var sizeMatch=SVGResource.SVG_SIZE.exec(svgString);var size={};if(sizeMatch){size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3]));size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7]))}return size};SVGResource.prototype.dispose=function dispose(){BaseImageResource.prototype.dispose.call(this);this._resolve=null;this._crossorigin=null};SVGResource.test=function test(source,extension){return extension==="svg"||typeof source==="string"&&source.indexOf("data:image/svg+xml;base64")===0||typeof source==="string"&&source.indexOf("<svg")===0};return SVGResource}(BaseImageResource);SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var VideoResource=function(BaseImageResource){function VideoResource(source,options){options=options||{};if(!(source instanceof HTMLVideoElement)){var videoElement=document.createElement("video");videoElement.setAttribute("webkit-playsinline","");videoElement.setAttribute("playsinline","");if(typeof source==="string"){source=[source]}BaseImageResource.crossOrigin(videoElement,source[0].src||source[0],options.crossorigin);for(var i=0;i<source.length;++i){var sourceElement=document.createElement("source");var ref=source[i];var src=ref.src;var mime=ref.mime;src=src||source[i];var baseSrc=src.split("?").shift().toLowerCase();var ext=baseSrc.substr(baseSrc.lastIndexOf(".")+1);mime=mime||"video/"+ext;sourceElement.src=src;sourceElement.type=mime;videoElement.appendChild(sourceElement)}source=videoElement}BaseImageResource.call(this,source);this._autoUpdate=true;this._isAutoUpdating=false;this._updateFPS=options.updateFPS||0;this._msToNextUpdate=0;this.autoPlay=options.autoPlay!==false;this._load=null;this._resolve=null;this._onCanPlay=this._onCanPlay.bind(this);if(options.autoLoad!==false){this.load()}}if(BaseImageResource)VideoResource.__proto__=BaseImageResource;VideoResource.prototype=Object.create(BaseImageResource&&BaseImageResource.prototype);VideoResource.prototype.constructor=VideoResource;var prototypeAccessors={autoUpdate:{configurable:true},updateFPS:{configurable:true}};VideoResource.prototype.update=function update(deltaTime){if(deltaTime===void 0)deltaTime=0;if(!this.destroyed){var elapsedMS=ticker.Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-elapsedMS);if(!this._updateFPS||this._msToNextUpdate<=0){BaseImageResource.prototype.update.call(this,deltaTime);this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0}}};VideoResource.prototype.load=function load(){var this$1=this;if(this._load){return this._load}var source=this.source;if((source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height){source.complete=true}source.addEventListener("play",this._onPlayStart.bind(this));source.addEventListener("pause",this._onPlayStop.bind(this));if(!this._isSourceReady()){source.addEventListener("canplay",this._onCanPlay);source.addEventListener("canplaythrough",this._onCanPlay)}else{this._onCanPlay()}this._load=new Promise(function(resolve){if(this$1.valid){resolve(this$1)}else{this$1._resolve=resolve;source.load()}});return this._load};VideoResource.prototype._isSourcePlaying=function _isSourcePlaying(){var source=this.source;return source.currentTime>0&&source.paused===false&&source.ended===false&&source.readyState>2};VideoResource.prototype._isSourceReady=function _isSourceReady(){return this.source.readyState===3||this.source.readyState===4};VideoResource.prototype._onPlayStart=function _onPlayStart(){if(!this.valid){this._onCanPlay()}if(!this._isAutoUpdating&&this.autoUpdate){ticker.Ticker.shared.add(this.update,this);this._isAutoUpdating=true}};VideoResource.prototype._onPlayStop=function _onPlayStop(){if(this._isAutoUpdating){ticker.Ticker.shared.remove(this.update,this);this._isAutoUpdating=false}};VideoResource.prototype._onCanPlay=function _onCanPlay(){var ref=this;var source=ref.source;source.removeEventListener("canplay",this._onCanPlay);source.removeEventListener("canplaythrough",this._onCanPlay);var valid=this.valid;this.resize(source.videoWidth,source.videoHeight);if(!valid&&this._resolve){this._resolve(this);this._resolve=null}if(this._isSourcePlaying()){this._onPlayStart()}else if(this.autoPlay){source.play()}};VideoResource.prototype.dispose=function dispose(){if(this._isAutoUpdating){ticker.Ticker.shared.remove(this.update,this)}if(this.source){this.source.pause();this.source.src="";this.source.load()}BaseImageResource.prototype.dispose.call(this)};prototypeAccessors.autoUpdate.get=function(){return this._autoUpdate};prototypeAccessors.autoUpdate.set=function(value){if(value!==this._autoUpdate){this._autoUpdate=value;if(!this._autoUpdate&&this._isAutoUpdating){ticker.Ticker.shared.remove(this.update,this);this._isAutoUpdating=false}else if(this._autoUpdate&&!this._isAutoUpdating){ticker.Ticker.shared.add(this.update,this);this._isAutoUpdating=true}}};prototypeAccessors.updateFPS.get=function(){return this._updateFPS};prototypeAccessors.updateFPS.set=function(value){if(value!==this._updateFPS){this._updateFPS=value}};VideoResource.test=function test(source,extension){return source instanceof HTMLVideoElement||VideoResource.TYPES.indexOf(extension)>-1};Object.defineProperties(VideoResource.prototype,prototypeAccessors);return VideoResource}(BaseImageResource);VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];INSTALLED.push(ImageResource,CanvasResource,VideoResource,SVGResource,BufferResource,CubeResource,ArrayResource);var index={INSTALLED:INSTALLED,autoDetectResource:autoDetectResource,ArrayResource:ArrayResource,BufferResource:BufferResource,CanvasResource:CanvasResource,CubeResource:CubeResource,ImageResource:ImageResource,SVGResource:SVGResource,VideoResource:VideoResource,Resource:Resource,BaseImageResource:BaseImageResource};var System=function System(renderer){this.renderer=renderer;this.renderer.runners.contextChange.add(this)};System.prototype.contextChange=function contextChange(gl){};System.prototype.destroy=function destroy(){this.renderer.runners.contextChange.remove(this);this.renderer=null};var DepthResource=function(BufferResource){function DepthResource(){BufferResource.apply(this,arguments)}if(BufferResource)DepthResource.__proto__=BufferResource;DepthResource.prototype=Object.create(BufferResource&&BufferResource.prototype);DepthResource.prototype.constructor=DepthResource;DepthResource.prototype.upload=function upload(renderer,baseTexture,glTexture){var gl=renderer.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,baseTexture.premultiplyAlpha);if(glTexture.width===baseTexture.width&&glTexture.height===baseTexture.height){gl.texSubImage2D(baseTexture.target,0,0,0,baseTexture.width,baseTexture.height,baseTexture.format,baseTexture.type,this.data)}else{glTexture.width=baseTexture.width;glTexture.height=baseTexture.height;gl.texImage2D(baseTexture.target,0,gl.DEPTH_COMPONENT16,baseTexture.width,baseTexture.height,0,baseTexture.format,baseTexture.type,this.data)}return true};return DepthResource}(BufferResource);var Framebuffer=function Framebuffer(width,height){this.width=Math.ceil(width||100);this.height=Math.ceil(height||100);this.stencil=false;this.depth=false;this.dirtyId=0;this.dirtyFormat=0;this.dirtySize=0;this.depthTexture=null;this.colorTextures=[];this.glFramebuffers={};this.disposeRunner=new runner.Runner("disposeFramebuffer",2)};var prototypeAccessors$1={colorTexture:{configurable:true}};prototypeAccessors$1.colorTexture.get=function(){return this.colorTextures[0]};Framebuffer.prototype.addColorTexture=function addColorTexture(index,texture){if(index===void 0)index=0;this.colorTextures[index]=texture||new BaseTexture(null,{scaleMode:0,resolution:1,mipmap:false,width:this.width,height:this.height});this.dirtyId++;this.dirtyFormat++;return this};Framebuffer.prototype.addDepthTexture=function addDepthTexture(texture){this.depthTexture=texture||new BaseTexture(new DepthResource(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:false,format:constants.FORMATS.DEPTH_COMPONENT,type:constants.TYPES.UNSIGNED_SHORT});this.dirtyId++;this.dirtyFormat++;return this};Framebuffer.prototype.enableDepth=function enableDepth(){this.depth=true;this.dirtyId++;this.dirtyFormat++;return this};Framebuffer.prototype.enableStencil=function enableStencil(){this.stencil=true;this.dirtyId++;this.dirtyFormat++;return this};Framebuffer.prototype.resize=function resize(width,height){width=Math.ceil(width);height=Math.ceil(height);if(width===this.width&&height===this.height){return}this.width=width;this.height=height;this.dirtyId++;this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var texture=this.colorTextures[i];var resolution=texture.resolution;texture.setSize(width/resolution,height/resolution)}if(this.depthTexture){var resolution$1=this.depthTexture.resolution;this.depthTexture.setSize(width/resolution$1,height/resolution$1)}};Framebuffer.prototype.dispose=function dispose(){this.disposeRunner.run(this,false)};Object.defineProperties(Framebuffer.prototype,prototypeAccessors$1);var BaseRenderTexture=function(BaseTexture){function BaseRenderTexture(options){if(typeof options==="number"){var width$1=arguments[0];var height$1=arguments[1];var scaleMode=arguments[2];var resolution=arguments[3];options={width:width$1,height:height$1,scaleMode:scaleMode,resolution:resolution}}BaseTexture.call(this,null,options);var ref=options||{};var width=ref.width;var height=ref.height;this.mipmap=false;this.width=Math.ceil(width)||100;this.height=Math.ceil(height)||100;this.valid=true;this._canvasRenderTarget=null;this.clearColor=[0,0,0,0];this.framebuffer=new Framebuffer(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this).enableStencil();this.stencilMaskStack=[];this.filterStack=[{}]}if(BaseTexture)BaseRenderTexture.__proto__=BaseTexture;BaseRenderTexture.prototype=Object.create(BaseTexture&&BaseTexture.prototype);BaseRenderTexture.prototype.constructor=BaseRenderTexture;BaseRenderTexture.prototype.resize=function resize(width,height){width=Math.ceil(width);height=Math.ceil(height);this.framebuffer.resize(width*this.resolution,height*this.resolution)};BaseRenderTexture.prototype.dispose=function dispose(){this.framebuffer.dispose();BaseTexture.prototype.dispose.call(this)};BaseRenderTexture.prototype.destroy=function destroy(){BaseTexture.prototype.destroy.call(this,true);this.framebuffer=null;this.renderer=null};return BaseRenderTexture}(BaseTexture);var TextureUvs=function TextureUvs(){this.x0=0;this.y0=0;this.x1=1;this.y1=0;this.x2=1;this.y2=1;this.x3=0;this.y3=1;this.uvsFloat32=new Float32Array(8)};TextureUvs.prototype.set=function set(frame,baseFrame,rotate){var tw=baseFrame.width;var th=baseFrame.height;if(rotate){var w2=frame.width/2/tw;var h2=frame.height/2/th;var cX=frame.x/tw+w2;var cY=frame.y/th+h2;rotate=math.GroupD8.add(rotate,math.GroupD8.NW);this.x0=cX+w2*math.GroupD8.uX(rotate);this.y0=cY+h2*math.GroupD8.uY(rotate);rotate=math.GroupD8.add(rotate,2);this.x1=cX+w2*math.GroupD8.uX(rotate);this.y1=cY+h2*math.GroupD8.uY(rotate);rotate=math.GroupD8.add(rotate,2);this.x2=cX+w2*math.GroupD8.uX(rotate);this.y2=cY+h2*math.GroupD8.uY(rotate);rotate=math.GroupD8.add(rotate,2);this.x3=cX+w2*math.GroupD8.uX(rotate);this.y3=cY+h2*math.GroupD8.uY(rotate)}else{this.x0=frame.x/tw;this.y0=frame.y/th;this.x1=(frame.x+frame.width)/tw;this.y1=frame.y/th;this.x2=(frame.x+frame.width)/tw;this.y2=(frame.y+frame.height)/th;this.x3=frame.x/tw;this.y3=(frame.y+frame.height)/th}this.uvsFloat32[0]=this.x0;this.uvsFloat32[1]=this.y0;this.uvsFloat32[2]=this.x1;this.uvsFloat32[3]=this.y1;this.uvsFloat32[4]=this.x2;this.uvsFloat32[5]=this.y2;this.uvsFloat32[6]=this.x3;this.uvsFloat32[7]=this.y3};var DEFAULT_UVS=new TextureUvs;var Texture=function(EventEmitter){function Texture(baseTexture,frame,orig,trim,rotate,anchor){EventEmitter.call(this);this.noFrame=false;if(!frame){this.noFrame=true;frame=new math.Rectangle(0,0,1,1)}if(baseTexture instanceof Texture){baseTexture=baseTexture.baseTexture}this.baseTexture=baseTexture;this._frame=frame;this.trim=trim;this.valid=false;this.requiresUpdate=false;this._uvs=DEFAULT_UVS;this.uvMatrix=null;this.orig=orig||frame;this._rotate=Number(rotate||0);if(rotate===true){this._rotate=2}else if(this._rotate%2!==0){throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually")}this.defaultAnchor=anchor?new math.Point(anchor.x,anchor.y):new math.Point(0,0);this._updateID=0;this.textureCacheIds=[];if(!baseTexture.valid){baseTexture.once("loaded",this.onBaseTextureUpdated,this)}else if(this.noFrame){if(baseTexture.valid){this.onBaseTextureUpdated(baseTexture)}}else{this.frame=frame}if(this.noFrame){baseTexture.on("update",this.onBaseTextureUpdated,this)}}if(EventEmitter)Texture.__proto__=EventEmitter;Texture.prototype=Object.create(EventEmitter&&EventEmitter.prototype);Texture.prototype.constructor=Texture;var prototypeAccessors={frame:{configurable:true},rotate:{configurable:true},width:{configurable:true},height:{configurable:true}};Texture.prototype.update=function update(){if(this.baseTexture.resource){this.baseTexture.resource.update()}};Texture.prototype.onBaseTextureUpdated=function onBaseTextureUpdated(baseTexture){if(this.noFrame){if(!this.baseTexture.valid){return}this._frame.width=baseTexture.width;this._frame.height=baseTexture.height;this.valid=true;this.updateUvs()}else{this.frame=this._frame}this.emit("update",this)};Texture.prototype.destroy=function destroy(destroyBase){if(this.baseTexture){if(destroyBase){var ref=this.baseTexture;var resource=ref.resource;if(resource&&utils.TextureCache[resource.url]){Texture.removeFromCache(resource.url)}this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this);this.baseTexture=null}this._frame=null;this._uvs=null;this.trim=null;this.orig=null;this.valid=false;Texture.removeFromCache(this);this.textureCacheIds=null};Texture.prototype.clone=function clone(){return new Texture(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)};Texture.prototype.updateUvs=function updateUvs(){if(this._uvs===DEFAULT_UVS){this._uvs=new TextureUvs}this._uvs.set(this._frame,this.baseTexture,this.rotate);this._updateID++};Texture.from=function from(source,options){if(options===void 0)options={};var cacheId=null;if(typeof source==="string"){cacheId=source}else{if(!source._pixiId){source._pixiId="pixiid_"+utils.uid()}cacheId=source._pixiId}var texture=utils.TextureCache[cacheId];if(!texture){if(!options.resolution){options.resolution=utils.getResolutionOfUrl(source)}texture=new Texture(new BaseTexture(source,options));texture.baseTexture.cacheId=cacheId;BaseTexture.addToCache(texture.baseTexture,cacheId);Texture.addToCache(texture,cacheId)}return texture};Texture.fromBuffer=function fromBuffer(buffer,width,height,options){return new Texture(BaseTexture.fromBuffer(buffer,width,height,options))};Texture.fromLoader=function fromLoader(source,imageUrl,name){var resource=new ImageResource(source);resource.url=imageUrl;var baseTexture=new BaseTexture(resource,{scaleMode:settings.settings.SCALE_MODE,resolution:utils.getResolutionOfUrl(imageUrl)});var texture=new Texture(baseTexture);if(!name){name=imageUrl}BaseTexture.addToCache(texture.baseTexture,name);Texture.addToCache(texture,name);if(name!==imageUrl){BaseTexture.addToCache(texture.baseTexture,imageUrl);Texture.addToCache(texture,imageUrl)}return texture};Texture.addToCache=function addToCache(texture,id){if(id){if(texture.textureCacheIds.indexOf(id)===-1){texture.textureCacheIds.push(id)}if(utils.TextureCache[id]){console.warn("Texture added to the cache with an id ["+id+"] that already had an entry")}utils.TextureCache[id]=texture}};Texture.removeFromCache=function removeFromCache(texture){if(typeof texture==="string"){var textureFromCache=utils.TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);if(index>-1){textureFromCache.textureCacheIds.splice(index,1)}delete utils.TextureCache[texture];return textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i){if(utils.TextureCache[texture.textureCacheIds[i]]===texture){delete utils.TextureCache[texture.textureCacheIds[i]]}}texture.textureCacheIds.length=0;return texture}return null};prototypeAccessors.frame.get=function(){return this._frame};prototypeAccessors.frame.set=function(frame){this._frame=frame;this.noFrame=false;var x=frame.x;var y=frame.y;var width=frame.width;var height=frame.height;var xNotFit=x+width>this.baseTexture.width;var yNotFit=y+height>this.baseTexture.height;if(xNotFit||yNotFit){var relationship=xNotFit&&yNotFit?"and":"or";var errorX="X: "+x+" + "+width+" = "+(x+width)+" > "+this.baseTexture.width;var errorY="Y: "+y+" + "+height+" = "+(y+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+errorX+" "+relationship+" "+errorY)}this.valid=width&&height&&this.baseTexture.valid;if(!this.trim&&!this.rotate){this.orig=frame}if(this.valid){this.updateUvs()}};prototypeAccessors.rotate.get=function(){return this._rotate};prototypeAccessors.rotate.set=function(rotate){this._rotate=rotate;if(this.valid){this.updateUvs()}};prototypeAccessors.width.get=function(){return this.orig.width};prototypeAccessors.height.get=function(){return this.orig.height};Object.defineProperties(Texture.prototype,prototypeAccessors);return Texture}(utils.EventEmitter);function createWhiteTexture(){var canvas=document.createElement("canvas");canvas.width=16;canvas.height=16;var context=canvas.getContext("2d");context.fillStyle="white";context.fillRect(0,0,16,16);return new Texture(new BaseTexture(new CanvasResource(canvas)))}function removeAllHandlers(tex){tex.destroy=function _emptyDestroy(){};tex.on=function _emptyOn(){};tex.once=function _emptyOnce(){};tex.emit=function _emptyEmit(){}}Texture.EMPTY=new Texture(new BaseTexture);removeAllHandlers(Texture.EMPTY);removeAllHandlers(Texture.EMPTY.baseTexture);Texture.WHITE=createWhiteTexture();removeAllHandlers(Texture.WHITE);removeAllHandlers(Texture.WHITE.baseTexture);var RenderTexture=function(Texture){function RenderTexture(baseRenderTexture,frame){var _legacyRenderer=null;if(!(baseRenderTexture instanceof BaseRenderTexture)){var width=arguments[1];var height=arguments[2];var scaleMode=arguments[3];var resolution=arguments[4];console.warn("Please use RenderTexture.create("+width+", "+height+") instead of the ctor directly.");_legacyRenderer=arguments[0];frame=null;baseRenderTexture=new BaseRenderTexture({width:width,height:height,scaleMode:scaleMode,resolution:resolution})}Texture.call(this,baseRenderTexture,frame);this.legacyRenderer=_legacyRenderer;this.valid=true;this.filterFrame=null;this.filterPoolKey=null;this.updateUvs()}if(Texture)RenderTexture.__proto__=Texture;RenderTexture.prototype=Object.create(Texture&&Texture.prototype);RenderTexture.prototype.constructor=RenderTexture;RenderTexture.prototype.resize=function resize(width,height,resizeBaseTexture){if(resizeBaseTexture===void 0)resizeBaseTexture=true;width=Math.ceil(width);height=Math.ceil(height);this.valid=width>0&&height>0;this._frame.width=this.orig.width=width;this._frame.height=this.orig.height=height;if(resizeBaseTexture){this.baseTexture.resize(width,height)}this.updateUvs()};RenderTexture.prototype.setResolution=function setResolution(resolution){var ref=this;var baseTexture=ref.baseTexture;if(baseTexture.resolution===resolution){return}baseTexture.setResolution(resolution);this.resize(baseTexture.width,baseTexture.height,false)};RenderTexture.create=function create(options){if(typeof options==="number"){options={width:options,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}}return new RenderTexture(new BaseRenderTexture(options))};return RenderTexture}(Texture);var Attribute=function Attribute(buffer,size,normalized,type,stride,start,instance){if(normalized===void 0)normalized=false;if(type===void 0)type=5126;this.buffer=buffer;this.size=size;this.normalized=normalized;this.type=type;this.stride=stride;this.start=start;this.instance=instance};Attribute.prototype.destroy=function destroy(){this.buffer=null};Attribute.from=function from(buffer,size,normalized,type,stride){return new Attribute(buffer,size,normalized,type,stride)};var UID=0;var Buffer=function Buffer(data,_static,index){if(_static===void 0)_static=true;if(index===void 0)index=false;this.data=data||new Float32Array(1);this._glBuffers={};this._updateID=0;this.index=index;this.static=_static;this.id=UID++;this.disposeRunner=new runner.Runner("disposeBuffer",2)};Buffer.prototype.update=function update(data){this.data=data||this.data;this._updateID++};Buffer.prototype.dispose=function dispose(){this.disposeRunner.run(this,false)};Buffer.prototype.destroy=function destroy(){this.dispose();this.data=null};Buffer.from=function from(data){if(data instanceof Array){data=new Float32Array(data)}return new Buffer(data)};function getBufferType(array){if(array.BYTES_PER_ELEMENT===4){if(array instanceof Float32Array){return"Float32Array"}else if(array instanceof Uint32Array){return"Uint32Array"}return"Int32Array"}else if(array.BYTES_PER_ELEMENT===2){if(array instanceof Uint16Array){return"Uint16Array"}}else if(array.BYTES_PER_ELEMENT===1){if(array instanceof Uint8Array){return"Uint8Array"}}return null}var map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function interleaveTypedArrays(arrays,sizes){var outSize=0;var stride=0;var views={};for(var i=0;i<arrays.length;i++){stride+=sizes[i];outSize+=arrays[i].length}var buffer=new ArrayBuffer(outSize*4);var out=null;var littleOffset=0;for(var i$1=0;i$1<arrays.length;i$1++){var size=sizes[i$1];var array=arrays[i$1];var type=getBufferType(array);if(!views[type]){views[type]=new map[type](buffer)}out=views[type];for(var j=0;j<array.length;j++){var indexStart=(j/size|0)*stride+littleOffset;var index=j%size;out[indexStart+index]=array[j]}littleOffset+=size}return new Float32Array(buffer)}var byteSizeMap={5126:4,5123:2,5121:1};var UID$1=0;var map$1={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};var Geometry=function Geometry(buffers,attributes){if(buffers===void 0)buffers=[];if(attributes===void 0)attributes={};this.buffers=buffers;this.indexBuffer=null;this.attributes=attributes;this.glVertexArrayObjects={};this.id=UID$1++;this.instanced=false;this.instanceCount=1;this._size=null;this.disposeRunner=new runner.Runner("disposeGeometry",2);this.refCount=0};Geometry.prototype.addAttribute=function addAttribute(id,buffer,size,normalized,type,stride,start,instance){if(normalized===void 0)normalized=false;if(instance===void 0)instance=false;if(!buffer){throw new Error("You must pass a buffer when creating an attribute")}if(!buffer.data){if(buffer instanceof Array){buffer=new Float32Array(buffer)}buffer=new Buffer(buffer)}var ids=id.split("|");if(ids.length>1){for(var i=0;i<ids.length;i++){this.addAttribute(ids[i],buffer,size,normalized,type)}return this}var bufferIndex=this.buffers.indexOf(buffer);if(bufferIndex===-1){this.buffers.push(buffer);bufferIndex=this.buffers.length-1}this.attributes[id]=new Attribute(bufferIndex,size,normalized,type,stride,start,instance);this.instanced=this.instanced||instance;return this};Geometry.prototype.getAttribute=function getAttribute(id){return this.attributes[id]};Geometry.prototype.getBuffer=function getBuffer(id){return this.buffers[this.getAttribute(id).buffer]};Geometry.prototype.addIndex=function addIndex(buffer){if(!buffer.data){if(buffer instanceof Array){buffer=new Uint16Array(buffer)}buffer=new Buffer(buffer)}buffer.index=true;this.indexBuffer=buffer;if(this.buffers.indexOf(buffer)===-1){this.buffers.push(buffer)}return this};Geometry.prototype.getIndex=function getIndex(){return this.indexBuffer};Geometry.prototype.interleave=function interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer){return this}var arrays=[];var sizes=[];var interleavedBuffer=new Buffer;var i;for(i in this.attributes){var attribute=this.attributes[i];var buffer=this.buffers[attribute.buffer];arrays.push(buffer.data);sizes.push(attribute.size*byteSizeMap[attribute.type]/4);attribute.buffer=0}interleavedBuffer.data=interleaveTypedArrays(arrays,sizes);for(i=0;i<this.buffers.length;i++){if(this.buffers[i]!==this.indexBuffer){this.buffers[i].destroy()}}this.buffers=[interleavedBuffer];if(this.indexBuffer){this.buffers.push(this.indexBuffer)}return this};Geometry.prototype.getSize=function getSize(){for(var i in this.attributes){var attribute=this.attributes[i];var buffer=this.buffers[attribute.buffer];return buffer.data.length/(attribute.stride/4||attribute.size)}return 0};Geometry.prototype.dispose=function dispose(){this.disposeRunner.run(this,false)};Geometry.prototype.destroy=function destroy(){this.dispose();this.buffers=null;this.indexBuffer.destroy();this.attributes=null};Geometry.prototype.clone=function clone(){var geometry=new Geometry;for(var i=0;i<this.buffers.length;i++){geometry.buffers[i]=new Buffer(this.buffers[i].data.slice())}for(var i$1 in this.attributes){var attrib=this.attributes[i$1];geometry.attributes[i$1]=new Attribute(attrib.buffer,attrib.size,attrib.normalized,attrib.type,attrib.stride,attrib.start,attrib.instance)}if(this.indexBuffer){geometry.indexBuffer=geometry.buffers[this.buffers.indexOf(this.indexBuffer)];geometry.indexBuffer.index=true}return geometry};Geometry.merge=function merge(geometries){var geometryOut=new Geometry;var arrays=[];var sizes=[];var offsets=[];var geometry;for(var i=0;i<geometries.length;i++){geometry=geometries[i];for(var j=0;j<geometry.buffers.length;j++){sizes[j]=sizes[j]||0;sizes[j]+=geometry.buffers[j].data.length;offsets[j]=0}}for(var i$1=0;i$1<geometry.buffers.length;i$1++){arrays[i$1]=new(map$1[getBufferType(geometry.buffers[i$1].data)])(sizes[i$1]);geometryOut.buffers[i$1]=new Buffer(arrays[i$1])}for(var i$2=0;i$2<geometries.length;i$2++){geometry=geometries[i$2];for(var j$1=0;j$1<geometry.buffers.length;j$1++){arrays[j$1].set(geometry.buffers[j$1].data,offsets[j$1]);offsets[j$1]+=geometry.buffers[j$1].data.length}}geometryOut.attributes=geometry.attributes;if(geometry.indexBuffer){geometryOut.indexBuffer=geometryOut.buffers[geometry.buffers.indexOf(geometry.indexBuffer)];geometryOut.indexBuffer.index=true;var offset=0;var stride=0;var offset2=0;var bufferIndexToCount=0;for(var i$3=0;i$3<geometry.buffers.length;i$3++){if(geometry.buffers[i$3]!==geometry.indexBuffer){bufferIndexToCount=i$3;break}}for(var i$4 in geometry.attributes){var attribute=geometry.attributes[i$4];if((attribute.buffer|0)===bufferIndexToCount){stride+=attribute.size*byteSizeMap[attribute.type]/4}}for(var i$5=0;i$5<geometries.length;i$5++){var indexBufferData=geometries[i$5].indexBuffer.data;for(var j$2=0;j$2<indexBufferData.length;j$2++){geometryOut.indexBuffer.data[j$2+offset2]+=offset}offset+=geometry.buffers[bufferIndexToCount].data.length/stride;offset2+=indexBufferData.length}}return geometryOut};var Quad=function(Geometry){function Quad(){Geometry.call(this);this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}if(Geometry)Quad.__proto__=Geometry;Quad.prototype=Object.create(Geometry&&Geometry.prototype);Quad.prototype.constructor=Quad;return Quad}(Geometry);var QuadUv=function(Geometry){function QuadUv(){Geometry.call(this);this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.vertexBuffer=new Buffer(this.vertices);this.uvBuffer=new Buffer(this.uvs);this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}if(Geometry)QuadUv.__proto__=Geometry;QuadUv.prototype=Object.create(Geometry&&Geometry.prototype);QuadUv.prototype.constructor=QuadUv;QuadUv.prototype.map=function map(targetTextureFrame,destinationFrame){var x=0;var y=0;this.uvs[0]=x;this.uvs[1]=y;this.uvs[2]=x+destinationFrame.width/targetTextureFrame.width;this.uvs[3]=y;this.uvs[4]=x+destinationFrame.width/targetTextureFrame.width;this.uvs[5]=y+destinationFrame.height/targetTextureFrame.height;this.uvs[6]=x;this.uvs[7]=y+destinationFrame.height/targetTextureFrame.height;x=destinationFrame.x;y=destinationFrame.y;this.vertices[0]=x;this.vertices[1]=y;this.vertices[2]=x+destinationFrame.width;this.vertices[3]=y;this.vertices[4]=x+destinationFrame.width;this.vertices[5]=y+destinationFrame.height;this.vertices[6]=x;this.vertices[7]=y+destinationFrame.height;this.invalidate();return this};QuadUv.prototype.invalidate=function invalidate(){this.vertexBuffer._updateID++;this.uvBuffer._updateID++;return this};return QuadUv}(Geometry);var UID$2=0;var UniformGroup=function UniformGroup(uniforms,_static){this.uniforms=uniforms;this.group=true;this.syncUniforms={};this.dirtyId=0;this.id=UID$2++;this.static=!!_static};UniformGroup.prototype.update=function update(){this.dirtyId++};UniformGroup.prototype.add=function add(name,uniforms,_static){this.uniforms[name]=new UniformGroup(uniforms,_static)};UniformGroup.from=function from(uniforms,_static){return new UniformGroup(uniforms,_static)};var FilterState=function FilterState(){this.renderTexture=null;this.target=null;this.legacy=false;this.resolution=1;this.sourceFrame=new math.Rectangle;this.destinationFrame=new math.Rectangle;this.filters=[]};FilterState.prototype.clear=function clear(){this.target=null;this.filters=null;this.renderTexture=null};var screenKey="screen";var FilterSystem=function(System){function FilterSystem(renderer){System.call(this,renderer);this.defaultFilterStack=[{}];this.texturePool={};this.statePool=[];this.quad=new Quad;this.quadUv=new QuadUv;this.tempRect=new math.Rectangle;this.activeState={};this.globalUniforms=new UniformGroup({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},true);this._pixelsWidth=renderer.view.width;this._pixelsHeight=renderer.view.height}if(System)FilterSystem.__proto__=System;FilterSystem.prototype=Object.create(System&&System.prototype);FilterSystem.prototype.constructor=FilterSystem;FilterSystem.prototype.push=function push(target,filters){var renderer=this.renderer;var filterStack=this.defaultFilterStack;var state=this.statePool.pop()||new FilterState;var resolution=filters[0].resolution;var padding=filters[0].padding;var autoFit=filters[0].autoFit;var legacy=filters[0].legacy;for(var i=1;i<filters.length;i++){var filter=filters[i];resolution=Math.min(resolution,filter.resolution);padding=Math.max(padding,filter.padding);autoFit=autoFit||filter.autoFit;legacy=legacy||filter.legacy}if(filterStack.length===1){this.defaultFilterStack[0].renderTexture=renderer.renderTexture.current}filterStack.push(state);state.resolution=resolution;state.legacy=legacy;state.target=target;state.sourceFrame.copyFrom(target.filterArea||target.getBounds(true));state.sourceFrame.pad(padding);if(autoFit){state.sourceFrame.fit(this.renderer.renderTexture.sourceFrame)}state.sourceFrame.ceil(resolution);state.renderTexture=this.getOptimalFilterTexture(state.sourceFrame.width,state.sourceFrame.height,resolution);state.filters=filters;state.destinationFrame.width=state.renderTexture.width;state.destinationFrame.height=state.renderTexture.height;state.renderTexture.filterFrame=state.sourceFrame;renderer.renderTexture.bind(state.renderTexture,state.sourceFrame);renderer.renderTexture.clear()};FilterSystem.prototype.pop=function pop(){var filterStack=this.defaultFilterStack;var state=filterStack.pop();var filters=state.filters;this.activeState=state;var globalUniforms=this.globalUniforms.uniforms;globalUniforms.outputFrame=state.sourceFrame;globalUniforms.resolution=state.resolution;var inputSize=globalUniforms.inputSize;var inputPixel=globalUniforms.inputPixel;var inputClamp=globalUniforms.inputClamp;inputSize[0]=state.destinationFrame.width;inputSize[1]=state.destinationFrame.height;inputSize[2]=1/inputSize[0];inputSize[3]=1/inputSize[1];inputPixel[0]=inputSize[0]*state.resolution;inputPixel[1]=inputSize[1]*state.resolution;inputPixel[2]=1/inputPixel[0];inputPixel[3]=1/inputPixel[1];inputClamp[0]=.5*inputPixel[2];inputClamp[1]=.5*inputPixel[3];inputClamp[2]=state.sourceFrame.width*inputSize[2]-.5*inputPixel[2];inputClamp[3]=state.sourceFrame.height*inputSize[3]-.5*inputPixel[3];if(state.legacy){var filterArea=globalUniforms.filterArea;filterArea[0]=state.destinationFrame.width;filterArea[1]=state.destinationFrame.height;filterArea[2]=state.sourceFrame.x;filterArea[3]=state.sourceFrame.y;globalUniforms.filterClamp=globalUniforms.inputClamp}this.globalUniforms.update();var lastState=filterStack[filterStack.length-1];if(filters.length===1){filters[0].apply(this,state.renderTexture,lastState.renderTexture,false,state);this.returnFilterTexture(state.renderTexture)}else{var flip=state.renderTexture;var flop=this.getOptimalFilterTexture(flip.width,flip.height,state.resolution);flop.filterFrame=flip.filterFrame;var i=0;for(i=0;i<filters.length-1;++i){filters[i].apply(this,flip,flop,true,state);var t=flip;flip=flop;flop=t}filters[i].apply(this,flip,lastState.renderTexture,false,state);this.returnFilterTexture(flip);this.returnFilterTexture(flop)}state.clear();this.statePool.push(state)};FilterSystem.prototype.applyFilter=function applyFilter(filter,input,output,clear){var renderer=this.renderer;renderer.renderTexture.bind(output,output?output.filterFrame:null);if(clear){renderer.renderTexture.clear()}filter.uniforms.uSampler=input;filter.uniforms.filterGlobals=this.globalUniforms;renderer.state.setState(filter.state);renderer.shader.bind(filter);if(filter.legacy){this.quadUv.map(input._frame,input.filterFrame);renderer.geometry.bind(this.quadUv);renderer.geometry.draw(constants.DRAW_MODES.TRIANGLES)}else{renderer.geometry.bind(this.quad);renderer.geometry.draw(constants.DRAW_MODES.TRIANGLE_STRIP)}};FilterSystem.prototype.calculateSpriteMatrix=function calculateSpriteMatrix(outputMatrix,sprite){var ref=this.activeState;var sourceFrame=ref.sourceFrame;var destinationFrame=ref.destinationFrame;var ref$1=sprite._texture;var orig=ref$1.orig;var mappedMatrix=outputMatrix.set(destinationFrame.width,0,0,destinationFrame.height,sourceFrame.x,sourceFrame.y);var worldTransform=sprite.worldTransform.copyTo(math.Matrix.TEMP_MATRIX);worldTransform.invert();mappedMatrix.prepend(worldTransform);mappedMatrix.scale(1/orig.width,1/orig.height);mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y);return mappedMatrix};FilterSystem.prototype.destroy=function destroy(contextLost){if(contextLost===void 0)contextLost=false;if(!contextLost){this.emptyPool()}else{this.texturePool={}}};FilterSystem.prototype.getOptimalFilterTexture=function getOptimalFilterTexture(minWidth,minHeight,resolution){if(resolution===void 0)resolution=1;var key=screenKey;minWidth*=resolution;minHeight*=resolution;if(minWidth!==this._pixelsWidth||minHeight!==this._pixelsHeight){minWidth=utils.nextPow2(minWidth);minHeight=utils.nextPow2(minHeight);key=(minWidth&65535)<<16|minHeight&65535}if(!this.texturePool[key]){this.texturePool[key]=[]}var renderTexture=this.texturePool[key].pop();if(!renderTexture){renderTexture=RenderTexture.create({width:minWidth,height:minHeight})}renderTexture.filterPoolKey=key;renderTexture.setResolution(resolution);return renderTexture};FilterSystem.prototype.getFilterTexture=function getFilterTexture(resolution){var rt=this.activeState.renderTexture;var filterTexture=this.getOptimalFilterTexture(rt.width,rt.height,resolution||rt.baseTexture.resolution);filterTexture.filterFrame=rt.filterFrame;return filterTexture};FilterSystem.prototype.returnFilterTexture=function returnFilterTexture(renderTexture){var key=renderTexture.filterPoolKey;renderTexture.filterFrame=null;this.texturePool[key].push(renderTexture)};FilterSystem.prototype.emptyPool=function emptyPool(){for(var i in this.texturePool){var textures=this.texturePool[i];if(textures){for(var j=0;j<textures.length;j++){textures[j].destroy(true)}}}this.texturePool={}};FilterSystem.prototype.resize=function resize(){var textures=this.texturePool[screenKey];if(textures){for(var j=0;j<textures.length;j++){textures[j].destroy(true)}}this.texturePool[screenKey]=[];this._pixelsWidth=this.renderer.view.width;this._pixelsHeight=this.renderer.view.height};return FilterSystem}(System);var ObjectRenderer=function(System){function ObjectRenderer(){System.apply(this,arguments)}if(System)ObjectRenderer.__proto__=System;ObjectRenderer.prototype=Object.create(System&&System.prototype);ObjectRenderer.prototype.constructor=ObjectRenderer;ObjectRenderer.prototype.start=function start(){};ObjectRenderer.prototype.stop=function stop(){this.flush()};ObjectRenderer.prototype.flush=function flush(){};ObjectRenderer.prototype.render=function render(object){};return ObjectRenderer}(System);var BatchSystem=function(System){function BatchSystem(renderer){System.call(this,renderer);this.emptyRenderer=new ObjectRenderer(renderer);this.currentRenderer=this.emptyRenderer}if(System)BatchSystem.__proto__=System;BatchSystem.prototype=Object.create(System&&System.prototype);BatchSystem.prototype.constructor=BatchSystem;BatchSystem.prototype.setObjectRenderer=function setObjectRenderer(objectRenderer){if(this.currentRenderer===objectRenderer){return}this.currentRenderer.stop();this.currentRenderer=objectRenderer;this.currentRenderer.start()};BatchSystem.prototype.flush=function flush(){this.setObjectRenderer(this.emptyRenderer)};BatchSystem.prototype.reset=function reset(){this.setObjectRenderer(this.emptyRenderer)};return BatchSystem}(System);settings.settings.PREFER_ENV=utils.isMobile.any?constants.ENV.WEBGL:constants.ENV.WEBGL2;var CONTEXT_UID=0;var ContextSystem=function(System){function ContextSystem(renderer){System.call(this,renderer);this.webGLVersion=1;this.extensions={};this.handleContextLost=this.handleContextLost.bind(this);this.handleContextRestored=this.handleContextRestored.bind(this);renderer.view.addEventListener("webglcontextlost",this.handleContextLost,false);renderer.view.addEventListener("webglcontextrestored",this.handleContextRestored,false)}if(System)ContextSystem.__proto__=System;ContextSystem.prototype=Object.create(System&&System.prototype);ContextSystem.prototype.constructor=ContextSystem;var prototypeAccessors={isLost:{configurable:true}};prototypeAccessors.isLost.get=function(){return!this.gl||this.gl.isContextLost()};ContextSystem.prototype.contextChange=function contextChange(gl){this.gl=gl;if(gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")){gl.getExtension("WEBGL_lose_context").restoreContext()}};ContextSystem.prototype.initFromContext=function initFromContext(gl){this.gl=gl;this.validateContext(gl);this.renderer.gl=gl;this.renderer.CONTEXT_UID=CONTEXT_UID++;this.renderer.runners.contextChange.run(gl)};ContextSystem.prototype.initFromOptions=function initFromOptions(options){var gl=this.createContext(this.renderer.view,options);this.initFromContext(gl)};ContextSystem.prototype.createContext=function createContext(canvas,options){var gl;if(settings.settings.PREFER_ENV>=constants.ENV.WEBGL2){gl=canvas.getContext("webgl2",options)}if(gl){this.webGLVersion=2}else{this.webGLVersion=1;gl=canvas.getContext("webgl",options)||canvas.getContext("experimental-webgl",options);if(!gl){throw new Error("This browser does not support WebGL. Try using the canvas renderer")}}this.gl=gl;this.getExtensions();return gl};ContextSystem.prototype.getExtensions=function getExtensions(){var ref=this;var gl=ref.gl;if(this.webGLVersion===1){Object.assign(this.extensions,{drawBuffers:gl.getExtension("WEBGL_draw_buffers"),depthTexture:gl.getExtension("WEBKIT_WEBGL_depth_texture"),floatTexture:gl.getExtension("OES_texture_float"),loseContext:gl.getExtension("WEBGL_lose_context"),vertexArrayObject:gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:gl.getExtension("OES_element_index_uint")})}};ContextSystem.prototype.handleContextLost=function handleContextLost(event){event.preventDefault()};ContextSystem.prototype.handleContextRestored=function handleContextRestored(){this.renderer.runners.contextChange.run(this.gl)};ContextSystem.prototype.destroy=function destroy(){var view=this.renderer.view;view.removeEventListener("webglcontextlost",this.handleContextLost);view.removeEventListener("webglcontextrestored",this.handleContextRestored);this.gl.useProgram(null);if(this.extensions.loseContext){this.extensions.loseContext.loseContext()}};ContextSystem.prototype.postrender=function postrender(){this.gl.flush()};ContextSystem.prototype.validateContext=function validateContext(gl){var attributes=gl.getContextAttributes();if(!attributes.stencil){console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}};Object.defineProperties(ContextSystem.prototype,prototypeAccessors);return ContextSystem}(System);var FramebufferSystem=function(System){function FramebufferSystem(renderer){System.call(this,renderer);this.managedFramebuffers=[];this.unknownFramebuffer=new Framebuffer(10,10)}if(System)FramebufferSystem.__proto__=System;FramebufferSystem.prototype=Object.create(System&&System.prototype);FramebufferSystem.prototype.constructor=FramebufferSystem;var prototypeAccessors={size:{configurable:true}};FramebufferSystem.prototype.contextChange=function contextChange(){var gl=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.current=this.unknownFramebuffer;this.viewport=new math.Rectangle;this.hasMRT=true;this.writeDepthTexture=true;this.disposeAll(true);if(this.renderer.context.webGLVersion===1){var nativeDrawBuffersExtension=this.renderer.context.extensions.drawBuffers;var nativeDepthTextureExtension=this.renderer.context.extensions.depthTexture;if(settings.settings.PREFER_ENV===constants.ENV.WEBGL_LEGACY){nativeDrawBuffersExtension=null;nativeDepthTextureExtension=null}if(nativeDrawBuffersExtension){gl.drawBuffers=function(activeTextures){return nativeDrawBuffersExtension.drawBuffersWEBGL(activeTextures)}}else{this.hasMRT=false;gl.drawBuffers=function(){}}if(!nativeDepthTextureExtension){this.writeDepthTexture=false}}};FramebufferSystem.prototype.bind=function bind(framebuffer,frame){var ref=this;var gl=ref.gl;if(framebuffer){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(framebuffer);if(this.current!==framebuffer){this.current=framebuffer;gl.bindFramebuffer(gl.FRAMEBUFFER,fbo.framebuffer)}if(fbo.dirtyId!==framebuffer.dirtyId){fbo.dirtyId=framebuffer.dirtyId;if(fbo.dirtyFormat!==framebuffer.dirtyFormat){fbo.dirtyFormat=framebuffer.dirtyFormat;this.updateFramebuffer(framebuffer)}else if(fbo.dirtySize!==framebuffer.dirtySize){fbo.dirtySize=framebuffer.dirtySize;this.resizeFramebuffer(framebuffer)}}for(var i=0;i<framebuffer.colorTextures.length;i++){if(framebuffer.colorTextures[i].texturePart){this.renderer.texture.unbind(framebuffer.colorTextures[i].texture)}else{this.renderer.texture.unbind(framebuffer.colorTextures[i])}}if(framebuffer.depthTexture){this.renderer.texture.unbind(framebuffer.depthTexture)}if(frame){this.setViewport(frame.x,frame.y,frame.width,frame.height)}else{this.setViewport(0,0,framebuffer.width,framebuffer.height)}}else{if(this.current){this.current=null;gl.bindFramebuffer(gl.FRAMEBUFFER,null)}if(frame){this.setViewport(frame.x,frame.y,frame.width,frame.height)}else{this.setViewport(0,0,this.renderer.width,this.renderer.height)}}};FramebufferSystem.prototype.setViewport=function setViewport(x,y,width,height){var v=this.viewport;if(v.width!==width||v.height!==height||v.x!==x||v.y!==y){v.x=x;v.y=y;v.width=width;v.height=height;this.gl.viewport(x,y,width,height)}};prototypeAccessors.size.get=function(){if(this.current){return{x:0,y:0,width:this.current.width,height:this.current.height}}return{x:0,y:0,width:this.renderer.width,height:this.renderer.height}};FramebufferSystem.prototype.clear=function clear(r,g,b,a){var ref=this;var gl=ref.gl;gl.clearColor(r,g,b,a);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)};FramebufferSystem.prototype.initFramebuffer=function initFramebuffer(framebuffer){var ref=this;var gl=ref.gl;var fbo={framebuffer:gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};framebuffer.glFramebuffers[this.CONTEXT_UID]=fbo;this.managedFramebuffers.push(framebuffer);framebuffer.disposeRunner.add(this);return fbo};FramebufferSystem.prototype.resizeFramebuffer=function resizeFramebuffer(framebuffer){var ref=this;var gl=ref.gl;var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];if(fbo.stencil){gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height)}var colorTextures=framebuffer.colorTextures;for(var i=0;i<colorTextures.length;i++){this.renderer.texture.bind(colorTextures[i],0)}if(framebuffer.depthTexture){this.renderer.texture.bind(framebuffer.depthTexture,0)}};FramebufferSystem.prototype.updateFramebuffer=function updateFramebuffer(framebuffer){var ref=this;var gl=ref.gl;var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];var colorTextures=framebuffer.colorTextures;var count=colorTextures.length;if(!gl.drawBuffers){count=Math.min(count,1)}var activeTextures=[];for(var i=0;i<count;i++){var texture=framebuffer.colorTextures[i];if(texture.texturePart){this.renderer.texture.bind(texture.texture,0);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i,gl.TEXTURE_CUBE_MAP_NEGATIVE_X+texture.side,texture.texture._glTextures[this.CONTEXT_UID].texture,0)}else{this.renderer.texture.bind(texture,0);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i,gl.TEXTURE_2D,texture._glTextures[this.CONTEXT_UID].texture,0)}activeTextures.push(gl.COLOR_ATTACHMENT0+i)}if(activeTextures.length>1){gl.drawBuffers(activeTextures)}if(framebuffer.depthTexture){var writeDepthTexture=this.writeDepthTexture;if(writeDepthTexture){var depthTexture=framebuffer.depthTexture;this.renderer.texture.bind(depthTexture,0);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.TEXTURE_2D,depthTexture._glTextures[this.CONTEXT_UID].texture,0)}}if(!fbo.stencil&&(framebuffer.stencil||framebuffer.depth)){fbo.stencil=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,fbo.stencil);if(!framebuffer.depthTexture){gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,fbo.stencil)}gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,framebuffer.width,framebuffer.height)}};FramebufferSystem.prototype.disposeFramebuffer=function disposeFramebuffer(framebuffer,contextLost){var fbo=framebuffer.glFramebuffers[this.CONTEXT_UID];var gl=this.gl;if(!fbo){return}delete framebuffer.glFramebuffers[this.CONTEXT_UID];var index=this.managedFramebuffers.indexOf(framebuffer);if(index>=0){this.managedFramebuffers.splice(index,1)}framebuffer.disposeRunner.remove(this);if(!contextLost){gl.deleteFramebuffer(fbo.framebuffer);if(fbo.stencil){gl.deleteRenderbuffer(fbo.stencil)}}};FramebufferSystem.prototype.disposeAll=function disposeAll(contextLost){var list=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<list.count;i++){this.disposeFramebuffer(list[i],contextLost)}};FramebufferSystem.prototype.reset=function reset(){this.current=this.unknownFramebuffer;this.viewport=new math.Rectangle};Object.defineProperties(FramebufferSystem.prototype,prototypeAccessors);return FramebufferSystem}(System);var GLBuffer=function GLBuffer(buffer){this.buffer=buffer;this.updateID=-1;this.byteLength=-1;this.refCount=0};var byteSizeMap$1={5126:4,5123:2,5121:1};var GeometrySystem=function(System){function GeometrySystem(renderer){System.call(this,renderer);this._activeGeometry=null;this._activeVao=null;this.hasVao=true;this.hasInstance=true;this.canUseUInt32ElementIndex=false;this.boundBuffers={};this.managedGeometries={};this.managedBuffers={}}if(System)GeometrySystem.__proto__=System;GeometrySystem.prototype=Object.create(System&&System.prototype);GeometrySystem.prototype.constructor=GeometrySystem;GeometrySystem.prototype.contextChange=function contextChange(){this.disposeAll(true);var gl=this.gl=this.renderer.gl;var context=this.renderer.context;this.CONTEXT_UID=this.renderer.CONTEXT_UID;if(!gl.createVertexArray){var nativeVaoExtension=this.renderer.context.extensions.vertexArrayObject;if(settings.settings.PREFER_ENV===constants.ENV.WEBGL_LEGACY){nativeVaoExtension=null}if(nativeVaoExtension){gl.createVertexArray=function(){return nativeVaoExtension.createVertexArrayOES()};gl.bindVertexArray=function(vao){return nativeVaoExtension.bindVertexArrayOES(vao)};gl.deleteVertexArray=function(vao){return nativeVaoExtension.deleteVertexArrayOES(vao)}}else{this.hasVao=false;gl.createVertexArray=function(){};gl.bindVertexArray=function(){};gl.deleteVertexArray=function(){}}}if(!gl.vertexAttribDivisor){var instanceExt=gl.getExtension("ANGLE_instanced_arrays");if(instanceExt){gl.vertexAttribDivisor=function(a,b){return instanceExt.vertexAttribDivisorANGLE(a,b)};gl.drawElementsInstanced=function(a,b,c,d,e){return instanceExt.drawElementsInstancedANGLE(a,b,c,d,e)};gl.drawArraysInstanced=function(a,b,c,d){return instanceExt.drawArraysInstancedANGLE(a,b,c,d)}}else{this.hasInstance=false}}this.canUseUInt32ElementIndex=context.webGLVersion===2||!!context.extensions.uint32ElementIndex};GeometrySystem.prototype.bind=function bind(geometry,shader){shader=shader||this.renderer.shader.shader;var ref=this;var gl=ref.gl;var vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID];if(!vaos){this.managedGeometries[geometry.id]=geometry;geometry.disposeRunner.add(this);geometry.glVertexArrayObjects[this.CONTEXT_UID]=vaos={}}var vao=vaos[shader.program.id]||this.initGeometryVao(geometry,shader.program);this._activeGeometry=geometry;if(this._activeVao!==vao){this._activeVao=vao;if(this.hasVao){gl.bindVertexArray(vao)}else{this.activateVao(geometry,shader.program)}}this.updateBuffers()};GeometrySystem.prototype.reset=function reset(){this.unbind()};GeometrySystem.prototype.updateBuffers=function updateBuffers(){var geometry=this._activeGeometry;var ref=this;var gl=ref.gl;for(var i=0;i<geometry.buffers.length;i++){var buffer=geometry.buffers[i];var glBuffer=buffer._glBuffers[this.CONTEXT_UID];if(buffer._updateID!==glBuffer.updateID){glBuffer.updateID=buffer._updateID;var type=buffer.index?gl.ELEMENT_ARRAY_BUFFER:gl.ARRAY_BUFFER;gl.bindBuffer(type,glBuffer.buffer);this._boundBuffer=glBuffer;if(glBuffer.byteLength>=buffer.data.byteLength){gl.bufferSubData(type,0,buffer.data)}else{var drawType=buffer.static?gl.STATIC_DRAW:gl.DYNAMIC_DRAW;glBuffer.byteLength=buffer.data.byteLength;gl.bufferData(type,buffer.data,drawType)}}}};GeometrySystem.prototype.checkCompatibility=function checkCompatibility(geometry,program){var geometryAttributes=geometry.attributes;var shaderAttributes=program.attributeData;for(var j in shaderAttributes){if(!geometryAttributes[j]){throw new Error('shader and geometry incompatible, geometry missing the "'+j+'" attribute')}}};GeometrySystem.prototype.getSignature=function getSignature(geometry,program){var attribs=geometry.attributes;var shaderAttributes=program.attributeData;var strings=["g",geometry.id];for(var i in attribs){if(shaderAttributes[i]){strings.push(i)}}return strings.join("-")};GeometrySystem.prototype.initGeometryVao=function initGeometryVao(geometry,program){this.checkCompatibility(geometry,program);var gl=this.gl;var CONTEXT_UID=this.CONTEXT_UID;var signature=this.getSignature(geometry,program);var vaoObjectHash=geometry.glVertexArrayObjects[this.CONTEXT_UID];var vao=vaoObjectHash[signature];if(vao){vaoObjectHash[program.id]=vao;return vao}var buffers=geometry.buffers;var attributes=geometry.attributes;var tempStride={};var tempStart={};for(var j in buffers){tempStride[j]=0;tempStart[j]=0}for(var j$1 in attributes){if(!attributes[j$1].size&&program.attributeData[j$1]){attributes[j$1].size=program.attributeData[j$1].size}else if(!attributes[j$1].size){console.warn("PIXI Geometry attribute '"+j$1+"' size cannot be determined (likely the bound shader does not have the attribute)")}tempStride[attributes[j$1].buffer]+=attributes[j$1].size*byteSizeMap$1[attributes[j$1].type]}for(var j$2 in attributes){var attribute=attributes[j$2];var attribSize=attribute.size;if(attribute.stride===undefined){if(tempStride[attribute.buffer]===attribSize*byteSizeMap$1[attribute.type]){attribute.stride=0}else{attribute.stride=tempStride[attribute.buffer]}}if(attribute.start===undefined){attribute.start=tempStart[attribute.buffer];tempStart[attribute.buffer]+=attribSize*byteSizeMap$1[attribute.type]}}vao=gl.createVertexArray();gl.bindVertexArray(vao);for(var i=0;i<buffers.length;i++){var buffer=buffers[i];if(!buffer._glBuffers[CONTEXT_UID]){buffer._glBuffers[CONTEXT_UID]=new GLBuffer(gl.createBuffer());this.managedBuffers[buffer.id]=buffer;buffer.disposeRunner.add(this)}buffer._glBuffers[CONTEXT_UID].refCount++}this.activateVao(geometry,program);this._activeVao=vao;vaoObjectHash[program.id]=vao;vaoObjectHash[signature]=vao;return vao};GeometrySystem.prototype.disposeBuffer=function disposeBuffer(buffer,contextLost){if(!this.managedBuffers[buffer.id]){return}delete this.managedBuffers[buffer.id];var glBuffer=buffer._glBuffers[this.CONTEXT_UID];var gl=this.gl;buffer.disposeRunner.remove(this);if(!glBuffer){return}if(!contextLost){gl.deleteBuffer(glBuffer.buffer)}delete buffer._glBuffers[this.CONTEXT_UID]};GeometrySystem.prototype.disposeGeometry=function disposeGeometry(geometry,contextLost){if(!this.managedGeometries[geometry.id]){return}delete this.managedGeometries[geometry.id];var vaos=geometry.glVertexArrayObjects[this.CONTEXT_UID];var gl=this.gl;var buffers=geometry.buffers;geometry.disposeRunner.remove(this);if(!vaos){return}for(var i=0;i<buffers.length;i++){var buf=buffers[i]._glBuffers[this.CONTEXT_UID];buf.refCount--;if(buf.refCount===0&&!contextLost){this.disposeBuffer(buffers[i],contextLost)}}if(!contextLost){for(var vaoId in vaos){if(vaoId[0]==="g"){var vao=vaos[vaoId];if(this._activeVao===vao){this.unbind()}gl.deleteVertexArray(vao)}}}delete geometry.glVertexArrayObjects[this.CONTEXT_UID]};GeometrySystem.prototype.disposeAll=function disposeAll(contextLost){var all=Object.keys(this.managedGeometries);for(var i=0;i<all.length;i++){this.disposeGeometry(this.managedGeometries[all[i]],contextLost)}all=Object.keys(this.managedBuffers);for(var i$1=0;i$1<all.length;i$1++){this.disposeBuffer(this.managedBuffers[all[i$1]],contextLost)}};GeometrySystem.prototype.activateVao=function activateVao(geometry,program){var gl=this.gl;var CONTEXT_UID=this.CONTEXT_UID;var buffers=geometry.buffers;var attributes=geometry.attributes;if(geometry.indexBuffer){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,geometry.indexBuffer._glBuffers[CONTEXT_UID].buffer)}var lastBuffer=null;for(var j in attributes){var attribute=attributes[j];var buffer=buffers[attribute.buffer];var glBuffer=buffer._glBuffers[CONTEXT_UID];if(program.attributeData[j]){if(lastBuffer!==glBuffer){gl.bindBuffer(gl.ARRAY_BUFFER,glBuffer.buffer);lastBuffer=glBuffer}var location=program.attributeData[j].location;gl.enableVertexAttribArray(location);gl.vertexAttribPointer(location,attribute.size,attribute.type||gl.FLOAT,attribute.normalized,attribute.stride,attribute.start);if(attribute.instance){if(this.hasInstance){gl.vertexAttribDivisor(location,1)}else{throw new Error("geometry error, GPU Instancing is not supported on this device")}}}}};GeometrySystem.prototype.draw=function draw(type,size,start,instanceCount){var ref=this;var gl=ref.gl;var geometry=this._activeGeometry;if(geometry.indexBuffer){var byteSize=geometry.indexBuffer.data.BYTES_PER_ELEMENT;var glType=byteSize===2?gl.UNSIGNED_SHORT:gl.UNSIGNED_INT;if(byteSize===2||byteSize===4&&this.canUseUInt32ElementIndex){if(geometry.instanced){gl.drawElementsInstanced(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize,instanceCount||1)}else{gl.drawElements(type,size||geometry.indexBuffer.data.length,glType,(start||0)*byteSize)}}else{console.warn("unsupported index buffer type: uint32")}}else if(geometry.instanced){gl.drawArraysInstanced(type,start,size||geometry.getSize(),instanceCount||1)}else{gl.drawArrays(type,start,size||geometry.getSize())}return this};GeometrySystem.prototype.unbind=function unbind(){this.gl.bindVertexArray(null);this._activeVao=null;this._activeGeometry=null};return GeometrySystem}(System);function compileProgram(gl,vertexSrc,fragmentSrc,attributeLocations){var glVertShader=compileShader(gl,gl.VERTEX_SHADER,vertexSrc);var glFragShader=compileShader(gl,gl.FRAGMENT_SHADER,fragmentSrc);var program=gl.createProgram();gl.attachShader(program,glVertShader);gl.attachShader(program,glFragShader);if(attributeLocations){for(var i in attributeLocations){gl.bindAttribLocation(program,attributeLocations[i],i)}}gl.linkProgram(program);if(!gl.getProgramParameter(program,gl.LINK_STATUS)){console.error("Pixi.js Error: Could not initialize shader.");console.error("gl.VALIDATE_STATUS",gl.getProgramParameter(program,gl.VALIDATE_STATUS));console.error("gl.getError()",gl.getError());if(gl.getProgramInfoLog(program)!==""){console.warn("Pixi.js Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program))}gl.deleteProgram(program);program=null}gl.deleteShader(glVertShader);gl.deleteShader(glFragShader);return program}function compileShader(gl,type,src){var shader=gl.createShader(type);gl.shaderSource(shader,src);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){console.warn(src);console.error(gl.getShaderInfoLog(shader));return null}return shader}function defaultValue(type,size){switch(type){case"float":return 0;case"vec2":return new Float32Array(2*size);case"vec3":return new Float32Array(3*size);case"vec4":return new Float32Array(4*size);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*size);case"ivec3":return new Int32Array(3*size);case"ivec4":return new Int32Array(4*size);case"bool":return false;case"bvec2":return booleanArray(2*size);case"bvec3":return booleanArray(3*size);case"bvec4":return booleanArray(4*size);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function booleanArray(size){var array=new Array(size);for(var i=0;i<array.length;i++){array[i]=false}return array}var context=null;function getTestContext(){if(!context){var canvas=document.createElement("canvas");var gl;if(settings.settings.PREFER_ENV>=constants.ENV.WEBGL2){gl=canvas.getContext("webgl2",{})}if(!gl){gl=canvas.getContext("webgl",{})||canvas.getContext("experimental-webgl",{});if(!gl){throw new Error("This browser does not support WebGL. Try using the canvas renderer")}else{gl.getExtension("WEBGL_draw_buffers")}}context=gl;return gl}return context}var maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=constants.PRECISION.MEDIUM;var gl=getTestContext();if(gl){if(gl.getShaderPrecisionFormat){var shaderFragment=gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT);maxFragmentPrecision=shaderFragment.precision?constants.PRECISION.HIGH:constants.PRECISION.MEDIUM}}}return maxFragmentPrecision}function setPrecision(src,requestedPrecision,maxSupportedPrecision){if(src.substring(0,9)!=="precision"){var precision=requestedPrecision;if(requestedPrecision===constants.PRECISION.HIGH&&maxSupportedPrecision!==constants.PRECISION.HIGH){precision=constants.PRECISION.MEDIUM}return"precision "+precision+" float;\n"+src}else if(maxSupportedPrecision!==constants.PRECISION.HIGH&&src.substring(0,15)==="precision highp"){return src.replace("precision highp","precision mediump")}return src}var GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(type){return GLSL_TO_SIZE[type]}var GL_TABLE=null;var GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]}var GLSL_TO_SINGLE_SETTERS_CACHED={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"};var GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(group,uniformData){var textureCount=0;var func="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(var i in group.uniforms){var data=uniformData[i];if(!data){if(group.uniforms[i].group){func+="\n                    renderer.shader.syncUniformGroup(uv."+i+");\n                "}continue}if(data.type==="float"&&data.size===1){func+="\n            if(uv."+i+" !== ud."+i+".value)\n            {\n                ud."+i+".value = uv."+i+"\n                gl.uniform1f(ud."+i+".location, uv."+i+")\n            }\n"}else if((data.type==="sampler2D"||data.type==="samplerCube"||data.type==="sampler2DArray")&&data.size===1&&!data.isArray){func+="\n            renderer.texture.bind(uv."+i+", "+textureCount+");\n\n            if(ud."+i+".value !== "+textureCount+")\n            {\n                ud."+i+".value = "+textureCount+";\n                gl.uniform1i(ud."+i+".location, "+textureCount+");\n; // eslint-disable-line max-len\n            }\n";textureCount++}else if(data.type==="mat3"&&data.size===1){if(group.uniforms[i].a!==undefined){func+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+".toArray(true));\n                \n"}else{func+="\n                gl.uniformMatrix3fv(ud."+i+".location, false, uv."+i+");\n                \n"}}else if(data.type==="vec2"&&data.size===1){if(group.uniforms[i].x!==undefined){func+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+i+".location, v.x, v.y);\n                }\n"}else{func+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+i+".location, v[0], v[1]);\n                }\n                \n"}}else if(data.type==="vec4"&&data.size===1){if(group.uniforms[i].width!==undefined){func+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+i+".location, v.x, v.y, v.width, v.height)\n                }\n"}else{func+="\n                cv = ud."+i+".value;\n                v = uv."+i+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+i+".location, v[0], v[1], v[2], v[3])\n                }\n                \n"}}else{var templateType=data.size===1?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS;var template=templateType[data.type].replace("location","ud."+i+".location");func+="\n            cv = ud."+i+".value;\n            v = uv."+i+";\n            "+template+";\n"}}return new Function("ud","uv","renderer",func)}var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function checkMaxIfStatementsInShader(maxIfs,gl){if(maxIfs===0){throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`")}var shader=gl.createShader(gl.FRAGMENT_SHADER);while(true){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(maxIfs));gl.shaderSource(shader,fragmentSrc);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){maxIfs=maxIfs/2|0}else{break}}return maxIfs}function generateIfTestSrc(maxIfs){var src="";for(var i=0;i<maxIfs;++i){if(i>0){src+="\nelse "}if(i<maxIfs-1){src+="if(test == "+i+".0){}"}}return src}var unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval==="boolean"){return unsafeEval}try{var func=new Function("param1","param2","param3","return param1[param2] === param3;");unsafeEval=func({a:"b"},"a","b")===true}catch(e){unsafeEval=false}return unsafeEval}var defaultFragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}";var defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n";var UID$3=0;var nameCache={};var Program=function Program(vertexSrc,fragmentSrc,name){if(name===void 0)name="pixi-shader";this.id=UID$3++;this.vertexSrc=vertexSrc||Program.defaultVertexSrc;this.fragmentSrc=fragmentSrc||Program.defaultFragmentSrc;this.vertexSrc=this.vertexSrc.trim();this.fragmentSrc=this.fragmentSrc.trim();if(this.vertexSrc.substring(0,8)!=="#version"){name=name.replace(/\s+/g,"-");if(nameCache[name]){nameCache[name]++;name+="-"+nameCache[name]}else{nameCache[name]=1}this.vertexSrc="#define SHADER_NAME "+name+"\n"+this.vertexSrc;this.fragmentSrc="#define SHADER_NAME "+name+"\n"+this.fragmentSrc;this.vertexSrc=setPrecision(this.vertexSrc,settings.settings.PRECISION_VERTEX,constants.PRECISION.HIGH);this.fragmentSrc=setPrecision(this.fragmentSrc,settings.settings.PRECISION_FRAGMENT,getMaxFragmentPrecision())}this.extractData(this.vertexSrc,this.fragmentSrc);this.glPrograms={};this.syncUniforms=null};var staticAccessors={defaultVertexSrc:{configurable:true},defaultFragmentSrc:{configurable:true}};Program.prototype.extractData=function extractData(vertexSrc,fragmentSrc){var gl=getTestContext();if(gl){var program=compileProgram(gl,vertexSrc,fragmentSrc);this.attributeData=this.getAttributeData(program,gl);this.uniformData=this.getUniformData(program,gl);gl.deleteProgram(program)}else{this.uniformData={};this.attributeData={}}};Program.prototype.getAttributeData=function getAttributeData(program,gl){var attributes={};var attributesArray=[];var totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(var i=0;i<totalAttributes;i++){var attribData=gl.getActiveAttrib(program,i);var type=mapType(gl,attribData.type);var data={type:type,name:attribData.name,size:mapSize(type),location:0};attributes[attribData.name]=data;attributesArray.push(data)}attributesArray.sort(function(a,b){return a.name>b.name?1:-1});for(var i$1=0;i$1<attributesArray.length;i$1++){attributesArray[i$1].location=i$1}return attributes};Program.prototype.getUniformData=function getUniformData(program,gl){var uniforms={};var totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(var i=0;i<totalUniforms;i++){var uniformData=gl.getActiveUniform(program,i);var name=uniformData.name.replace(/\[.*?\]/,"");var isArray=uniformData.name.match(/\[.*?\]/,"");var type=mapType(gl,uniformData.type);uniforms[name]={type:type,size:uniformData.size,isArray:isArray,value:defaultValue(type,uniformData.size)}}return uniforms};staticAccessors.defaultVertexSrc.get=function(){return defaultVertex};staticAccessors.defaultFragmentSrc.get=function(){return defaultFragment};Program.from=function from(vertexSrc,fragmentSrc,name){var key=vertexSrc+fragmentSrc;var program=utils.ProgramCache[key];if(!program){utils.ProgramCache[key]=program=new Program(vertexSrc,fragmentSrc,name)}return program};Object.defineProperties(Program,staticAccessors);var Shader=function Shader(program,uniforms){this.program=program;if(uniforms){if(uniforms instanceof UniformGroup){this.uniformGroup=uniforms}else{this.uniformGroup=new UniformGroup(uniforms)}}else{this.uniformGroup=new UniformGroup({})}for(var i in program.uniformData){if(this.uniformGroup.uniforms[i]instanceof Array){this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i])}}};var prototypeAccessors$2={uniforms:{configurable:true}};Shader.prototype.checkUniformExists=function checkUniformExists(name,group){if(group.uniforms[name]){return true}for(var i in group.uniforms){var uniform=group.uniforms[i];if(uniform.group){if(this.checkUniformExists(name,uniform)){return true}}}return false};Shader.prototype.destroy=function destroy(){this.uniformGroup=null};prototypeAccessors$2.uniforms.get=function(){return this.uniformGroup.uniforms};Shader.from=function from(vertexSrc,fragmentSrc,uniforms){var program=Program.from(vertexSrc,fragmentSrc);return new Shader(program,uniforms)};Object.defineProperties(Shader.prototype,prototypeAccessors$2);var BLEND=0;var OFFSET=1;var CULLING=2;var DEPTH_TEST=3;var WINDING=4;var State=function State(){this.data=0;this.blendMode=constants.BLEND_MODES.NORMAL;this.polygonOffset=0;this.blend=true};var prototypeAccessors$3={blend:{configurable:true},offsets:{configurable:true},culling:{configurable:true},depthTest:{configurable:true},clockwiseFrontFace:{configurable:true},blendMode:{configurable:true},polygonOffset:{configurable:true}};prototypeAccessors$3.blend.get=function(){return!!(this.data&1<<BLEND)};prototypeAccessors$3.blend.set=function(value){if(!!(this.data&1<<BLEND)!==value){this.data^=1<<BLEND}};prototypeAccessors$3.offsets.get=function(){return!!(this.data&1<<OFFSET)};prototypeAccessors$3.offsets.set=function(value){if(!!(this.data&1<<OFFSET)!==value){this.data^=1<<OFFSET}};prototypeAccessors$3.culling.get=function(){return!!(this.data&1<<CULLING)};prototypeAccessors$3.culling.set=function(value){if(!!(this.data&1<<CULLING)!==value){this.data^=1<<CULLING}};prototypeAccessors$3.depthTest.get=function(){return!!(this.data&1<<DEPTH_TEST)};prototypeAccessors$3.depthTest.set=function(value){if(!!(this.data&1<<DEPTH_TEST)!==value){this.data^=1<<DEPTH_TEST}};prototypeAccessors$3.clockwiseFrontFace.get=function(){return!!(this.data&1<<WINDING)};prototypeAccessors$3.clockwiseFrontFace.set=function(value){if(!!(this.data&1<<WINDING)!==value){this.data^=1<<WINDING}};prototypeAccessors$3.blendMode.get=function(){return this._blendMode};prototypeAccessors$3.blendMode.set=function(value){this.blend=value!==constants.BLEND_MODES.NONE;this._blendMode=value};prototypeAccessors$3.polygonOffset.get=function(){return this._polygonOffset};prototypeAccessors$3.polygonOffset.set=function(value){this.offsets=!!value;this._polygonOffset=value};State.for2d=function for2d(){var state=new State;state.depthTest=false;state.blend=true;return state};Object.defineProperties(State.prototype,prototypeAccessors$3);var defaultVertex$1="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";var defaultFragment$1="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n";var Filter=function(Shader){function Filter(vertexSrc,fragmentSrc,uniforms){var program=Program.from(vertexSrc||Filter.defaultVertexSrc,fragmentSrc||Filter.defaultFragmentSrc);Shader.call(this,program,uniforms);this.padding=0;this.resolution=settings.settings.FILTER_RESOLUTION;this.enabled=true;this.autoFit=true;this.legacy=!!this.program.attributeData.aTextureCoord;this.state=new State}if(Shader)Filter.__proto__=Shader;Filter.prototype=Object.create(Shader&&Shader.prototype);Filter.prototype.constructor=Filter;var prototypeAccessors={blendMode:{configurable:true}};var staticAccessors={defaultVertexSrc:{configurable:true},defaultFragmentSrc:{configurable:true}};Filter.prototype.apply=function apply(filterManager,input,output,clear,currentState){filterManager.applyFilter(this,input,output,clear,currentState)};prototypeAccessors.blendMode.get=function(){return this.state.blendMode};prototypeAccessors.blendMode.set=function(value){this.state.blendMode=value};staticAccessors.defaultVertexSrc.get=function(){return defaultVertex$1};staticAccessors.defaultFragmentSrc.get=function(){return defaultFragment$1};Object.defineProperties(Filter.prototype,prototypeAccessors);Object.defineProperties(Filter,staticAccessors);return Filter}(Shader);Filter.SOURCE_KEY_MAP={};var vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n";var fragment="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n";var tempMat=new math.Matrix;var TextureMatrix=function TextureMatrix(texture,clampMargin){this._texture=texture;this.mapCoord=new math.Matrix;this.uClampFrame=new Float32Array(4);this.uClampOffset=new Float32Array(2);this._updateID=-1;this.clampOffset=0;this.clampMargin=typeof clampMargin==="undefined"?.5:clampMargin;this.isSimple=false};var prototypeAccessors$4={texture:{configurable:true}};prototypeAccessors$4.texture.get=function(){return this._texture};prototypeAccessors$4.texture.set=function(value){this._texture=value;this._updateID=-1};TextureMatrix.prototype.multiplyUvs=function multiplyUvs(uvs,out){if(out===undefined){out=uvs}var mat=this.mapCoord;for(var i=0;i<uvs.length;i+=2){var x=uvs[i];var y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx;out[i+1]=x*mat.b+y*mat.d+mat.ty}return out};TextureMatrix.prototype.update=function update(forceUpdate){var tex=this._texture;if(!tex||!tex.valid){return false}if(!forceUpdate&&this._updateID===tex._updateID){return false}this._updateID=tex._updateID;var uvs=tex._uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);var orig=tex.orig;var trim=tex.trim;if(trim){tempMat.set(orig.width/trim.width,0,0,orig.height/trim.height,-trim.x/trim.width,-trim.y/trim.height);this.mapCoord.append(tempMat)}var texBase=tex.baseTexture;var frame=this.uClampFrame;var margin=this.clampMargin/texBase.resolution;var offset=this.clampOffset;frame[0]=(tex._frame.x+margin+offset)/texBase.width;frame[1]=(tex._frame.y+margin+offset)/texBase.height;frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width;frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height;this.uClampOffset[0]=offset/texBase.realWidth;this.uClampOffset[1]=offset/texBase.realHeight;this.isSimple=tex._frame.width===texBase.width&&tex._frame.height===texBase.height&&tex.rotate===0;return true};Object.defineProperties(TextureMatrix.prototype,prototypeAccessors$4);var SpriteMaskFilter=function(Filter){function SpriteMaskFilter(sprite){var maskMatrix=new math.Matrix;Filter.call(this,vertex,fragment);sprite.renderable=false;this.maskSprite=sprite;this.maskMatrix=maskMatrix}if(Filter)SpriteMaskFilter.__proto__=Filter;SpriteMaskFilter.prototype=Object.create(Filter&&Filter.prototype);SpriteMaskFilter.prototype.constructor=SpriteMaskFilter;SpriteMaskFilter.prototype.apply=function apply(filterManager,input,output,clear){var maskSprite=this.maskSprite;var tex=this.maskSprite.texture;if(!tex.valid){return}if(!tex.transform){tex.transform=new TextureMatrix(tex,0)}tex.transform.update();this.uniforms.npmAlpha=tex.baseTexture.premultiplyAlpha?0:1;this.uniforms.mask=tex;this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.transform.mapCoord);this.uniforms.alpha=maskSprite.worldAlpha;this.uniforms.maskClamp=tex.transform.uClampFrame;filterManager.applyFilter(this,input,output,clear)};return SpriteMaskFilter}(Filter);var MaskSystem=function(System){function MaskSystem(renderer){System.call(this,renderer);this.scissor=false;this.scissorData=null;this.scissorRenderTarget=null;this.enableScissor=false;this.alphaMaskPool=[];this.alphaMaskIndex=0}if(System)MaskSystem.__proto__=System;MaskSystem.prototype=Object.create(System&&System.prototype);MaskSystem.prototype.constructor=MaskSystem;MaskSystem.prototype.push=function push(target,maskData){if(maskData.isSprite){this.pushSpriteMask(target,maskData)}else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencil.stencilMaskStack.length&&maskData.isFastRect()){var matrix=maskData.worldTransform;var rot=Math.atan2(matrix.b,matrix.a);rot=Math.round(rot*(180/Math.PI));if(rot%90){this.pushStencilMask(maskData)}else{this.pushScissorMask(target,maskData)}}else{this.pushStencilMask(maskData)}};MaskSystem.prototype.pop=function pop(target,maskData){if(maskData.isSprite){this.popSpriteMask(target,maskData)}else if(this.enableScissor&&!this.renderer.stencil.stencilMaskStack.length){this.popScissorMask(target,maskData)}else{this.popStencilMask(target,maskData)}};MaskSystem.prototype.pushSpriteMask=function pushSpriteMask(target,maskData){var alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex];if(!alphaMaskFilter){alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter(maskData)]}alphaMaskFilter[0].resolution=this.renderer.resolution;alphaMaskFilter[0].maskSprite=maskData;var stashFilterArea=target.filterArea;target.filterArea=maskData.getBounds(true);this.renderer.filter.push(target,alphaMaskFilter);target.filterArea=stashFilterArea;this.alphaMaskIndex++};MaskSystem.prototype.popSpriteMask=function popSpriteMask(){this.renderer.filter.pop();this.alphaMaskIndex--};MaskSystem.prototype.pushStencilMask=function pushStencilMask(maskData){this.renderer.batch.flush();this.renderer.stencil.pushStencil(maskData)};MaskSystem.prototype.popStencilMask=function popStencilMask(){this.renderer.stencil.popStencil()};MaskSystem.prototype.pushScissorMask=function pushScissorMask(target,maskData){maskData.renderable=true;var renderTarget=this.renderer._activeRenderTarget;var bounds=maskData.getBounds();bounds.fit(renderTarget.size);maskData.renderable=false;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var resolution=this.renderer.resolution;this.renderer.gl.scissor(bounds.x*resolution,(renderTarget.root?renderTarget.size.height-bounds.y-bounds.height:bounds.y)*resolution,bounds.width*resolution,bounds.height*resolution);this.scissorRenderTarget=renderTarget;this.scissorData=maskData;this.scissor=true};MaskSystem.prototype.popScissorMask=function popScissorMask(){this.scissorRenderTarget=null;this.scissorData=null;this.scissor=false;var ref=this.renderer;var gl=ref.gl;gl.disable(gl.SCISSOR_TEST)};return MaskSystem}(System);var StencilSystem=function(System){function StencilSystem(renderer){System.call(this,renderer);this.stencilMaskStack=[]}if(System)StencilSystem.__proto__=System;StencilSystem.prototype=Object.create(System&&System.prototype);StencilSystem.prototype.constructor=StencilSystem;StencilSystem.prototype.setMaskStack=function setMaskStack(stencilMaskStack){var gl=this.renderer.gl;if(stencilMaskStack.length!==this.stencilMaskStack.length){if(stencilMaskStack.length===0){gl.disable(gl.STENCIL_TEST)}else{gl.enable(gl.STENCIL_TEST)}}this.stencilMaskStack=stencilMaskStack};StencilSystem.prototype.pushStencil=function pushStencil(graphics){var gl=this.renderer.gl;var prevMaskCount=this.stencilMaskStack.length;if(prevMaskCount===0){gl.enable(gl.STENCIL_TEST)}this.stencilMaskStack.push(graphics);gl.colorMask(false,false,false,false);gl.stencilFunc(gl.EQUAL,prevMaskCount,this._getBitwiseMask());gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR);graphics.renderable=true;graphics.render(this.renderer);this.renderer.batch.flush();graphics.renderable=false;this._useCurrent()};StencilSystem.prototype.popStencil=function popStencil(){var gl=this.renderer.gl;var graphics=this.stencilMaskStack.pop();if(this.stencilMaskStack.length===0){gl.disable(gl.STENCIL_TEST);gl.clear(gl.STENCIL_BUFFER_BIT);gl.clearStencil(0)}else{gl.colorMask(false,false,false,false);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR);graphics.renderable=true;graphics.render(this.renderer);this.renderer.batch.flush();graphics.renderable=false;this._useCurrent()}};StencilSystem.prototype._useCurrent=function _useCurrent(){var gl=this.renderer.gl;gl.colorMask(true,true,true,true);gl.stencilFunc(gl.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask());gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)};StencilSystem.prototype._getBitwiseMask=function _getBitwiseMask(){return(1<<this.stencilMaskStack.length)-1};StencilSystem.prototype.destroy=function destroy(){System.prototype.destroy.call(this,this);this.stencilMaskStack=null};return StencilSystem}(System);var ProjectionSystem=function(System){function ProjectionSystem(renderer){System.call(this,renderer);this.destinationFrame=null;this.sourceFrame=null;this.defaultFrame=null;this.projectionMatrix=new math.Matrix;this.transform=null}if(System)ProjectionSystem.__proto__=System;ProjectionSystem.prototype=Object.create(System&&System.prototype);ProjectionSystem.prototype.constructor=ProjectionSystem;ProjectionSystem.prototype.update=function update(destinationFrame,sourceFrame,resolution,root){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame;this.sourceFrame=sourceFrame||this.sourceFrame||destinationFrame;this.calculateProjection(this.destinationFrame,this.sourceFrame,resolution,root);if(this.transform){this.projectionMatrix.append(this.transform)}var renderer=this.renderer;renderer.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix;renderer.globalUniforms.update();if(renderer.shader.shader){renderer.shader.syncUniformGroup(renderer.shader.shader.uniforms.globals)}};ProjectionSystem.prototype.calculateProjection=function calculateProjection(destinationFrame,sourceFrame,resolution,root){var pm=this.projectionMatrix;if(!root){pm.a=1/destinationFrame.width*2*resolution;pm.d=1/destinationFrame.height*2*resolution;pm.tx=-1-sourceFrame.x*pm.a;pm.ty=-1-sourceFrame.y*pm.d}else{pm.a=1/destinationFrame.width*2*resolution;pm.d=-1/destinationFrame.height*2*resolution;pm.tx=-1-sourceFrame.x*pm.a;pm.ty=1-sourceFrame.y*pm.d}};ProjectionSystem.prototype.setTransform=function setTransform(){};return ProjectionSystem}(System);var tempRect=new math.Rectangle;var RenderTextureSystem=function(System){function RenderTextureSystem(renderer){System.call(this,renderer);this.clearColor=renderer._backgroundColorRgba;this.defaultMaskStack=[];this.current=null;this.sourceFrame=new math.Rectangle;this.destinationFrame=new math.Rectangle}if(System)RenderTextureSystem.__proto__=System;RenderTextureSystem.prototype=Object.create(System&&System.prototype);RenderTextureSystem.prototype.constructor=RenderTextureSystem;RenderTextureSystem.prototype.bind=function bind(renderTexture,sourceFrame,destinationFrame){if(renderTexture===void 0)renderTexture=null;this.current=renderTexture;var renderer=this.renderer;var resolution;if(renderTexture){var baseTexture=renderTexture.baseTexture;resolution=baseTexture.resolution;if(!destinationFrame){tempRect.width=baseTexture.realWidth;tempRect.height=baseTexture.realHeight;destinationFrame=tempRect}if(!sourceFrame){sourceFrame=destinationFrame}this.renderer.framebuffer.bind(baseTexture.framebuffer,destinationFrame);this.renderer.projection.update(destinationFrame,sourceFrame,resolution,false);this.renderer.stencil.setMaskStack(baseTexture.stencilMaskStack)}else{resolution=this.renderer.resolution;if(!destinationFrame){tempRect.width=renderer.width;tempRect.height=renderer.height;destinationFrame=tempRect}if(!sourceFrame){sourceFrame=destinationFrame}renderer.framebuffer.bind(null,destinationFrame);this.renderer.projection.update(destinationFrame,sourceFrame,resolution,true);this.renderer.stencil.setMaskStack(this.defaultMaskStack)}this.sourceFrame.copyFrom(sourceFrame);this.destinationFrame.x=destinationFrame.x/resolution;this.destinationFrame.y=destinationFrame.y/resolution;this.destinationFrame.width=destinationFrame.width/resolution;this.destinationFrame.height=destinationFrame.height/resolution;if(sourceFrame===destinationFrame){this.sourceFrame.copyFrom(this.destinationFrame)}};RenderTextureSystem.prototype.clear=function clear(clearColor){if(this.current){clearColor=clearColor||this.current.baseTexture.clearColor}else{clearColor=clearColor||this.clearColor}this.renderer.framebuffer.clear(clearColor[0],clearColor[1],clearColor[2],clearColor[3])};RenderTextureSystem.prototype.resize=function resize(){this.bind(null)};RenderTextureSystem.prototype.reset=function reset(){this.bind(null)};return RenderTextureSystem}(System);var GLProgram=function GLProgram(program,uniformData){this.program=program;this.uniformData=uniformData;this.uniformGroups={}};GLProgram.prototype.destroy=function destroy(){this.uniformData=null;this.uniformGroups=null;this.program=null};var UID$4=0;var ShaderSystem=function(System){function ShaderSystem(renderer){System.call(this,renderer);this.systemCheck();this.gl=null;this.shader=null;this.program=null;this.cache={};this.id=UID$4++}if(System)ShaderSystem.__proto__=System;ShaderSystem.prototype=Object.create(System&&System.prototype);ShaderSystem.prototype.constructor=ShaderSystem;ShaderSystem.prototype.systemCheck=function systemCheck(){if(!unsafeEvalSupported()){throw new Error("Current environment does not allow unsafe-eval, "+"please use @pixi/unsafe-eval module to enable support.")}};ShaderSystem.prototype.contextChange=function contextChange(gl){this.gl=gl};ShaderSystem.prototype.bind=function bind(shader,dontSync){shader.uniforms.globals=this.renderer.globalUniforms;var program=shader.program;var glProgram=program.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(shader);this.shader=shader;if(this.program!==program){this.program=program;this.gl.useProgram(glProgram.program)}if(!dontSync){this.syncUniformGroup(shader.uniformGroup)}return glProgram};ShaderSystem.prototype.setUniforms=function setUniforms(uniforms){var shader=this.shader.program;var glProgram=shader.glPrograms[this.renderer.CONTEXT_UID];shader.syncUniforms(glProgram.uniformData,uniforms,this.renderer)};ShaderSystem.prototype.syncUniformGroup=function syncUniformGroup(group){var glProgram=this.getglProgram();if(!group.static||group.dirtyId!==glProgram.uniformGroups[group.id]){glProgram.uniformGroups[group.id]=group.dirtyId;this.syncUniforms(group,glProgram)}};ShaderSystem.prototype.syncUniforms=function syncUniforms(group,glProgram){var syncFunc=group.syncUniforms[this.shader.program.id]||this.createSyncGroups(group);syncFunc(glProgram.uniformData,group.uniforms,this.renderer)};ShaderSystem.prototype.createSyncGroups=function createSyncGroups(group){var id=this.getSignature(group,this.shader.program.uniformData);if(!this.cache[id]){this.cache[id]=generateUniformsSync(group,this.shader.program.uniformData)}group.syncUniforms[this.shader.program.id]=this.cache[id];return group.syncUniforms[this.shader.program.id]};ShaderSystem.prototype.getSignature=function getSignature(group,uniformData){var uniforms=group.uniforms;var strings=[];for(var i in uniforms){strings.push(i);if(uniformData[i]){strings.push(uniformData[i].type)}}return strings.join("-")};ShaderSystem.prototype.getglProgram=function getglProgram(){if(this.shader){return this.shader.program.glPrograms[this.renderer.CONTEXT_UID]}return null};ShaderSystem.prototype.generateShader=function generateShader(shader){var gl=this.gl;var program=shader.program;var attribMap={};for(var i in program.attributeData){attribMap[i]=program.attributeData[i].location}var shaderProgram=compileProgram(gl,program.vertexSrc,program.fragmentSrc,attribMap);var uniformData={};for(var i$1 in program.uniformData){var data=program.uniformData[i$1];uniformData[i$1]={location:gl.getUniformLocation(shaderProgram,i$1),value:defaultValue(data.type,data.size)}}var glProgram=new GLProgram(shaderProgram,uniformData);program.glPrograms[this.renderer.CONTEXT_UID]=glProgram;return glProgram};ShaderSystem.prototype.reset=function reset(){this.program=null;this.shader=null};ShaderSystem.prototype.destroy=function destroy(){this.destroyed=true};return ShaderSystem}(System);function mapWebGLBlendModesToPixi(gl,array){if(array===void 0)array=[];array[constants.BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.ADD]=[gl.ONE,gl.ONE];array[constants.BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.NONE]=[0,0];array[constants.BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.ONE,gl.ONE,gl.ONE];array[constants.BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.SRC_IN]=[gl.DST_ALPHA,gl.ZERO];array[constants.BLEND_MODES.SRC_OUT]=[gl.ONE_MINUS_DST_ALPHA,gl.ZERO];array[constants.BLEND_MODES.SRC_ATOP]=[gl.DST_ALPHA,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.DST_OVER]=[gl.ONE_MINUS_DST_ALPHA,gl.ONE];array[constants.BLEND_MODES.DST_IN]=[gl.ZERO,gl.SRC_ALPHA];array[constants.BLEND_MODES.DST_OUT]=[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA];array[constants.BLEND_MODES.DST_ATOP]=[gl.ONE_MINUS_DST_ALPHA,gl.SRC_ALPHA];array[constants.BLEND_MODES.SUBTRACT]=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,gl.FUNC_REVERSE_SUBTRACT,gl.FUNC_ADD];return array}var BLEND$1=0;var OFFSET$1=1;var CULLING$1=2;var DEPTH_TEST$1=3;var WINDING$1=4;var StateSystem=function(System){function StateSystem(renderer){System.call(this,renderer);this.gl=null;this.stateId=0;this.polygonOffset=0;this.blendMode=constants.BLEND_MODES.NONE;this._blendEq=false;this.map=[];this.map[BLEND$1]=this.setBlend;this.map[OFFSET$1]=this.setOffset;this.map[CULLING$1]=this.setCullFace;this.map[DEPTH_TEST$1]=this.setDepthTest;this.map[WINDING$1]=this.setFrontFace;this.checks=[];this.defaultState=new State;this.defaultState.blend=true;this.defaultState.depth=true}if(System)StateSystem.__proto__=System;StateSystem.prototype=Object.create(System&&System.prototype);StateSystem.prototype.constructor=StateSystem;StateSystem.prototype.contextChange=function contextChange(gl){this.gl=gl;this.blendModes=mapWebGLBlendModesToPixi(gl);this.setState(this.defaultState);this.reset()};StateSystem.prototype.setState=function setState(state){state=state||this.defaultState;if(this.stateId!==state.data){var diff=this.stateId^state.data;var i=0;while(diff){if(diff&1){this.map[i].call(this,!!(state.data&1<<i))}diff=diff>>1;i++}this.stateId=state.data}for(var i$1=0;i$1<this.checks.length;i$1++){this.checks[i$1](this,state)}};StateSystem.prototype.forceState=function forceState(state){state=state||this.defaultState;for(var i=0;i<this.map.length;i++){this.map[i].call(this,!!(state.data&1<<i))}for(var i$1=0;i$1<this.checks.length;i$1++){this.checks[i$1](this,state)}this.stateId=state.data};StateSystem.prototype.setBlend=function setBlend(value){this.updateCheck(StateSystem.checkBlendMode,value);this.gl[value?"enable":"disable"](this.gl.BLEND)};StateSystem.prototype.setOffset=function setOffset(value){this.updateCheck(StateSystem.checkPolygonOffset,value);this.gl[value?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)};StateSystem.prototype.setDepthTest=function setDepthTest(value){this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST)};StateSystem.prototype.setCullFace=function setCullFace(value){this.gl[value?"enable":"disable"](this.gl.CULL_FACE)};StateSystem.prototype.setFrontFace=function setFrontFace(value){this.gl.frontFace(this.gl[value?"CW":"CCW"])};StateSystem.prototype.setBlendMode=function setBlendMode(value){if(value===this.blendMode){return}this.blendMode=value;var mode=this.blendModes[value];var gl=this.gl;if(mode.length===2){gl.blendFunc(mode[0],mode[1])}else{gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3])}if(mode.length===6){this._blendEq=true;gl.blendEquationSeparate(mode[4],mode[5])}else if(this._blendEq){this._blendEq=false;gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD)}};StateSystem.prototype.setPolygonOffset=function setPolygonOffset(value,scale){this.gl.polygonOffset(value,scale)};StateSystem.prototype.reset=function reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,false);this.forceState(0);this._blendEq=true;this.blendMode=-1;this.setBlendMode(0)};StateSystem.prototype.updateCheck=function updateCheck(func,value){var index=this.checks.indexOf(func);if(value&&index===-1){this.checks.push(func)}else if(!value&&index!==-1){this.checks.splice(index,1)}};StateSystem.checkBlendMode=function checkBlendMode(system,state){system.setBlendMode(state.blendMode)};StateSystem.checkPolygonOffset=function checkPolygonOffset(system,state){system.setPolygonOffset(state.polygonOffset,0)};return StateSystem}(System);var TextureGCSystem=function(System){function TextureGCSystem(renderer){System.call(this,renderer);this.count=0;this.checkCount=0;this.maxIdle=settings.settings.GC_MAX_IDLE;this.checkCountMax=settings.settings.GC_MAX_CHECK_COUNT;this.mode=settings.settings.GC_MODE}if(System)TextureGCSystem.__proto__=System;TextureGCSystem.prototype=Object.create(System&&System.prototype);TextureGCSystem.prototype.constructor=TextureGCSystem;TextureGCSystem.prototype.postrender=function postrender(){this.count++;if(this.mode===constants.GC_MODES.MANUAL){return}this.checkCount++;if(this.checkCount>this.checkCountMax){this.checkCount=0;this.run()}};TextureGCSystem.prototype.run=function run(){var tm=this.renderer.texture;var managedTextures=tm.managedTextures;var wasRemoved=false;for(var i=0;i<managedTextures.length;i++){var texture=managedTextures[i];if(!texture.framebuffer&&this.count-texture.touched>this.maxIdle){tm.destroyTexture(texture,true);managedTextures[i]=null;wasRemoved=true}}if(wasRemoved){var j=0;for(var i$1=0;i$1<managedTextures.length;i$1++){if(managedTextures[i$1]!==null){managedTextures[j++]=managedTextures[i$1]}}managedTextures.length=j}};TextureGCSystem.prototype.unload=function unload(displayObject){var tm=this.renderer.textureSystem;if(displayObject._texture&&displayObject._texture._glRenderTargets){tm.destroyTexture(displayObject._texture)}for(var i=displayObject.children.length-1;i>=0;i--){this.unload(displayObject.children[i])}};return TextureGCSystem}(System);var GLTexture=function GLTexture(texture){this.texture=texture;this.width=-1;this.height=-1;this.dirtyId=-1;this.dirtyStyleId=-1;this.mipmap=false;this.wrapMode=33071};var TextureSystem=function(System){function TextureSystem(renderer){System.call(this,renderer);this.boundTextures=[];this.currentLocation=-1;this.managedTextures=[];this._unknownBoundTextures=false;this.unknownTexture=new BaseTexture}if(System)TextureSystem.__proto__=System;TextureSystem.prototype=Object.create(System&&System.prototype);TextureSystem.prototype.constructor=TextureSystem;TextureSystem.prototype.contextChange=function contextChange(){var gl=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.webGLVersion=this.renderer.context.webGLVersion;var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=maxTextures;for(var i=0;i<maxTextures;i++){this.boundTextures[i]=null}this.emptyTextures={};var emptyTexture2D=new GLTexture(gl.createTexture());gl.bindTexture(gl.TEXTURE_2D,emptyTexture2D.texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array(4));this.emptyTextures[gl.TEXTURE_2D]=emptyTexture2D;this.emptyTextures[gl.TEXTURE_CUBE_MAP]=new GLTexture(gl.createTexture());gl.bindTexture(gl.TEXTURE_CUBE_MAP,this.emptyTextures[gl.TEXTURE_CUBE_MAP].texture);for(var i$1=0;i$1<6;i$1++){gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X+i$1,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,null)}gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_MIN_FILTER,gl.LINEAR);for(var i$2=0;i$2<this.boundTextures.length;i$2++){this.bind(null,i$2)}};TextureSystem.prototype.bind=function bind(texture,location){if(location===void 0)location=0;var ref=this;var gl=ref.gl;if(texture){texture=texture.baseTexture||texture;if(texture.valid){texture.touched=this.renderer.textureGC.count;var glTexture=texture._glTextures[this.CONTEXT_UID]||this.initTexture(texture);if(this.currentLocation!==location){this.currentLocation=location;gl.activeTexture(gl.TEXTURE0+location)}if(this.boundTextures[location]!==texture){gl.bindTexture(texture.target,glTexture.texture)}if(glTexture.dirtyId!==texture.dirtyId){this.updateTexture(texture)}this.boundTextures[location]=texture}}else{if(this.currentLocation!==location){this.currentLocation=location;gl.activeTexture(gl.TEXTURE0+location)}gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[gl.TEXTURE_2D].texture);this.boundTextures[location]=null}};TextureSystem.prototype.reset=function reset(){this._unknownBoundTextures=true;this.currentLocation=-1;for(var i=0;i<this.boundTextures.length;i++){this.boundTextures[i]=this.unknownTexture}};TextureSystem.prototype.unbind=function unbind(texture){var ref=this;var gl=ref.gl;var boundTextures=ref.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=false;for(var i=0;i<boundTextures.length;i++){if(boundTextures[i]===this.unknownTexture){this.bind(null,i)}}}for(var i$1=0;i$1<boundTextures.length;i$1++){if(boundTextures[i$1]===texture){if(this.currentLocation!==i$1){gl.activeTexture(gl.TEXTURE0+i$1);this.currentLocation=i$1}gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[texture.target].texture);boundTextures[i$1]=null}}};TextureSystem.prototype.initTexture=function initTexture(texture){var glTexture=new GLTexture(this.gl.createTexture());glTexture.dirtyId=-1;texture._glTextures[this.CONTEXT_UID]=glTexture;this.managedTextures.push(texture);texture.on("dispose",this.destroyTexture,this);return glTexture};TextureSystem.prototype.updateTexture=function updateTexture(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];var renderer=this.renderer;if(texture.resource&&texture.resource.upload(renderer,texture,glTexture));else{var width=texture.realWidth;var height=texture.realHeight;var gl=renderer.gl;if(glTexture.width!==width||glTexture.height!==height||glTexture.dirtyId<0){glTexture.width=width;glTexture.height=height;gl.texImage2D(texture.target,0,texture.format,width,height,0,texture.format,texture.type,null)}}if(texture.dirtyStyleId!==glTexture.dirtyStyleId){this.updateTextureStyle(texture)}glTexture.dirtyId=texture.dirtyId};TextureSystem.prototype.destroyTexture=function destroyTexture(texture,skipRemove){var ref=this;var gl=ref.gl;texture=texture.baseTexture||texture;if(texture._glTextures[this.CONTEXT_UID]){this.unbind(texture);gl.deleteTexture(texture._glTextures[this.CONTEXT_UID].texture);texture.off("dispose",this.destroyTexture,this);delete texture._glTextures[this.CONTEXT_UID];if(!skipRemove){var i=this.managedTextures.indexOf(texture);if(i!==-1){utils.removeItems(this.managedTextures,i,1)}}}};TextureSystem.prototype.updateTextureStyle=function updateTextureStyle(texture){var glTexture=texture._glTextures[this.CONTEXT_UID];if(!glTexture){return}if((texture.mipmap===constants.MIPMAP_MODES.POW2||this.webGLVersion!==2)&&!texture.isPowerOfTwo){glTexture.mipmap=0;glTexture.wrapMode=constants.WRAP_MODES.CLAMP}else{glTexture.mipmap=texture.mipmap>=1;glTexture.wrapMode=texture.wrapMode}if(texture.resource&&texture.resource.style(this.renderer,texture,glTexture));else{this.setStyle(texture,glTexture)}glTexture.dirtyStyleId=texture.dirtyStyleId};TextureSystem.prototype.setStyle=function setStyle(texture,glTexture){var gl=this.gl;if(glTexture.mipmap){gl.generateMipmap(texture.target)}gl.texParameteri(texture.target,gl.TEXTURE_WRAP_S,glTexture.wrapMode);gl.texParameteri(texture.target,gl.TEXTURE_WRAP_T,glTexture.wrapMode);if(glTexture.mipmap){gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST)}else{gl.texParameteri(texture.target,gl.TEXTURE_MIN_FILTER,texture.scaleMode?gl.LINEAR:gl.NEAREST)}gl.texParameteri(texture.target,gl.TEXTURE_MAG_FILTER,texture.scaleMode?gl.LINEAR:gl.NEAREST)};return TextureSystem}(System);var systems={FilterSystem:FilterSystem,BatchSystem:BatchSystem,ContextSystem:ContextSystem,FramebufferSystem:FramebufferSystem,GeometrySystem:GeometrySystem,MaskSystem:MaskSystem,StencilSystem:StencilSystem,ProjectionSystem:ProjectionSystem,RenderTextureSystem:RenderTextureSystem,ShaderSystem:ShaderSystem,StateSystem:StateSystem,TextureGCSystem:TextureGCSystem,TextureSystem:TextureSystem};var tempMatrix=new math.Matrix;var AbstractRenderer=function(EventEmitter){function AbstractRenderer(system,options){EventEmitter.call(this);options=Object.assign({},settings.settings.RENDER_OPTIONS,options);if(options.roundPixels){settings.settings.ROUND_PIXELS=options.roundPixels;utils.deprecation("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)}this.options=options;this.type=constants.RENDERER_TYPE.UNKNOWN;this.screen=new math.Rectangle(0,0,options.width,options.height);this.view=options.view||document.createElement("canvas");this.resolution=options.resolution||settings.settings.RESOLUTION;this.transparent=options.transparent;this.autoDensity=options.autoDensity||options.autoResize||false;this.preserveDrawingBuffer=options.preserveDrawingBuffer;this.clearBeforeRender=options.clearBeforeRender;this._backgroundColor=0;this._backgroundColorRgba=[0,0,0,0];this._backgroundColorString="#000000";this.backgroundColor=options.backgroundColor||this._backgroundColor;this._tempDisplayObjectParent=new display.Container;this._lastObjectRendered=this._tempDisplayObjectParent;this.plugins={}}if(EventEmitter)AbstractRenderer.__proto__=EventEmitter;AbstractRenderer.prototype=Object.create(EventEmitter&&EventEmitter.prototype);AbstractRenderer.prototype.constructor=AbstractRenderer;var prototypeAccessors={width:{configurable:true},height:{configurable:true},backgroundColor:{configurable:true}};AbstractRenderer.prototype.initPlugins=function initPlugins(staticMap){for(var o in staticMap){this.plugins[o]=new staticMap[o](this)}};prototypeAccessors.width.get=function(){return this.view.width};prototypeAccessors.height.get=function(){return this.view.height};AbstractRenderer.prototype.resize=function resize(screenWidth,screenHeight){this.screen.width=screenWidth;this.screen.height=screenHeight;this.view.width=screenWidth*this.resolution;this.view.height=screenHeight*this.resolution;if(this.autoDensity){this.view.style.width=screenWidth+"px";this.view.style.height=screenHeight+"px"}};AbstractRenderer.prototype.generateTexture=function generateTexture(displayObject,scaleMode,resolution,region){region=region||displayObject.getLocalBounds();if(region.width===0){region.width=1}if(region.height===0){region.height=1}var renderTexture=RenderTexture.create(region.width|0,region.height|0,scaleMode,resolution);tempMatrix.tx=-region.x;tempMatrix.ty=-region.y;this.render(displayObject,renderTexture,false,tempMatrix,!!displayObject.parent);return renderTexture};AbstractRenderer.prototype.destroy=function destroy(removeView){for(var o in this.plugins){this.plugins[o].destroy();this.plugins[o]=null}if(removeView&&this.view.parentNode){this.view.parentNode.removeChild(this.view)}this.plugins=null;this.type=constants.RENDERER_TYPE.UNKNOWN;this.view=null;this.screen=null;this.resolution=0;this.transparent=false;this.autoDensity=false;this.blendModes=null;this.options=null;this.preserveDrawingBuffer=false;this.clearBeforeRender=false;this._backgroundColor=0;this._backgroundColorRgba=null;this._backgroundColorString=null;this._tempDisplayObjectParent=null;this._lastObjectRendered=null};prototypeAccessors.backgroundColor.get=function(){return this._backgroundColor};prototypeAccessors.backgroundColor.set=function(value){this._backgroundColor=value;this._backgroundColorString=utils.hex2string(value);utils.hex2rgb(value,this._backgroundColorRgba)};Object.defineProperties(AbstractRenderer.prototype,prototypeAccessors);return AbstractRenderer}(utils.EventEmitter);var Renderer=function(AbstractRenderer){function Renderer(options){if(options===void 0)options={};AbstractRenderer.call(this,"WebGL",options);options=this.options;this.type=constants.RENDERER_TYPE.WEBGL;this.gl=null;this.CONTEXT_UID=0;this.runners={destroy:new runner.Runner("destroy"),contextChange:new runner.Runner("contextChange",1),reset:new runner.Runner("reset"),update:new runner.Runner("update"),postrender:new runner.Runner("postrender"),prerender:new runner.Runner("prerender"),resize:new runner.Runner("resize",2)};this.globalUniforms=new UniformGroup({projectionMatrix:new math.Matrix},true);this.addSystem(MaskSystem,"mask").addSystem(ContextSystem,"context").addSystem(StateSystem,"state").addSystem(ShaderSystem,"shader").addSystem(TextureSystem,"texture").addSystem(GeometrySystem,"geometry").addSystem(FramebufferSystem,"framebuffer").addSystem(StencilSystem,"stencil").addSystem(ProjectionSystem,"projection").addSystem(TextureGCSystem,"textureGC").addSystem(FilterSystem,"filter").addSystem(RenderTextureSystem,"renderTexture").addSystem(BatchSystem,"batch");this.initPlugins(Renderer.__plugins);if(options.context){this.context.initFromContext(options.context)}else{this.context.initFromOptions({alpha:this.transparent,antialias:options.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:options.preserveDrawingBuffer,powerPreference:this.options.powerPreference})}this.renderingToScreen=true;utils.sayHello(this.context.webGLVersion===2?"WebGL 2":"WebGL 1");this.resize(this.options.width,this.options.height)}if(AbstractRenderer)Renderer.__proto__=AbstractRenderer;Renderer.prototype=Object.create(AbstractRenderer&&AbstractRenderer.prototype);Renderer.prototype.constructor=Renderer;Renderer.create=function create(options){if(utils.isWebGLSupported()){return new Renderer(options)}throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')};Renderer.prototype.addSystem=function addSystem(ClassRef,name){if(!name){name=ClassRef.name}var system=new ClassRef(this);if(this[name]){throw new Error('Whoops! The name "'+name+'" is already in use')}this[name]=system;for(var i in this.runners){this.runners[i].add(system)}return this};Renderer.prototype.render=function render(displayObject,renderTexture,clear,transform,skipUpdateTransform){this.renderingToScreen=!renderTexture;this.runners.prerender.run();this.emit("prerender");this.projection.transform=transform;if(this.context.isLost){return}if(!renderTexture){this._lastObjectRendered=displayObject}if(!skipUpdateTransform){var cacheParent=displayObject.parent;displayObject.parent=this._tempDisplayObjectParent;displayObject.updateTransform();displayObject.parent=cacheParent}this.renderTexture.bind(renderTexture);this.batch.currentRenderer.start();if(clear!==undefined?clear:this.clearBeforeRender){this.renderTexture.clear()}displayObject.render(this);this.batch.currentRenderer.flush();if(renderTexture){renderTexture.baseTexture.update()}this.runners.postrender.run();this.projection.transform=null;this.emit("postrender")};Renderer.prototype.resize=function resize(screenWidth,screenHeight){AbstractRenderer.prototype.resize.call(this,screenWidth,screenHeight);this.runners.resize.run(screenWidth,screenHeight)};Renderer.prototype.reset=function reset(){this.runners.reset.run();return this};Renderer.prototype.clear=function clear(){this.framebuffer.bind();this.framebuffer.clear()};Renderer.prototype.destroy=function destroy(removeView){this.runners.destroy.run();AbstractRenderer.prototype.destroy.call(this,removeView);this.gl=null};Renderer.registerPlugin=function registerPlugin(pluginName,ctor){Renderer.__plugins=Renderer.__plugins||{};Renderer.__plugins[pluginName]=ctor};return Renderer}(AbstractRenderer);function autoDetectRenderer(options){return Renderer.create(options)}var _default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";var defaultFilter="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";var CubeTexture=function(BaseTexture){function CubeTexture(){BaseTexture.apply(this,arguments)}if(BaseTexture)CubeTexture.__proto__=BaseTexture;CubeTexture.prototype=Object.create(BaseTexture&&BaseTexture.prototype);CubeTexture.prototype.constructor=CubeTexture;CubeTexture.from=function from(resources,options){return new CubeTexture(new CubeResource(resources,options))};return CubeTexture}(BaseTexture);var BatchGeometry=function(Geometry){function BatchGeometry(_static){if(_static===void 0)_static=false;Geometry.call(this);this._buffer=new Buffer(null,_static,false);this._indexBuffer=new Buffer(null,_static,true);this.addAttribute("aVertexPosition",this._buffer,2,false,constants.TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,false,constants.TYPES.FLOAT).addAttribute("aColor",this._buffer,4,true,constants.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,true,constants.TYPES.FLOAT).addIndex(this._indexBuffer)}if(Geometry)BatchGeometry.__proto__=Geometry;BatchGeometry.prototype=Object.create(Geometry&&Geometry.prototype);BatchGeometry.prototype.constructor=BatchGeometry;return BatchGeometry}(Geometry);var BatchDrawCall=function BatchDrawCall(){this.textures=[];this.ids=[];this.blend=0;this.textureCount=0;this.start=0;this.size=0;this.type=4};var BatchBuffer=function BatchBuffer(size){this.vertices=new ArrayBuffer(size);this.float32View=new Float32Array(this.vertices);this.uint32View=new Uint32Array(this.vertices)};BatchBuffer.prototype.destroy=function destroy(){this.vertices=null;this.float32View=null;this.uint32View=null};var vertex$1="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n";var fragTemplate$1=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n");var defaultGroupCache={};var programCache={};function generateMultiTextureShader(gl,maxTextures){if(!programCache[maxTextures]){var sampleValues=new Int32Array(maxTextures);for(var i=0;i<maxTextures;i++){sampleValues[i]=i}defaultGroupCache[maxTextures]=UniformGroup.from({uSamplers:sampleValues},true);var fragmentSrc=fragTemplate$1;fragmentSrc=fragmentSrc.replace(/%count%/gi,maxTextures);fragmentSrc=fragmentSrc.replace(/%forloop%/gi,generateSampleSrc(maxTextures));programCache[maxTextures]=new Program(vertex$1,fragmentSrc)}var uniforms={tint:new Float32Array([1,1,1,1]),translationMatrix:new math.Matrix,default:defaultGroupCache[maxTextures]};var shader=new Shader(programCache[maxTextures],uniforms);return shader}function generateSampleSrc(maxTextures){var src="";src+="\n";src+="\n";for(var i=0;i<maxTextures;i++){if(i>0){src+="\nelse "}if(i<maxTextures-1){src+="if(vTextureId < "+i+".5)"}src+="\n{";src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);";src+="\n}"}src+="\n";src+="\n";return src}var BatchRenderer=function(ObjectRenderer){function BatchRenderer(renderer){ObjectRenderer.call(this,renderer);this.vertSize=6;this.vertByteSize=this.vertSize*4;this.size=2e3*4;this.currentSize=0;this.currentIndexSize=0;this.attributeBuffers={};this.aBuffers={};this.iBuffers={};this.onlySprites=false;this.shader=null;this.currentIndex=0;this.groups=[];for(var k=0;k<this.size/4;k++){this.groups[k]=new BatchDrawCall}this.elements=[];this.vaos=[];this.vaoMax=2;this.vertexCount=0;this.renderer.on("prerender",this.onPrerender,this);this.state=State.for2d()}if(ObjectRenderer)BatchRenderer.__proto__=ObjectRenderer;BatchRenderer.prototype=Object.create(ObjectRenderer&&ObjectRenderer.prototype);BatchRenderer.prototype.constructor=BatchRenderer;BatchRenderer.prototype.contextChange=function contextChange(){var gl=this.renderer.gl;if(settings.settings.PREFER_ENV===constants.ENV.WEBGL_LEGACY){this.MAX_TEXTURES=1}else{this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),settings.settings.SPRITE_MAX_TEXTURES);this.MAX_TEXTURES=checkMaxIfStatementsInShader(this.MAX_TEXTURES,gl)}this.shader=generateMultiTextureShader(gl,this.MAX_TEXTURES);for(var i=0;i<this.vaoMax;i++){this.vaos[i]=new BatchGeometry}};BatchRenderer.prototype.onPrerender=function onPrerender(){this.vertexCount=0};BatchRenderer.prototype.render=function render(element){if(!element._texture.valid){return}if(this.currentSize+element.vertexData.length/2>this.size){this.flush()}this.elements[this.currentIndex++]=element;this.currentSize+=element.vertexData.length/2;this.currentIndexSize+=element.indices.length};BatchRenderer.prototype.getIndexBuffer=function getIndexBuffer(size){var roundedP2=utils.nextPow2(Math.ceil(size/12));var roundedSizeIndex=utils.log2(roundedP2);var roundedSize=roundedP2*12;if(this.iBuffers.length<=roundedSizeIndex){this.iBuffers.length=roundedSizeIndex+1}var buffer=this.iBuffers[roundedSizeIndex];if(!buffer){this.iBuffers[roundedSizeIndex]=buffer=new Uint16Array(roundedSize)}return buffer};BatchRenderer.prototype.getAttributeBuffer=function getAttributeBuffer(size){var roundedP2=utils.nextPow2(Math.ceil(size/8));var roundedSizeIndex=utils.log2(roundedP2);var roundedSize=roundedP2*8;if(this.aBuffers.length<=roundedSizeIndex){this.iBuffers.length=roundedSizeIndex+1}var buffer=this.aBuffers[roundedSize];if(!buffer){this.aBuffers[roundedSize]=buffer=new BatchBuffer(roundedSize*this.vertByteSize)}return buffer};BatchRenderer.prototype.flush=function flush(){if(this.currentSize===0){return}var gl=this.renderer.gl;var MAX_TEXTURES=this.MAX_TEXTURES;var buffer=this.getAttributeBuffer(this.currentSize);var indexBuffer=this.getIndexBuffer(this.currentIndexSize);var elements=this.elements;var groups=this.groups;var float32View=buffer.float32View;var uint32View=buffer.uint32View;var touch=this.renderer.textureGC.count;var index=0;var indexCount=0;var nextTexture;var currentTexture;var groupCount=0;var textureCount=0;var currentGroup=groups[0];var blendMode=-1;currentGroup.textureCount=0;currentGroup.start=0;currentGroup.blend=blendMode;var TICK=++BaseTexture._globalBatch;var i;for(i=0;i<this.currentIndex;++i){var sprite=elements[i];elements[i]=null;nextTexture=sprite._texture.baseTexture;var spriteBlendMode=utils.premultiplyBlendMode[nextTexture.premultiplyAlpha?1:0][sprite.blendMode];if(blendMode!==spriteBlendMode){blendMode=spriteBlendMode;currentTexture=null;textureCount=MAX_TEXTURES;TICK++}if(currentTexture!==nextTexture){currentTexture=nextTexture;if(nextTexture._batchEnabled!==TICK){if(textureCount===MAX_TEXTURES){TICK++;textureCount=0;currentGroup.size=indexCount-currentGroup.start;currentGroup=groups[groupCount++];currentGroup.textureCount=0;currentGroup.blend=blendMode;currentGroup.start=indexCount}nextTexture.touched=touch;nextTexture._batchEnabled=TICK;nextTexture._id=textureCount;currentGroup.textures[currentGroup.textureCount++]=nextTexture;textureCount++}}this.packGeometry(sprite,float32View,uint32View,indexBuffer,index,indexCount);index+=sprite.vertexData.length/2*this.vertSize;indexCount+=sprite.indices.length}BaseTexture._globalBatch=TICK;currentGroup.size=indexCount-currentGroup.start;if(!settings.settings.CAN_UPLOAD_SAME_BUFFER){if(this.vaoMax<=this.vertexCount){this.vaoMax++;this.vaos[this.vertexCount]=new BatchGeometry}this.vaos[this.vertexCount]._buffer.update(buffer.vertices,0);this.vaos[this.vertexCount]._indexBuffer.update(indexBuffer,0);this.renderer.geometry.bind(this.vaos[this.vertexCount]);this.renderer.geometry.updateBuffers();this.vertexCount++}else{this.vaos[this.vertexCount]._buffer.update(buffer.vertices,0);this.vaos[this.vertexCount]._indexBuffer.update(indexBuffer,0);this.renderer.geometry.updateBuffers()}var textureSystem=this.renderer.texture;var stateSystem=this.renderer.state;for(i=0;i<groupCount;i++){var group=groups[i];var groupTextureCount=group.textureCount;for(var j=0;j<groupTextureCount;j++){textureSystem.bind(group.textures[j],j);group.textures[j]=null}stateSystem.setBlendMode(group.blend);gl.drawElements(group.type,group.size,gl.UNSIGNED_SHORT,group.start*2)}this.currentIndex=0;this.currentSize=0;this.currentIndexSize=0};BatchRenderer.prototype.packGeometry=function packGeometry(element,float32View,uint32View,indexBuffer,index,indexCount){var p=index/this.vertSize;var uvs=element.uvs;var indicies=element.indices;var vertexData=element.vertexData;var textureId=element._texture.baseTexture._id;var alpha=Math.min(element.worldAlpha,1);var argb=alpha<1&&element._texture.baseTexture.premultiplyAlpha?utils.premultiplyTint(element._tintRGB,alpha):element._tintRGB+(alpha*255<<24);for(var i=0;i<vertexData.length;i+=2){float32View[index++]=vertexData[i];float32View[index++]=vertexData[i+1];float32View[index++]=uvs[i];float32View[index++]=uvs[i+1];uint32View[index++]=argb;float32View[index++]=textureId}for(var i$1=0;i$1<indicies.length;i$1++){indexBuffer[indexCount++]=p+indicies[i$1]}};BatchRenderer.prototype.start=function start(){this.renderer.state.setState(this.state);this.renderer.shader.bind(this.shader);if(settings.settings.CAN_UPLOAD_SAME_BUFFER){this.renderer.geometry.bind(this.vaos[this.vertexCount])}};BatchRenderer.prototype.stop=function stop(){this.flush()};BatchRenderer.prototype.destroy=function destroy(){for(var i=0;i<this.vaoMax;i++){if(this.vaos[i]){this.vaos[i].destroy()}}if(this.indexBuffer){this.indexBuffer.destroy()}this.renderer.off("prerender",this.onPrerender,this);if(this.shader){this.shader.destroy();this.shader=null}this.vaos=null;this.indexBuffer=null;this.indices=null;this.sprites=null;ObjectRenderer.prototype.destroy.call(this)};return BatchRenderer}(ObjectRenderer);exports.AbstractRenderer=AbstractRenderer;exports.Attribute=Attribute;exports.BaseRenderTexture=BaseRenderTexture;exports.BaseTexture=BaseTexture;exports.BatchDrawCall=BatchDrawCall;exports.BatchGeometry=BatchGeometry;exports.BatchRenderer=BatchRenderer;exports.Buffer=Buffer;exports.CubeTexture=CubeTexture;exports.Filter=Filter;exports.Framebuffer=Framebuffer;exports.GLProgram=GLProgram;exports.GLTexture=BaseTexture;exports.Geometry=Geometry;exports.ObjectRenderer=ObjectRenderer;exports.Program=Program;exports.Quad=Quad;exports.QuadUv=QuadUv;exports.RenderTexture=RenderTexture;exports.Renderer=Renderer;exports.Shader=Shader;exports.SpriteMaskFilter=SpriteMaskFilter;exports.State=State;exports.System=System;exports.Texture=Texture;exports.TextureMatrix=TextureMatrix;exports.TextureUvs=TextureUvs;exports.UniformGroup=UniformGroup;exports.autoDetectRenderer=autoDetectRenderer;exports.checkMaxIfStatementsInShader=checkMaxIfStatementsInShader;exports.defaultFilterVertex=defaultFilter;exports.defaultVertex=_default;exports.generateMultiTextureShader=generateMultiTextureShader;exports.resources=index;exports.systems=systems},{"@pixi/constants":15,"@pixi/display":17,"@pixi/math":28,"@pixi/runner":37,"@pixi/settings":38,"@pixi/ticker":45,"@pixi/utils":46}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var settings=require("@pixi/settings");var math=require("@pixi/math");var utils=require("@pixi/utils");settings.settings.SORTABLE_CHILDREN=false;var Bounds=function Bounds(){this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity;this.rect=null};Bounds.prototype.isEmpty=function isEmpty(){return this.minX>this.maxX||this.minY>this.maxY};Bounds.prototype.clear=function clear(){this.updateID++;this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity};Bounds.prototype.getRectangle=function getRectangle(rect){if(this.minX>this.maxX||this.minY>this.maxY){return math.Rectangle.EMPTY}rect=rect||new math.Rectangle(0,0,1,1);rect.x=this.minX;rect.y=this.minY;rect.width=this.maxX-this.minX;rect.height=this.maxY-this.minY;return rect};Bounds.prototype.addPoint=function addPoint(point){this.minX=Math.min(this.minX,point.x);this.maxX=Math.max(this.maxX,point.x);this.minY=Math.min(this.minY,point.y);this.maxY=Math.max(this.maxY,point.y)};Bounds.prototype.addQuad=function addQuad(vertices){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;var x=vertices[0];var y=vertices[1];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[2];y=vertices[3];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[4];y=vertices[5];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[6];y=vertices[7];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addFrame=function addFrame(transform,x0,y0,x1,y1){var matrix=transform.worldTransform;var a=matrix.a;var b=matrix.b;var c=matrix.c;var d=matrix.d;var tx=matrix.tx;var ty=matrix.ty;var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;var x=a*x0+c*y0+tx;var y=b*x0+d*y0+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x1+c*y0+tx;y=b*x1+d*y0+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x0+c*y1+tx;y=b*x0+d*y1+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x1+c*y1+tx;y=b*x1+d*y1+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addVertexData=function addVertexData(vertexData,beginOffset,endOffset){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;for(var i=beginOffset;i<endOffset;i+=2){var x=vertexData[i];var y=vertexData[i+1];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY}this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addVertices=function addVertices(transform,vertices,beginOffset,endOffset){var matrix=transform.worldTransform;var a=matrix.a;var b=matrix.b;var c=matrix.c;var d=matrix.d;var tx=matrix.tx;var ty=matrix.ty;var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;for(var i=beginOffset;i<endOffset;i+=2){var rawX=vertices[i];var rawY=vertices[i+1];var x=a*rawX+c*rawY+tx;var y=d*rawY+b*rawX+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY}this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addBounds=function addBounds(bounds){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=bounds.minX<minX?bounds.minX:minX;this.minY=bounds.minY<minY?bounds.minY:minY;this.maxX=bounds.maxX>maxX?bounds.maxX:maxX;this.maxY=bounds.maxY>maxY?bounds.maxY:maxY};Bounds.prototype.addBoundsMask=function addBoundsMask(bounds,mask){var _minX=bounds.minX>mask.minX?bounds.minX:mask.minX;var _minY=bounds.minY>mask.minY?bounds.minY:mask.minY;var _maxX=bounds.maxX<mask.maxX?bounds.maxX:mask.maxX;var _maxY=bounds.maxY<mask.maxY?bounds.maxY:mask.maxY;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=_minX<minX?_minX:minX;this.minY=_minY<minY?_minY:minY;this.maxX=_maxX>maxX?_maxX:maxX;this.maxY=_maxY>maxY?_maxY:maxY}};Bounds.prototype.addBoundsArea=function addBoundsArea(bounds,area){var _minX=bounds.minX>area.x?bounds.minX:area.x;var _minY=bounds.minY>area.y?bounds.minY:area.y;var _maxX=bounds.maxX<area.x+area.width?bounds.maxX:area.x+area.width;var _maxY=bounds.maxY<area.y+area.height?bounds.maxY:area.y+area.height;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=_minX<minX?_minX:minX;this.minY=_minY<minY?_minY:minY;this.maxX=_maxX>maxX?_maxX:maxX;this.maxY=_maxY>maxY?_maxY:maxY}};var DisplayObject=function(EventEmitter){function DisplayObject(){EventEmitter.call(this);this.tempDisplayObjectParent=null;this.transform=new math.Transform;this.alpha=1;this.visible=true;this.renderable=true;this.parent=null;this.worldAlpha=1;this._lastSortedIndex=0;this._zIndex=0;this.filterArea=null;this.filters=null;this._enabledFilters=null;this._bounds=new Bounds;this._boundsID=0;this._lastBoundsID=-1;this._boundsRect=null;this._localBoundsRect=null;this._mask=null;this._destroyed=false;this.isSprite=false}if(EventEmitter)DisplayObject.__proto__=EventEmitter;DisplayObject.prototype=Object.create(EventEmitter&&EventEmitter.prototype);DisplayObject.prototype.constructor=DisplayObject;var prototypeAccessors={_tempDisplayObjectParent:{configurable:true},x:{configurable:true},y:{configurable:true},worldTransform:{configurable:true},localTransform:{configurable:true},position:{configurable:true},scale:{configurable:true},pivot:{configurable:true},skew:{configurable:true},rotation:{configurable:true},angle:{configurable:true},zIndex:{configurable:true},worldVisible:{configurable:true},mask:{configurable:true}};DisplayObject.mixin=function mixin(source){var keys=Object.keys(source);for(var i=0;i<keys.length;++i){var propertyName=keys[i];Object.defineProperty(DisplayObject.prototype,propertyName,Object.getOwnPropertyDescriptor(source,propertyName))}};prototypeAccessors._tempDisplayObjectParent.get=function(){if(this.tempDisplayObjectParent===null){this.tempDisplayObjectParent=new DisplayObject}return this.tempDisplayObjectParent};DisplayObject.prototype.updateTransform=function updateTransform(){this.transform.updateTransform(this.parent.transform);this.worldAlpha=this.alpha*this.parent.worldAlpha;this._bounds.updateID++};DisplayObject.prototype._recursivePostUpdateTransform=function _recursivePostUpdateTransform(){if(this.parent){this.parent._recursivePostUpdateTransform();this.transform.updateTransform(this.parent.transform)}else{this.transform.updateTransform(this._tempDisplayObjectParent.transform)}};DisplayObject.prototype.getBounds=function getBounds(skipUpdate,rect){if(!skipUpdate){if(!this.parent){this.parent=this._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this._recursivePostUpdateTransform();this.updateTransform()}}if(this._boundsID!==this._lastBoundsID){this.calculateBounds()}if(!rect){if(!this._boundsRect){this._boundsRect=new math.Rectangle}rect=this._boundsRect}return this._bounds.getRectangle(rect)};DisplayObject.prototype.getLocalBounds=function getLocalBounds(rect){var transformRef=this.transform;var parentRef=this.parent;this.parent=null;this.transform=this._tempDisplayObjectParent.transform;if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new math.Rectangle}rect=this._localBoundsRect}var bounds=this.getBounds(false,rect);this.parent=parentRef;this.transform=transformRef;return bounds};DisplayObject.prototype.toGlobal=function toGlobal(position,point,skipUpdate){if(skipUpdate===void 0)skipUpdate=false;if(!skipUpdate){this._recursivePostUpdateTransform();if(!this.parent){this.parent=this._tempDisplayObjectParent;this.displayObjectUpdateTransform();this.parent=null}else{this.displayObjectUpdateTransform()}}return this.worldTransform.apply(position,point)};DisplayObject.prototype.toLocal=function toLocal(position,from,point,skipUpdate){if(from){position=from.toGlobal(position,point,skipUpdate)}if(!skipUpdate){this._recursivePostUpdateTransform();if(!this.parent){this.parent=this._tempDisplayObjectParent;this.displayObjectUpdateTransform();this.parent=null}else{this.displayObjectUpdateTransform()}}return this.worldTransform.applyInverse(position,point)};DisplayObject.prototype.render=function render(renderer){};DisplayObject.prototype.setParent=function setParent(container){if(!container||!container.addChild){throw new Error("setParent: Argument must be a Container")}container.addChild(this);return container};DisplayObject.prototype.setTransform=function setTransform(x,y,scaleX,scaleY,rotation,skewX,skewY,pivotX,pivotY){if(x===void 0)x=0;if(y===void 0)y=0;if(scaleX===void 0)scaleX=1;if(scaleY===void 0)scaleY=1;if(rotation===void 0)rotation=0;if(skewX===void 0)skewX=0;if(skewY===void 0)skewY=0;if(pivotX===void 0)pivotX=0;if(pivotY===void 0)pivotY=0;this.position.x=x;this.position.y=y;this.scale.x=!scaleX?1:scaleX;this.scale.y=!scaleY?1:scaleY;this.rotation=rotation;this.skew.x=skewX;this.skew.y=skewY;this.pivot.x=pivotX;this.pivot.y=pivotY;return this};DisplayObject.prototype.destroy=function destroy(){this.removeAllListeners();if(this.parent){this.parent.removeChild(this)}this.transform=null;this.parent=null;this._bounds=null;this._currentBounds=null;this._mask=null;this.filterArea=null;this.interactive=false;this.interactiveChildren=false;this._destroyed=true};prototypeAccessors.x.get=function(){return this.position.x};prototypeAccessors.x.set=function(value){this.transform.position.x=value};prototypeAccessors.y.get=function(){return this.position.y};prototypeAccessors.y.set=function(value){this.transform.position.y=value};prototypeAccessors.worldTransform.get=function(){return this.transform.worldTransform};prototypeAccessors.localTransform.get=function(){return this.transform.localTransform};prototypeAccessors.position.get=function(){return this.transform.position};prototypeAccessors.position.set=function(value){this.transform.position.copyFrom(value)};prototypeAccessors.scale.get=function(){return this.transform.scale};prototypeAccessors.scale.set=function(value){this.transform.scale.copyFrom(value)};prototypeAccessors.pivot.get=function(){return this.transform.pivot};prototypeAccessors.pivot.set=function(value){this.transform.pivot.copyFrom(value)};prototypeAccessors.skew.get=function(){return this.transform.skew};prototypeAccessors.skew.set=function(value){this.transform.skew.copyFrom(value)};prototypeAccessors.rotation.get=function(){return this.transform.rotation};prototypeAccessors.rotation.set=function(value){this.transform.rotation=value};prototypeAccessors.angle.get=function(){return this.transform.rotation*math.RAD_TO_DEG};prototypeAccessors.angle.set=function(value){this.transform.rotation=value*math.DEG_TO_RAD};prototypeAccessors.zIndex.get=function(){return this._zIndex};prototypeAccessors.zIndex.set=function(value){this._zIndex=value;if(this.parent){this.parent.sortDirty=true}};prototypeAccessors.worldVisible.get=function(){var item=this;do{if(!item.visible){return false}item=item.parent}while(item);return true};prototypeAccessors.mask.get=function(){return this._mask};prototypeAccessors.mask.set=function(value){if(this._mask){this._mask.renderable=true;this._mask.isMask=false}this._mask=value;if(this._mask){this._mask.renderable=false;this._mask.isMask=true}};Object.defineProperties(DisplayObject.prototype,prototypeAccessors);return DisplayObject}(utils.EventEmitter);DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;function sortChildren(a,b){if(a.zIndex===b.zIndex){return a._lastSortedIndex-b._lastSortedIndex}return a.zIndex-b.zIndex}var Container=function(DisplayObject){function Container(){DisplayObject.call(this);this.children=[];this.sortableChildren=settings.settings.SORTABLE_CHILDREN;this.sortDirty=false}if(DisplayObject)Container.__proto__=DisplayObject;Container.prototype=Object.create(DisplayObject&&DisplayObject.prototype);Container.prototype.constructor=Container;var prototypeAccessors={width:{configurable:true},height:{configurable:true}};Container.prototype.onChildrenChange=function onChildrenChange(){};Container.prototype.addChild=function addChild(child){var arguments$1=arguments;var argumentsLength=arguments.length;if(argumentsLength>1){for(var i=0;i<argumentsLength;i++){this.addChild(arguments$1[i])}}else{if(child.parent){child.parent.removeChild(child)}child.parent=this;this.sortDirty=true;child.transform._parentID=-1;this.children.push(child);this._boundsID++;this.onChildrenChange(this.children.length-1);this.emit("childAdded",child,this,this.children.length-1);child.emit("added",this)}return child};Container.prototype.addChildAt=function addChildAt(child,index){if(index<0||index>this.children.length){throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length)}if(child.parent){child.parent.removeChild(child)}child.parent=this;this.sortDirty=true;child.transform._parentID=-1;this.children.splice(index,0,child);this._boundsID++;this.onChildrenChange(index);child.emit("added",this);this.emit("childAdded",child,this,index);return child};Container.prototype.swapChildren=function swapChildren(child,child2){if(child===child2){return}var index1=this.getChildIndex(child);var index2=this.getChildIndex(child2);this.children[index1]=child2;this.children[index2]=child;this.onChildrenChange(index1<index2?index1:index2)};Container.prototype.getChildIndex=function getChildIndex(child){var index=this.children.indexOf(child);if(index===-1){throw new Error("The supplied DisplayObject must be a child of the caller")}return index};Container.prototype.setChildIndex=function setChildIndex(child,index){if(index<0||index>=this.children.length){throw new Error("The index "+index+" supplied is out of bounds "+this.children.length)}var currentIndex=this.getChildIndex(child);utils.removeItems(this.children,currentIndex,1);this.children.splice(index,0,child);this.onChildrenChange(index)};Container.prototype.getChildAt=function getChildAt(index){if(index<0||index>=this.children.length){throw new Error("getChildAt: Index ("+index+") does not exist.")}return this.children[index]};Container.prototype.removeChild=function removeChild(child){var arguments$1=arguments;var argumentsLength=arguments.length;if(argumentsLength>1){for(var i=0;i<argumentsLength;i++){this.removeChild(arguments$1[i])}}else{var index=this.children.indexOf(child);if(index===-1){return null}child.parent=null;child.transform._parentID=-1;utils.removeItems(this.children,index,1);this._boundsID++;this.onChildrenChange(index);child.emit("removed",this);this.emit("childRemoved",child,this,index)}return child};Container.prototype.removeChildAt=function removeChildAt(index){var child=this.getChildAt(index);child.parent=null;child.transform._parentID=-1;utils.removeItems(this.children,index,1);this._boundsID++;this.onChildrenChange(index);child.emit("removed",this);this.emit("childRemoved",child,this,index);return child};Container.prototype.removeChildren=function removeChildren(beginIndex,endIndex){if(beginIndex===void 0)beginIndex=0;var begin=beginIndex;var end=typeof endIndex==="number"?endIndex:this.children.length;var range=end-begin;var removed;if(range>0&&range<=end){removed=this.children.splice(begin,range);for(var i=0;i<removed.length;++i){removed[i].parent=null;if(removed[i].transform){removed[i].transform._parentID=-1}}this._boundsID++;this.onChildrenChange(beginIndex);for(var i$1=0;i$1<removed.length;++i$1){removed[i$1].emit("removed",this);this.emit("childRemoved",removed[i$1],this,i$1)}return removed}else if(range===0&&this.children.length===0){return[]}throw new RangeError("removeChildren: numeric values are outside the acceptable range.")};Container.prototype.sortChildren=function sortChildren$1(){var sortRequired=false;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];child._lastSortedIndex=i;if(!sortRequired&&child.zIndex!==0){sortRequired=true}}if(sortRequired&&this.children.length>1){this.children.sort(sortChildren)}this.sortDirty=false};Container.prototype.updateTransform=function updateTransform(){if(this.sortableChildren&&this.sortDirty){this.sortChildren()}this._boundsID++;this.transform.updateTransform(this.parent.transform);this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];if(child.visible){child.updateTransform()}}};Container.prototype.calculateBounds=function calculateBounds(){this._bounds.clear();this._calculateBounds();for(var i=0;i<this.children.length;i++){var child=this.children[i];if(!child.visible||!child.renderable){continue}child.calculateBounds();if(child._mask){child._mask.calculateBounds();this._bounds.addBoundsMask(child._bounds,child._mask._bounds)}else if(child.filterArea){this._bounds.addBoundsArea(child._bounds,child.filterArea)}else{this._bounds.addBounds(child._bounds)}}this._lastBoundsID=this._boundsID};Container.prototype._calculateBounds=function _calculateBounds(){};Container.prototype.render=function render(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}if(this._mask||this.filters){this.renderAdvanced(renderer)}else{this._render(renderer);for(var i=0,j=this.children.length;i<j;++i){this.children[i].render(renderer)}}};Container.prototype.renderAdvanced=function renderAdvanced(renderer){renderer.batch.flush();var filters=this.filters;var mask=this._mask;if(filters){if(!this._enabledFilters){this._enabledFilters=[]}this._enabledFilters.length=0;for(var i=0;i<filters.length;i++){if(filters[i].enabled){this._enabledFilters.push(filters[i])}}if(this._enabledFilters.length){renderer.filter.push(this,this._enabledFilters)}}if(mask){renderer.mask.push(this,this._mask)}this._render(renderer);for(var i$1=0,j=this.children.length;i$1<j;i$1++){this.children[i$1].render(renderer)}renderer.batch.flush();if(mask){renderer.mask.pop(this,this._mask)}if(filters&&this._enabledFilters&&this._enabledFilters.length){renderer.filter.pop()}};Container.prototype._render=function _render(renderer){};Container.prototype.destroy=function destroy(options){DisplayObject.prototype.destroy.call(this);this.sortDirty=false;var destroyChildren=typeof options==="boolean"?options:options&&options.children;var oldChildren=this.removeChildren(0,this.children.length);if(destroyChildren){for(var i=0;i<oldChildren.length;++i){oldChildren[i].destroy(options)}}};prototypeAccessors.width.get=function(){return this.scale.x*this.getLocalBounds().width};prototypeAccessors.width.set=function(value){var width=this.getLocalBounds().width;if(width!==0){this.scale.x=value/width}else{this.scale.x=1}this._width=value};prototypeAccessors.height.get=function(){return this.scale.y*this.getLocalBounds().height};prototypeAccessors.height.set=function(value){var height=this.getLocalBounds().height;if(height!==0){this.scale.y=value/height}else{this.scale.y=1}this._height=value};Object.defineProperties(Container.prototype,prototypeAccessors);return Container}(DisplayObject);Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;exports.Bounds=Bounds;exports.Container=Container;exports.DisplayObject=DisplayObject},{"@pixi/math":28,"@pixi/settings":38,"@pixi/utils":46}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var utils=require("@pixi/utils");var math=require("@pixi/math");var TEMP_RECT=new math.Rectangle;var BYTES_PER_PIXEL=4;var Extract=function Extract(renderer){this.renderer=renderer;renderer.extract=this};Extract.prototype.image=function image(target,format,quality){var image=new Image;image.src=this.base64(target,format,quality);return image};Extract.prototype.base64=function base64(target,format,quality){return this.canvas(target).toDataURL(format,quality)};Extract.prototype.canvas=function canvas(target){var renderer=this.renderer;var resolution;var frame;var flipY=false;var renderTexture;var generated=false;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=this.renderer.generateTexture(target);generated=true}}if(renderTexture){resolution=renderTexture.baseTexture.resolution;frame=renderTexture.frame;flipY=false;renderer.renderTexture.bind(renderTexture)}else{resolution=this.renderer.resolution;flipY=true;frame=TEMP_RECT;frame.width=this.renderer.width;frame.height=this.renderer.height;renderer.renderTexture.bind(null)}var width=frame.width*resolution;var height=frame.height*resolution;var canvasBuffer=new utils.CanvasRenderTarget(width,height,1);var webglPixels=new Uint8Array(BYTES_PER_PIXEL*width*height);var gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels);var canvasData=canvasBuffer.context.getImageData(0,0,width,height);canvasData.data.set(webglPixels);canvasBuffer.context.putImageData(canvasData,0,0);if(flipY){canvasBuffer.context.scale(1,-1);canvasBuffer.context.drawImage(canvasBuffer.canvas,0,-height)}if(generated){renderTexture.destroy(true)}return canvasBuffer.canvas};Extract.prototype.pixels=function pixels(target){var renderer=this.renderer;var resolution;var frame;var renderTexture;var generated=false;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=this.renderer.generateTexture(target);generated=true}}if(renderTexture){resolution=renderTexture.baseTexture.resolution;frame=renderTexture.frame;renderer.renderTexture.bind(renderTexture)}else{resolution=renderer.resolution;frame=TEMP_RECT;frame.width=renderer.width;frame.height=renderer.height;renderer.renderTexture.bind(null)}var width=frame.width*resolution;var height=frame.height*resolution;var webglPixels=new Uint8Array(BYTES_PER_PIXEL*width*height);var gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels);if(generated){renderTexture.destroy(true)}return webglPixels};Extract.prototype.destroy=function destroy(){this.renderer.extract=null;this.renderer=null};exports.Extract=Extract},{"@pixi/core":16,"@pixi/math":28,"@pixi/utils":46}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var fragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n";var AlphaFilter=function(Filter){function AlphaFilter(alpha){if(alpha===void 0)alpha=1;Filter.call(this,core.defaultVertex,fragment,{uAlpha:1});this.alpha=alpha}if(Filter)AlphaFilter.__proto__=Filter;AlphaFilter.prototype=Object.create(Filter&&Filter.prototype);AlphaFilter.prototype.constructor=AlphaFilter;var prototypeAccessors={alpha:{configurable:true}};prototypeAccessors.alpha.get=function(){return this.uniforms.uAlpha};prototypeAccessors.alpha.set=function(value){this.uniforms.uAlpha=value};Object.defineProperties(AlphaFilter.prototype,prototypeAccessors);return AlphaFilter}(core.Filter);exports.AlphaFilter=AlphaFilter},{"@pixi/core":16}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var settings=require("@pixi/settings");var vertTemplate="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n    \n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n    \n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n    \n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function generateBlurVertSource(kernelSize,x){var halfLength=Math.ceil(kernelSize/2);var vertSource=vertTemplate;var blurLoop="";var template;if(x){template="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);"}else{template="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);"}for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);blur=blur.replace("%sampleIndex%",i-(halfLength-1)+".0");blurLoop+=blur;blurLoop+="\n"}vertSource=vertSource.replace("%blur%",blurLoop);vertSource=vertSource.replace("%size%",kernelSize);return vertSource}var GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]};var fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function generateBlurFragSource(kernelSize){var kernel=GAUSSIAN_VALUES[kernelSize];var halfLength=kernel.length;var fragSource=fragTemplate;var blurLoop="";var template="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";var value;for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);value=i;if(i>=halfLength){value=kernelSize-i-1}blur=blur.replace("%value%",kernel[value]);blurLoop+=blur;blurLoop+="\n"}fragSource=fragSource.replace("%blur%",blurLoop);fragSource=fragSource.replace("%size%",kernelSize);return fragSource}var BlurFilterPass=function(Filter){function BlurFilterPass(horizontal,strength,quality,resolution,kernelSize){kernelSize=kernelSize||5;var vertSrc=generateBlurVertSource(kernelSize,horizontal);var fragSrc=generateBlurFragSource(kernelSize);Filter.call(this,vertSrc,fragSrc);this.horizontal=horizontal;this.resolution=resolution||settings.settings.RESOLUTION;this._quality=0;this.quality=quality||4;this.blur=strength||8}if(Filter)BlurFilterPass.__proto__=Filter;BlurFilterPass.prototype=Object.create(Filter&&Filter.prototype);BlurFilterPass.prototype.constructor=BlurFilterPass;var prototypeAccessors={blur:{configurable:true},quality:{configurable:true}};BlurFilterPass.prototype.apply=function apply(filterManager,input,output,clear){if(output){if(this.horizontal){this.uniforms.strength=1/output.width*(output.width/input.width)}else{this.uniforms.strength=1/output.height*(output.height/input.height)}}else{if(this.horizontal){this.uniforms.strength=1/filterManager.renderer.width*(filterManager.renderer.width/input.width)}else{this.uniforms.strength=1/filterManager.renderer.height*(filterManager.renderer.height/input.height)}}this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(this.passes===1){filterManager.applyFilter(this,input,output,clear)}else{var renderTarget=filterManager.getFilterTexture();var renderer=filterManager.renderer;var flip=input;var flop=renderTarget;this.state.blend=false;filterManager.applyFilter(this,flip,flop,false);for(var i=1;i<this.passes-1;i++){renderer.renderTexture.bind(flip,flip.filterFrame);this.uniforms.uSampler=flop;var temp=flop;flop=flip;flip=temp;renderer.shader.bind(this);renderer.geometry.draw(5)}this.state.blend=true;filterManager.applyFilter(this,flop,output,clear);filterManager.returnFilterTexture(renderTarget)}};prototypeAccessors.blur.get=function(){return this.strength};prototypeAccessors.blur.set=function(value){this.padding=1+Math.abs(value)*2;this.strength=value};prototypeAccessors.quality.get=function(){return this._quality};prototypeAccessors.quality.set=function(value){this._quality=value;this.passes=value};Object.defineProperties(BlurFilterPass.prototype,prototypeAccessors);return BlurFilterPass}(core.Filter);var BlurFilter=function(Filter){function BlurFilter(strength,quality,resolution,kernelSize){Filter.call(this);this.blurXFilter=new BlurFilterPass(true,strength,quality,resolution,kernelSize);this.blurYFilter=new BlurFilterPass(false,strength,quality,resolution,kernelSize);this.resolution=resolution||settings.settings.RESOLUTION;this.quality=quality||4;this.blur=strength||8;this.repeatEdgePixels=false}if(Filter)BlurFilter.__proto__=Filter;BlurFilter.prototype=Object.create(Filter&&Filter.prototype);BlurFilter.prototype.constructor=BlurFilter;var prototypeAccessors={blur:{configurable:true},quality:{configurable:true},blurX:{configurable:true},blurY:{configurable:true},blendMode:{configurable:true},repeatEdgePixels:{configurable:true}};BlurFilter.prototype.apply=function apply(filterManager,input,output,clear){var xStrength=Math.abs(this.blurXFilter.strength);var yStrength=Math.abs(this.blurYFilter.strength);if(xStrength&&yStrength){var renderTarget=filterManager.getFilterTexture();this.blurXFilter.apply(filterManager,input,renderTarget,true);this.blurYFilter.apply(filterManager,renderTarget,output,clear);filterManager.returnFilterTexture(renderTarget)}else if(yStrength){this.blurYFilter.apply(filterManager,input,output,clear)}else{this.blurXFilter.apply(filterManager,input,output,clear)}};BlurFilter.prototype.updatePadding=function updatePadding(){if(this._repeatEdgePixels){this.padding=0}else{this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}};prototypeAccessors.blur.get=function(){return this.blurXFilter.blur};prototypeAccessors.blur.set=function(value){this.blurXFilter.blur=this.blurYFilter.blur=value;this.updatePadding()};prototypeAccessors.quality.get=function(){return this.blurXFilter.quality};prototypeAccessors.quality.set=function(value){this.blurXFilter.quality=this.blurYFilter.quality=value};prototypeAccessors.blurX.get=function(){return this.blurXFilter.blur};prototypeAccessors.blurX.set=function(value){this.blurXFilter.blur=value;this.updatePadding()};prototypeAccessors.blurY.get=function(){return this.blurYFilter.blur};prototypeAccessors.blurY.set=function(value){this.blurYFilter.blur=value;this.updatePadding()};prototypeAccessors.blendMode.get=function(){return this.blurYFilter.blendMode};prototypeAccessors.blendMode.set=function(value){this.blurYFilter.blendMode=value};prototypeAccessors.repeatEdgePixels.get=function(){return this._repeatEdgePixels};prototypeAccessors.repeatEdgePixels.set=function(value){this._repeatEdgePixels=value;this.updatePadding()};Object.defineProperties(BlurFilter.prototype,prototypeAccessors);return BlurFilter}(core.Filter);exports.BlurFilter=BlurFilter;exports.BlurFilterPass=BlurFilterPass},{"@pixi/core":16,"@pixi/settings":38}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var fragment="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n";var ColorMatrixFilter=function(Filter){function ColorMatrixFilter(){var uniforms={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};Filter.call(this,core.defaultFilterVertex,fragment,uniforms);this.alpha=1}if(Filter)ColorMatrixFilter.__proto__=Filter;ColorMatrixFilter.prototype=Object.create(Filter&&Filter.prototype);ColorMatrixFilter.prototype.constructor=ColorMatrixFilter;var prototypeAccessors={matrix:{configurable:true},alpha:{configurable:true}};ColorMatrixFilter.prototype._loadMatrix=function _loadMatrix(matrix,multiply){if(multiply===void 0)multiply=false;var newMatrix=matrix;if(multiply){this._multiply(newMatrix,this.uniforms.m,matrix);newMatrix=this._colorMatrix(newMatrix)}this.uniforms.m=newMatrix};ColorMatrixFilter.prototype._multiply=function _multiply(out,a,b){out[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15];out[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16];out[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17];out[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18];out[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19]+a[4];out[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15];out[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16];out[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17];out[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18];out[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19]+a[9];out[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15];out[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16];out[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17];out[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18];out[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19]+a[14];out[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15];out[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16];out[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17];out[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18];out[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19]+a[19];return out};ColorMatrixFilter.prototype._colorMatrix=function _colorMatrix(matrix){var m=new Float32Array(matrix);m[4]/=255;m[9]/=255;m[14]/=255;m[19]/=255;return m};ColorMatrixFilter.prototype.brightness=function brightness(b,multiply){var matrix=[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.greyscale=function greyscale(scale,multiply){var matrix=[scale,scale,scale,0,0,scale,scale,scale,0,0,scale,scale,scale,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.blackAndWhite=function blackAndWhite(multiply){var matrix=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.hue=function hue(rotation,multiply){rotation=(rotation||0)/180*Math.PI;var cosR=Math.cos(rotation);var sinR=Math.sin(rotation);var sqrt=Math.sqrt;var w=1/3;var sqrW=sqrt(w);var a00=cosR+(1-cosR)*w;var a01=w*(1-cosR)-sqrW*sinR;var a02=w*(1-cosR)+sqrW*sinR;var a10=w*(1-cosR)+sqrW*sinR;var a11=cosR+w*(1-cosR);var a12=w*(1-cosR)-sqrW*sinR;var a20=w*(1-cosR)-sqrW*sinR;var a21=w*(1-cosR)+sqrW*sinR;var a22=cosR+w*(1-cosR);var matrix=[a00,a01,a02,0,0,a10,a11,a12,0,0,a20,a21,a22,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.contrast=function contrast(amount,multiply){var v=(amount||0)+1;var o=-.5*(v-1);var matrix=[v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.saturate=function saturate(amount,multiply){if(amount===void 0)amount=0;var x=amount*2/3+1;var y=(x-1)*-.5;var matrix=[x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.desaturate=function desaturate(){this.saturate(-1)};ColorMatrixFilter.prototype.negative=function negative(multiply){var matrix=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.sepia=function sepia(multiply){var matrix=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.technicolor=function technicolor(multiply){var matrix=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.polaroid=function polaroid(multiply){var matrix=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.toBGR=function toBGR(multiply){var matrix=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.kodachrome=function kodachrome(multiply){var matrix=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.browni=function browni(multiply){var matrix=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.vintage=function vintage(multiply){var matrix=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.colorTone=function colorTone(desaturation,toned,lightColor,darkColor,multiply){desaturation=desaturation||.2;toned=toned||.15;lightColor=lightColor||16770432;darkColor=darkColor||3375104;var lR=(lightColor>>16&255)/255;var lG=(lightColor>>8&255)/255;var lB=(lightColor&255)/255;var dR=(darkColor>>16&255)/255;var dG=(darkColor>>8&255)/255;var dB=(darkColor&255)/255;var matrix=[.3,.59,.11,0,0,lR,lG,lB,desaturation,0,dR,dG,dB,toned,0,lR-dR,lG-dG,lB-dB,0,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.night=function night(intensity,multiply){intensity=intensity||.1;var matrix=[intensity*-2,-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,intensity*2,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.predator=function predator(amount,multiply){var matrix=[11.224130630493164*amount,-4.794486999511719*amount,-2.8746118545532227*amount,0*amount,.40342438220977783*amount,-3.6330697536468506*amount,9.193157196044922*amount,-2.951810836791992*amount,0*amount,-1.316135048866272*amount,-3.2184197902679443*amount,-4.2375030517578125*amount,7.476448059082031*amount,0*amount,.8044459223747253*amount,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.lsd=function lsd(multiply){var matrix=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.reset=function reset(){var matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(matrix,false)};prototypeAccessors.matrix.get=function(){return this.uniforms.m};prototypeAccessors.matrix.set=function(value){this.uniforms.m=value};prototypeAccessors.alpha.get=function(){return this.uniforms.uAlpha};prototypeAccessors.alpha.set=function(value){this.uniforms.uAlpha=value};Object.defineProperties(ColorMatrixFilter.prototype,prototypeAccessors);return ColorMatrixFilter}(core.Filter);ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;exports.ColorMatrixFilter=ColorMatrixFilter},{"@pixi/core":16}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var math=require("@pixi/math");var vertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n";var fragment="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n";var DisplacementFilter=function(Filter){function DisplacementFilter(sprite,scale){var maskMatrix=new math.Matrix;sprite.renderable=false;Filter.call(this,vertex,fragment,{mapSampler:sprite._texture,filterMatrix:maskMatrix,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])});this.maskSprite=sprite;this.maskMatrix=maskMatrix;if(scale===null||scale===undefined){scale=20}this.scale=new math.Point(scale,scale)}if(Filter)DisplacementFilter.__proto__=Filter;DisplacementFilter.prototype=Object.create(Filter&&Filter.prototype);DisplacementFilter.prototype.constructor=DisplacementFilter;var prototypeAccessors={map:{configurable:true}};DisplacementFilter.prototype.apply=function apply(filterManager,input,output,clear){this.uniforms.filterMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,this.maskSprite);this.uniforms.scale.x=this.scale.x;this.uniforms.scale.y=this.scale.y;var wt=this.maskSprite.transform.worldTransform;var lenX=Math.sqrt(wt.a*wt.a+wt.b*wt.b);var lenY=Math.sqrt(wt.c*wt.c+wt.d*wt.d);if(lenX!==0&&lenY!==0){this.uniforms.rotation[0]=wt.a/lenX;this.uniforms.rotation[1]=wt.b/lenX;this.uniforms.rotation[2]=wt.c/lenY;this.uniforms.rotation[3]=wt.d/lenY}filterManager.applyFilter(this,input,output,clear)};prototypeAccessors.map.get=function(){return this.uniforms.mapSampler};prototypeAccessors.map.set=function(value){this.uniforms.mapSampler=value};Object.defineProperties(DisplacementFilter.prototype,prototypeAccessors);return DisplacementFilter}(core.Filter);exports.DisplacementFilter=DisplacementFilter},{"@pixi/core":16,"@pixi/math":28}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var vertex="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n";var fragment='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n';var FXAAFilter=function(Filter){function FXAAFilter(){Filter.call(this,vertex,fragment)}if(Filter)FXAAFilter.__proto__=Filter;FXAAFilter.prototype=Object.create(Filter&&Filter.prototype);FXAAFilter.prototype.constructor=FXAAFilter;return FXAAFilter}(core.Filter);exports.FXAAFilter=FXAAFilter},{"@pixi/core":16}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var fragment="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n";var NoiseFilter=function(Filter){function NoiseFilter(noise,seed){if(noise===void 0)noise=.5;if(seed===void 0)seed=Math.random();Filter.call(this,core.defaultFilterVertex,fragment,{uNoise:0,uSeed:0});this.noise=noise;this.seed=seed}if(Filter)NoiseFilter.__proto__=Filter;NoiseFilter.prototype=Object.create(Filter&&Filter.prototype);NoiseFilter.prototype.constructor=NoiseFilter;var prototypeAccessors={noise:{configurable:true},seed:{configurable:true}};prototypeAccessors.noise.get=function(){return this.uniforms.uNoise};prototypeAccessors.noise.set=function(value){this.uniforms.uNoise=value};prototypeAccessors.seed.get=function(){return this.uniforms.uSeed};prototypeAccessors.seed.set=function(value){this.uniforms.uSeed=value};Object.defineProperties(NoiseFilter.prototype,prototypeAccessors);return NoiseFilter}(core.Filter);exports.NoiseFilter=NoiseFilter},{"@pixi/core":16}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var math=require("@pixi/math");var utils=require("@pixi/utils");var display=require("@pixi/display");var constants=require("@pixi/constants");var GRAPHICS_CURVES={adaptive:true,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function _segmentsCount(length,defaultSegments){if(defaultSegments===void 0)defaultSegments=20;if(!this.adaptive){return defaultSegments}var result=Math.ceil(length/this.maxLength);if(result<this.minSegments){result=this.minSegments}else if(result>this.maxSegments){result=this.maxSegments}return result}};var FillStyle=function FillStyle(){this.reset()};FillStyle.prototype.clone=function clone(){var obj=new FillStyle;obj.color=this.color;obj.alpha=this.alpha;obj.texture=this.texture;obj.matrix=this.matrix;obj.visible=this.visible;return obj};FillStyle.prototype.reset=function reset(){this.color=16777215;this.alpha=1;this.texture=core.Texture.WHITE;this.matrix=null;this.visible=false};FillStyle.prototype.destroy=function destroy(){this.texture=null;this.matrix=null};var GraphicsData=function GraphicsData(shape,fillStyle,lineStyle,matrix){if(fillStyle===void 0)fillStyle=null;if(lineStyle===void 0)lineStyle=null;if(matrix===void 0)matrix=null;this.shape=shape;this.lineStyle=lineStyle;this.fillStyle=fillStyle;this.matrix=matrix;this.type=shape.type;this.points=[];this.holes=[]};GraphicsData.prototype.clone=function clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)};GraphicsData.prototype.destroy=function destroy(){this.shape=null;this.holes.length=0;this.holes=null;this.points.length=0;this.points=null;this.lineStyle=null;this.fillStyle=null};var buildCircle={build:function build(graphicsData){var circleData=graphicsData.shape;var points=graphicsData.points;var x=circleData.x;var y=circleData.y;var width;var height;points.length=0;if(graphicsData.type===math.SHAPES.CIRC){width=circleData.radius;height=circleData.radius}else{width=circleData.width;height=circleData.height}if(width===0||height===0){return}var totalSegs=Math.floor(30*Math.sqrt(circleData.radius))||Math.floor(15*Math.sqrt(circleData.width+circleData.height));totalSegs/=2.3;var seg=Math.PI*2/totalSegs;for(var i=0;i<totalSegs;i++){points.push(x+Math.sin(-seg*i)*width,y+Math.cos(-seg*i)*height)}points.push(points[0],points[1])},triangulate:function triangulate(graphicsData,graphicsGeometry){var points=graphicsData.points;var verts=graphicsGeometry.points;var indices=graphicsGeometry.indices;var vertPos=verts.length/2;var center=vertPos;verts.push(graphicsData.shape.x,graphicsData.shape.y);for(var i=0;i<points.length;i+=2){verts.push(points[i],points[i+1]);indices.push(vertPos++,center,vertPos)}}};function buildLine(graphicsData,graphicsGeometry){if(graphicsData.lineStyle.native){buildNativeLine(graphicsData,graphicsGeometry)}else{buildLine$1(graphicsData,graphicsGeometry)}}function buildLine$1(graphicsData,graphicsGeometry){var shape=graphicsData.shape;var points=graphicsData.points||shape.points.slice();if(points.length===0){return}var style=graphicsData.lineStyle;var firstPoint=new math.Point(points[0],points[1]);var lastPoint=new math.Point(points[points.length-2],points[points.length-1]);var closedShape=shape.type!==math.SHAPES.POLY||shape.closeStroke;var closedPath=firstPoint.x===lastPoint.x&&firstPoint.y===lastPoint.y;if(closedShape){points=points.slice();if(closedPath){points.pop();points.pop();lastPoint.set(points[points.length-2],points[points.length-1])}var midPointX=lastPoint.x+(firstPoint.x-lastPoint.x)*.5;var midPointY=lastPoint.y+(firstPoint.y-lastPoint.y)*.5;points.unshift(midPointX,midPointY);points.push(midPointX,midPointY)}var verts=graphicsGeometry.points;var length=points.length/2;var indexCount=points.length;var indexStart=verts.length/2;var width=style.width/2;var p1x=points[0];var p1y=points[1];var p2x=points[2];var p2y=points[3];var p3x=0;var p3y=0;var perpx=-(p1y-p2y);var perpy=p1x-p2x;var perp2x=0;var perp2y=0;var perp3x=0;var perp3y=0;var dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;var ratio=style.alignment;var r1=(1-ratio)*2;var r2=ratio*2;verts.push(p1x-perpx*r1,p1y-perpy*r1);verts.push(p1x+perpx*r2,p1y+perpy*r2);for(var i=1;i<length-1;++i){p1x=points[(i-1)*2];p1y=points[(i-1)*2+1];p2x=points[i*2];p2y=points[i*2+1];p3x=points[(i+1)*2];p3y=points[(i+1)*2+1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;perp2x=-(p2y-p3y);perp2y=p2x-p3x;dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y);perp2x/=dist;perp2y/=dist;perp2x*=width;perp2y*=width;var a1=-perpy+p1y-(-perpy+p2y);var b1=-perpx+p2x-(-perpx+p1x);var c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);var a2=-perp2y+p3y-(-perp2y+p2y);var b2=-perp2x+p2x-(-perp2x+p3x);var c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);var denom=a1*b2-a2*b1;if(Math.abs(denom)<.1){denom+=10.1;verts.push(p2x-perpx*r1,p2y-perpy*r1);verts.push(p2x+perpx*r2,p2y+perpy*r2);continue}var px=(b1*c2-b2*c1)/denom;var py=(a2*c1-a1*c2)/denom;var pdist=(px-p2x)*(px-p2x)+(py-p2y)*(py-p2y);if(pdist>196*width*width){perp3x=perpx-perp2x;perp3y=perpy-perp2y;dist=Math.sqrt(perp3x*perp3x+perp3y*perp3y);perp3x/=dist;perp3y/=dist;perp3x*=width;perp3y*=width;verts.push(p2x-perp3x*r1,p2y-perp3y*r1);verts.push(p2x+perp3x*r2,p2y+perp3y*r2);verts.push(p2x-perp3x*r2*r1,p2y-perp3y*r1);indexCount++}else{verts.push(p2x+(px-p2x)*r1,p2y+(py-p2y)*r1);verts.push(p2x-(px-p2x)*r2,p2y-(py-p2y)*r2)}}p1x=points[(length-2)*2];p1y=points[(length-2)*2+1];p2x=points[(length-1)*2];p2y=points[(length-1)*2+1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;verts.push(p2x-perpx*r1,p2y-perpy*r1);verts.push(p2x+perpx*r2,p2y+perpy*r2);var indices=graphicsGeometry.indices;for(var i$1=0;i$1<indexCount-2;++i$1){indices.push(indexStart,indexStart+1,indexStart+2);indexStart++}}function buildNativeLine(graphicsData,graphicsGeometry){var i=0;var points=graphicsData.points||graphicsData.shape.points;if(points.length===0){return}var verts=graphicsGeometry.points;var indices=graphicsGeometry.indices;var length=points.length/2;var indexStart=verts.length/2;for(i=1;i<length;i++){var p1x=points[(i-1)*2];var p1y=points[(i-1)*2+1];var p2x=points[i*2];var p2y=points[i*2+1];verts.push(p1x,p1y);verts.push(p2x,p2y);indices.push(indexStart++,indexStart++)}}var buildPoly={build:function build(graphicsData){graphicsData.points=graphicsData.shape.points.slice()},triangulate:function triangulate(graphicsData,graphicsGeometry){var points=graphicsData.points;var holes=graphicsData.holes;var verts=graphicsGeometry.points;var indices=graphicsGeometry.indices;if(points.length>=6){var holeArray=[];for(var i=0;i<holes.length;i++){var hole=holes[i];holeArray.push(points.length/2);points=points.concat(hole.points)}var triangles=utils.earcut(points,holeArray,2);if(!triangles){return}var vertPos=verts.length/2;for(var i$1=0;i$1<triangles.length;i$1+=3){indices.push(triangles[i$1]+vertPos);indices.push(triangles[i$1+1]+vertPos);indices.push(triangles[i$1+2]+vertPos)}for(var i$2=0;i$2<points.length;i$2++){verts.push(points[i$2])}}}};var buildRectangle={build:function build(graphicsData){var rectData=graphicsData.shape;var x=rectData.x;var y=rectData.y;var width=rectData.width;var height=rectData.height;var points=graphicsData.points;points.length=0;points.push(x,y,x+width,y,x+width,y+height,x,y+height)},triangulate:function triangulate(graphicsData,graphicsGeometry){var points=graphicsData.points;var verts=graphicsGeometry.points;var vertPos=verts.length/2;verts.push(points[0],points[1],points[2],points[3],points[6],points[7],points[4],points[5]);graphicsGeometry.indices.push(vertPos,vertPos+1,vertPos+2,vertPos+1,vertPos+2,vertPos+3)}};var buildRoundedRectangle={build:function build(graphicsData){var rrectData=graphicsData.shape;var points=graphicsData.points;var x=rrectData.x;var y=rrectData.y;var width=rrectData.width;var height=rrectData.height;var radius=rrectData.radius;points.length=0;quadraticBezierCurve(x,y+radius,x,y,x+radius,y,points);quadraticBezierCurve(x+width-radius,y,x+width,y,x+width,y+radius,points);quadraticBezierCurve(x+width,y+height-radius,x+width,y+height,x+width-radius,y+height,points);quadraticBezierCurve(x+radius,y+height,x,y+height,x,y+height-radius,points)},triangulate:function triangulate(graphicsData,graphicsGeometry){var points=graphicsData.points;var verts=graphicsGeometry.points;var indices=graphicsGeometry.indices;var vecPos=verts.length/2;var triangles=utils.earcut(points,null,2);for(var i=0,j=triangles.length;i<j;i+=3){indices.push(triangles[i]+vecPos);indices.push(triangles[i+1]+vecPos);indices.push(triangles[i+2]+vecPos)}for(var i$1=0,j$1=points.length;i$1<j$1;i$1++){verts.push(points[i$1],points[++i$1])}}};function getPt(n1,n2,perc){var diff=n2-n1;return n1+diff*perc}function quadraticBezierCurve(fromX,fromY,cpX,cpY,toX,toY,out){if(out===void 0)out=[];var n=20;var points=out;var xa=0;var ya=0;var xb=0;var yb=0;var x=0;var y=0;for(var i=0,j=0;i<=n;++i){j=i/n;xa=getPt(fromX,cpX,j);ya=getPt(fromY,cpY,j);xb=getPt(cpX,toX,j);yb=getPt(cpY,toY,j);x=getPt(xa,xb,j);y=getPt(ya,yb,j);points.push(x,y)}return points}var BATCH_POOL=[];var DRAW_CALL_POOL=[];var fillCommands={};fillCommands[math.SHAPES.POLY]=buildPoly;fillCommands[math.SHAPES.CIRC]=buildCircle;fillCommands[math.SHAPES.ELIP]=buildCircle;fillCommands[math.SHAPES.RECT]=buildRectangle;fillCommands[math.SHAPES.RREC]=buildRoundedRectangle;var BatchPart=function BatchPart(){this.style=null;this.size=0;this.start=0;this.attribStart=0;this.attribSize=0};var GraphicsGeometry=function(BatchGeometry){function GraphicsGeometry(){BatchGeometry.call(this);this.points=[];this.colors=[];this.uvs=[];this.indices=[];this.textureIds=[];this.graphicsData=[];this.dirty=0;this.batchDirty=-1;this.cacheDirty=-1;this.clearDirty=0;this.drawCalls=[];this.batches=[];this.shapeIndex=0;this._bounds=new display.Bounds;this.boundsDirty=-1;this.boundsPadding=0;this.batchable=false;this.indicesUint16=null;this.uvsFloat32=null}if(BatchGeometry)GraphicsGeometry.__proto__=BatchGeometry;GraphicsGeometry.prototype=Object.create(BatchGeometry&&BatchGeometry.prototype);GraphicsGeometry.prototype.constructor=GraphicsGeometry;var prototypeAccessors={bounds:{configurable:true}};prototypeAccessors.bounds.get=function(){if(this.boundsDirty!==this.dirty){this.boundsDirty=this.dirty;this.calculateBounds()}return this._bounds};GraphicsGeometry.prototype.clear=function clear(){if(this.graphicsData.length>0){this.boundsDirty=-1;this.dirty++;this.clearDirty++;this.batchDirty++;this.graphicsData.length=0;this.shapeIndex=0;this.points.length=0;this.colors.length=0;this.uvs.length=0;this.indices.length=0;this.textureIds.length=0;for(var i=0;i<this.drawCalls.length;i++){this.drawCalls[i].textures.length=0;DRAW_CALL_POOL.push(this.drawCalls[i])}this.drawCalls.length=0;for(var i$1=0;i$1<this.batches.length;i$1++){var batch=this.batches[i$1];batch.start=0;batch.attribStart=0;batch.style=null;BATCH_POOL.push(batch)}this.batches.length=0}return this};GraphicsGeometry.prototype.drawShape=function drawShape(shape,fillStyle,lineStyle,matrix){var data=new GraphicsData(shape,fillStyle,lineStyle,matrix);this.graphicsData.push(data);this.dirty++;return this};GraphicsGeometry.prototype.drawHole=function drawHole(shape,matrix){if(!this.graphicsData.length){return null}var data=new GraphicsData(shape,null,null,matrix);var lastShape=this.graphicsData[this.graphicsData.length-1];data.lineStyle=lastShape.lineStyle;lastShape.holes.push(data);this.dirty++;return data};GraphicsGeometry.prototype.destroy=function destroy(options){BatchGeometry.prototype.destroy.call(this,options);for(var i=0;i<this.graphicsData.length;++i){this.graphicsData[i].destroy()}this.points.length=0;this.points=null;this.colors.length=0;this.colors=null;this.uvs.length=0;this.uvs=null;this.indices.length=0;this.indices=null;this.indexBuffer.destroy();this.indexBuffer=null;this.graphicsData.length=0;this.graphicsData=null;this.drawCalls.length=0;this.drawCalls=null;this.batches.length=0;this.batches=null;this._bounds=null};GraphicsGeometry.prototype.containsPoint=function containsPoint(point){var graphicsData=this.graphicsData;for(var i=0;i<graphicsData.length;++i){var data=graphicsData[i];if(!data.fillStyle.visible){continue}if(data.shape){if(data.shape.contains(point.x,point.y)){if(data.holes){for(var i$1=0;i$1<data.holes.length;i$1++){var hole=data.holes[i$1];if(hole.shape.contains(point.x,point.y)){return false}}}return true}}}return false};GraphicsGeometry.prototype.updateBatches=function updateBatches(){if(this.dirty===this.cacheDirty){return}if(this.graphicsData.length===0){return}if(this.dirty!==this.cacheDirty){for(var i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i];if(data.fillStyle&&!data.fillStyle.texture.baseTexture.valid){return}if(data.lineStyle&&!data.lineStyle.texture.baseTexture.valid){return}}}this.cacheDirty=this.dirty;var uvs=this.uvs;var batchPart=this.batches.pop()||BATCH_POOL.pop()||new BatchPart;batchPart.style=batchPart.style||this.graphicsData[0].fillStyle||this.graphicsData[0].lineStyle;var currentTexture=batchPart.style.texture.baseTexture;var currentColor=batchPart.style.color+batchPart.style.alpha;this.batches.push(batchPart);for(var i$1=this.shapeIndex;i$1<this.graphicsData.length;i$1++){this.shapeIndex++;var data$1=this.graphicsData[i$1];var command=fillCommands[data$1.type];var fillStyle=data$1.fillStyle;var lineStyle=data$1.lineStyle;command.build(data$1);if(data$1.matrix){this.transformPoints(data$1.points,data$1.matrix)}for(var j=0;j<2;j++){var style=j===0?fillStyle:lineStyle;if(!style.visible){continue}var nextTexture=style.texture.baseTexture;if(currentTexture!==nextTexture||style.color+style.alpha!==currentColor){nextTexture.wrapMode=10497;currentTexture=nextTexture;currentColor=style.color+style.alpha;var index$1=this.indices.length;var attribIndex=this.points.length/2;batchPart.size=index$1-batchPart.start;batchPart.attribSize=attribIndex-batchPart.attribStart;if(batchPart.size>0){batchPart=BATCH_POOL.pop()||new BatchPart;this.batches.push(batchPart)}batchPart.style=style;batchPart.start=index$1;batchPart.attribStart=attribIndex}var start=this.points.length/2;if(j===0){if(data$1.holes.length){this.processHoles(data$1.holes);buildPoly.triangulate(data$1,this)}else{command.triangulate(data$1,this)}}else{buildLine(data$1,this);for(var i$2=0;i$2<data$1.holes.length;i$2++){buildLine(data$1.holes[i$2],this)}}var size=this.points.length/2-start;this.addUvs(this.points,uvs,style.texture,start,size,style.matrix)}}var index=this.indices.length;var attrib=this.points.length/2;batchPart.size=index-batchPart.start;batchPart.attribSize=attrib-batchPart.attribStart;this.indicesUint16=new Uint16Array(this.indices);this.batchable=this.isBatchable();if(this.batchable){this.batchDirty++;this.uvsFloat32=new Float32Array(this.uvs);for(var i$3=0;i$3<this.batches.length;i$3++){var batch=this.batches[i$3];for(var j$1=0;j$1<batch.size;j$1++){var index$2=batch.start+j$1;this.indicesUint16[index$2]=this.indicesUint16[index$2]-batch.attribStart}}}else{this.buildDrawCalls()}};GraphicsGeometry.prototype.isBatchable=function isBatchable(){var batches=this.batches;for(var i=0;i<batches.length;i++){if(batches[i].style.native){return false}}return this.points.length<GraphicsGeometry.BATCHABLE_SIZE*2};GraphicsGeometry.prototype.buildDrawCalls=function buildDrawCalls(){var TICK=++core.BaseTexture._globalBatch;for(var i=0;i<this.drawCalls.length;i++){this.drawCalls[i].textures.length=0;DRAW_CALL_POOL.push(this.drawCalls[i])}this.drawCalls.length=0;var uvs=this.uvs;var colors=this.colors;var textureIds=this.textureIds;var currentGroup=DRAW_CALL_POOL.pop()||new core.BatchDrawCall;currentGroup.textureCount=0;currentGroup.start=0;currentGroup.size=0;currentGroup.type=constants.DRAW_MODES.TRIANGLES;var textureCount=0;var currentTexture=null;var textureId=0;var native=false;var drawMode=constants.DRAW_MODES.TRIANGLES;var index=0;this.drawCalls.push(currentGroup);for(var i$1=0;i$1<this.batches.length;i$1++){var data=this.batches[i$1];var MAX_TEXTURES=8;var style=data.style;var nextTexture=style.texture.baseTexture;if(native!==style.native){native=style.native;drawMode=native?constants.DRAW_MODES.LINES:constants.DRAW_MODES.TRIANGLES;currentTexture=null;textureCount=MAX_TEXTURES;TICK++}if(currentTexture!==nextTexture){currentTexture=nextTexture;if(nextTexture._batchEnabled!==TICK){if(textureCount===MAX_TEXTURES){TICK++;textureCount=0;if(currentGroup.size>0){currentGroup=DRAW_CALL_POOL.pop()||new core.BatchDrawCall;this.drawCalls.push(currentGroup)}currentGroup.start=index;currentGroup.size=0;currentGroup.textureCount=0;currentGroup.type=drawMode}nextTexture.touched=1;nextTexture._batchEnabled=TICK;nextTexture._id=textureCount;nextTexture.wrapMode=10497;currentGroup.textures[currentGroup.textureCount++]=nextTexture;textureCount++}}currentGroup.size+=data.size;index+=data.size;textureId=nextTexture._id;this.addColors(colors,style.color,style.alpha,data.attribSize);this.addTextureIds(textureIds,textureId,data.attribSize)}core.BaseTexture._globalBatch=TICK;var verts=this.points;var glPoints=new ArrayBuffer(verts.length*3*4);var f32=new Float32Array(glPoints);var u32=new Uint32Array(glPoints);var p=0;for(var i$2=0;i$2<verts.length/2;i$2++){f32[p++]=verts[i$2*2];f32[p++]=verts[i$2*2+1];f32[p++]=uvs[i$2*2];f32[p++]=uvs[i$2*2+1];u32[p++]=colors[i$2];f32[p++]=textureIds[i$2]}this._buffer.update(glPoints);this._indexBuffer.update(this.indicesUint16)};GraphicsGeometry.prototype.processHoles=function processHoles(holes){for(var i=0;i<holes.length;i++){var hole=holes[i];var command=fillCommands[hole.type];command.build(hole);if(hole.matrix){this.transformPoints(hole.points,hole.matrix)}}};GraphicsGeometry.prototype.calculateBounds=function calculateBounds(){var minX=Infinity;var maxX=-Infinity;var minY=Infinity;var maxY=-Infinity;if(this.graphicsData.length){var shape=null;var x=0;var y=0;var w=0;var h=0;for(var i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i];var type=data.type;var lineWidth=data.lineStyle?data.lineStyle.width:0;shape=data.shape;if(type===math.SHAPES.RECT||type===math.SHAPES.RREC){x=shape.x-lineWidth/2;y=shape.y-lineWidth/2;w=shape.width+lineWidth;h=shape.height+lineWidth;minX=x<minX?x:minX;maxX=x+w>maxX?x+w:maxX;minY=y<minY?y:minY;maxY=y+h>maxY?y+h:maxY}else if(type===math.SHAPES.CIRC){x=shape.x;y=shape.y;w=shape.radius+lineWidth/2;h=shape.radius+lineWidth/2;minX=x-w<minX?x-w:minX;maxX=x+w>maxX?x+w:maxX;minY=y-h<minY?y-h:minY;maxY=y+h>maxY?y+h:maxY}else if(type===math.SHAPES.ELIP){x=shape.x;y=shape.y;w=shape.width+lineWidth/2;h=shape.height+lineWidth/2;minX=x-w<minX?x-w:minX;maxX=x+w>maxX?x+w:maxX;minY=y-h<minY?y-h:minY;maxY=y+h>maxY?y+h:maxY}else{var points=shape.points;var x2=0;var y2=0;var dx=0;var dy=0;var rw=0;var rh=0;var cx=0;var cy=0;for(var j=0;j+2<points.length;j+=2){x=points[j];y=points[j+1];x2=points[j+2];y2=points[j+3];dx=Math.abs(x2-x);dy=Math.abs(y2-y);h=lineWidth;w=Math.sqrt(dx*dx+dy*dy);if(w<1e-9){continue}rw=(h/w*dy+dx)/2;rh=(h/w*dx+dy)/2;cx=(x2+x)/2;cy=(y2+y)/2;minX=cx-rw<minX?cx-rw:minX;maxX=cx+rw>maxX?cx+rw:maxX;minY=cy-rh<minY?cy-rh:minY;maxY=cy+rh>maxY?cy+rh:maxY}}}}else{minX=0;maxX=0;minY=0;maxY=0}var padding=this.boundsPadding;this._bounds.minX=minX-padding;this._bounds.maxX=maxX+padding;this._bounds.minY=minY-padding;this._bounds.maxY=maxY+padding};GraphicsGeometry.prototype.transformPoints=function transformPoints(points,matrix){for(var i=0;i<points.length/2;i++){var x=points[i*2];var y=points[i*2+1];points[i*2]=matrix.a*x+matrix.c*y+matrix.tx;points[i*2+1]=matrix.b*x+matrix.d*y+matrix.ty}};GraphicsGeometry.prototype.addColors=function addColors(colors,color,alpha,size){var rgb=(color>>16)+(color&65280)+((color&255)<<16);var rgba=utils.premultiplyTint(rgb,alpha);while(size-- >0){colors.push(rgba)}};GraphicsGeometry.prototype.addTextureIds=function addTextureIds(textureIds,id,size){while(size-- >0){textureIds.push(id)}};GraphicsGeometry.prototype.addUvs=function addUvs(verts,uvs,texture,start,size,matrix){var index=0;var uvsStart=uvs.length;var frame=texture.frame;while(index<size){var x=verts[(start+index)*2];var y=verts[(start+index)*2+1];if(matrix){var nx=matrix.a*x+matrix.c*y+matrix.tx;y=matrix.b*x+matrix.d*y+matrix.ty;x=nx}index++;uvs.push(x/frame.width,y/frame.height)}var baseTexture=texture.baseTexture;if(frame.width<baseTexture.width||frame.height<baseTexture.height){this.adjustUvs(uvs,texture,uvsStart,size)}};GraphicsGeometry.prototype.adjustUvs=function adjustUvs(uvs,texture,start,size){var baseTexture=texture.baseTexture;var eps=1e-6;var finish=start+size*2;var frame=texture.frame;var scaleX=frame.width/baseTexture.width;var scaleY=frame.height/baseTexture.height;var offsetX=frame.x/frame.width;var offsetY=frame.y/frame.height;var minX=Math.floor(uvs[start]+eps);var minY=Math.floor(uvs[start+1]+eps);for(var i=start+2;i<finish;i+=2){minX=Math.min(minX,Math.floor(uvs[i]+eps));minY=Math.min(minY,Math.floor(uvs[i+1]+eps))}offsetX-=minX;offsetY-=minY;for(var i$1=start;i$1<finish;i$1+=2){uvs[i$1]=(uvs[i$1]+offsetX)*scaleX;uvs[i$1+1]=(uvs[i$1+1]+offsetY)*scaleY}};Object.defineProperties(GraphicsGeometry.prototype,prototypeAccessors);return GraphicsGeometry}(core.BatchGeometry);GraphicsGeometry.BATCHABLE_SIZE=100;var LineStyle=function(FillStyle){function LineStyle(){FillStyle.apply(this,arguments)}if(FillStyle)LineStyle.__proto__=FillStyle;LineStyle.prototype=Object.create(FillStyle&&FillStyle.prototype);LineStyle.prototype.constructor=LineStyle;LineStyle.prototype.clone=function clone(){var obj=new LineStyle;obj.color=this.color;obj.alpha=this.alpha;obj.texture=this.texture;obj.matrix=this.matrix;obj.visible=this.visible;obj.width=this.width;obj.alignment=this.alignment;obj.native=this.native;return obj};LineStyle.prototype.reset=function reset(){FillStyle.prototype.reset.call(this);this.color=0;this.width=0;this.alignment=.5;this.native=false};return LineStyle}(FillStyle);var BezierUtils=function BezierUtils(){};BezierUtils.curveLength=function curveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){var n=10;var result=0;var t=0;var t2=0;var t3=0;var nt=0;var nt2=0;var nt3=0;var x=0;var y=0;var dx=0;var dy=0;var prevX=fromX;var prevY=fromY;for(var i=1;i<=n;++i){t=i/n;t2=t*t;t3=t2*t;nt=1-t;nt2=nt*nt;nt3=nt2*nt;x=nt3*fromX+3*nt2*t*cpX+3*nt*t2*cpX2+t3*toX;y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY;dx=prevX-x;dy=prevY-y;prevX=x;prevY=y;result+=Math.sqrt(dx*dx+dy*dy)}return result};BezierUtils.curveTo=function curveTo(cpX,cpY,cpX2,cpY2,toX,toY,points){var fromX=points[points.length-2];var fromY=points[points.length-1];points.length-=2;var n=GRAPHICS_CURVES._segmentsCount(BezierUtils.curveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY));var dt=0;var dt2=0;var dt3=0;var t2=0;var t3=0;points.push(fromX,fromY);for(var i=1,j=0;i<=n;++i){j=i/n;dt=1-j;dt2=dt*dt;dt3=dt2*dt;t2=j*j;t3=t2*j;points.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY)}};var QuadraticUtils=function QuadraticUtils(){};QuadraticUtils.curveLength=function curveLength(fromX,fromY,cpX,cpY,toX,toY){var ax=fromX-2*cpX+toX;var ay=fromY-2*cpY+toY;var bx=2*cpX-2*fromX;var by=2*cpY-2*fromY;var a=4*(ax*ax+ay*ay);var b=4*(ax*bx+ay*by);var c=bx*bx+by*by;var s=2*Math.sqrt(a+b+c);var a2=Math.sqrt(a);var a32=2*a*a2;var c2=2*Math.sqrt(c);var ba=b/a2;return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log((2*a2+ba+s)/(ba+c2)))/(4*a32)};QuadraticUtils.curveTo=function curveTo(cpX,cpY,toX,toY,points){var fromX=points[points.length-2];var fromY=points[points.length-1];var n=GRAPHICS_CURVES._segmentsCount(QuadraticUtils.curveLength(fromX,fromY,cpX,cpY,toX,toY));var xa=0;var ya=0;for(var i=1;i<=n;++i){var j=i/n;xa=fromX+(cpX-fromX)*j;ya=fromY+(cpY-fromY)*j;points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j)}};var ArcUtils=function ArcUtils(){};ArcUtils.curveTo=function curveTo(x1,y1,x2,y2,radius,points){var fromX=points[points.length-2];var fromY=points[points.length-1];var a1=fromY-y1;var b1=fromX-x1;var a2=y2-y1;var b2=x2-x1;var mm=Math.abs(a1*b2-b1*a2);if(mm<1e-8||radius===0){if(points[points.length-2]!==x1||points[points.length-1]!==y1){points.push(x1,y1)}return null}var dd=a1*a1+b1*b1;var cc=a2*a2+b2*b2;var tt=a1*a2+b1*b2;var k1=radius*Math.sqrt(dd)/mm;var k2=radius*Math.sqrt(cc)/mm;var j1=k1*tt/dd;var j2=k2*tt/cc;var cx=k1*b2+k2*b1;var cy=k1*a2+k2*a1;var px=b1*(k2+j1);var py=a1*(k2+j1);var qx=b2*(k1+j2);var qy=a2*(k1+j2);var startAngle=Math.atan2(py-cy,px-cx);var endAngle=Math.atan2(qy-cy,qx-cx);return{cx:cx+x1,cy:cy+y1,radius:radius,startAngle:startAngle,endAngle:endAngle,anticlockwise:b1*a2>b2*a1}};ArcUtils.arc=function arc(startX,startY,cx,cy,radius,startAngle,endAngle,anticlockwise,points){var sweep=endAngle-startAngle;var n=GRAPHICS_CURVES._segmentsCount(Math.abs(sweep)*radius,Math.ceil(Math.abs(sweep)/math.PI_2)*40);var theta=sweep/(n*2);var theta2=theta*2;var cTheta=Math.cos(theta);var sTheta=Math.sin(theta);var segMinus=n-1;var remainder=segMinus%1/segMinus;for(var i=0;i<=segMinus;++i){var real=i+remainder*i;var angle=theta+startAngle+theta2*real;var c=Math.cos(angle);var s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}};var Star=function(Polygon){function Star(x,y,points,radius,innerRadius,rotation){innerRadius=innerRadius||radius/2;var startAngle=-1*Math.PI/2+rotation;var len=points*2;var delta=math.PI_2/len;var polygon=[];for(var i=0;i<len;i++){var r=i%2?innerRadius:radius;var angle=i*delta+startAngle;polygon.push(x+r*Math.cos(angle),y+r*Math.sin(angle))}Polygon.call(this,polygon)}if(Polygon)Star.__proto__=Polygon;Star.prototype=Object.create(Polygon&&Polygon.prototype);Star.prototype.constructor=Star;return Star}(math.Polygon);var temp=new Float32Array(3);var defaultShader=null;var Graphics=function(Container){function Graphics(geometry){if(geometry===void 0)geometry=null;Container.call(this);this.geometry=geometry||new GraphicsGeometry;this.geometry.refCount++;this.shader=null;this.state=core.State.for2d();this._fillStyle=new FillStyle;this._lineStyle=new LineStyle;this._matrix=null;this._holeMode=false;this.currentPath=null;this.batches=[];this.batchTint=-1;this.vertexData=null;this._transformID=-1;this.batchDirty=-1;this.tint=16777215;this.blendMode=constants.BLEND_MODES.NORMAL}if(Container)Graphics.__proto__=Container;Graphics.prototype=Object.create(Container&&Container.prototype);Graphics.prototype.constructor=Graphics;var prototypeAccessors={blendMode:{configurable:true},tint:{configurable:true},fill:{configurable:true},line:{configurable:true}};Graphics.prototype.clone=function clone(){this.finishPoly();return new Graphics(this.geometry)};prototypeAccessors.blendMode.set=function(value){this.state.blendMode=value};prototypeAccessors.blendMode.get=function(){return this.state.blendMode};prototypeAccessors.tint.get=function(){return this._tint};prototypeAccessors.tint.set=function(value){this._tint=value};prototypeAccessors.fill.get=function(){return this._fillStyle};prototypeAccessors.line.get=function(){return this._lineStyle};Graphics.prototype.lineStyle=function lineStyle(width,color,alpha,alignment,native){if(width===void 0)width=0;if(color===void 0)color=0;if(alpha===void 0)alpha=1;if(alignment===void 0)alignment=.5;if(native===void 0)native=false;this.lineTextureStyle(width,core.Texture.WHITE,color,alpha,null,alignment,native);return this};Graphics.prototype.lineTextureStyle=function lineTextureStyle(width,texture,color,alpha,matrix,alignment,native){if(width===void 0)width=0;if(texture===void 0)texture=core.Texture.WHITE;if(color===void 0)color=16777215;if(alpha===void 0)alpha=1;if(matrix===void 0)matrix=null;if(alignment===void 0)alignment=.5;if(native===void 0)native=false;if(this.currentPath){this.startPoly()}var visible=width>0&&alpha>0;if(!visible){this._lineStyle.reset()}else{if(matrix){matrix=matrix.clone();matrix.invert()}Object.assign(this._lineStyle,{color:color,width:width,alpha:alpha,matrix:matrix,texture:texture,alignment:alignment,native:native,visible:visible})}return this};Graphics.prototype.startPoly=function startPoly(){if(this.currentPath){var points=this.currentPath.points;var len=this.currentPath.points.length;if(len>2){this.drawShape(this.currentPath);this.currentPath=new math.Polygon;this.currentPath.closeStroke=false;this.currentPath.points.push(points[len-2],points[len-1])}}else{this.currentPath=new math.Polygon;this.currentPath.closeStroke=false}};Graphics.prototype.finishPoly=function finishPoly(){if(this.currentPath){if(this.currentPath.points.length>2){this.drawShape(this.currentPath);this.currentPath=null}else{this.currentPath.points.length=0}}};Graphics.prototype.moveTo=function moveTo(x,y){this.startPoly();this.currentPath.points[0]=x;this.currentPath.points[1]=y;return this};Graphics.prototype.lineTo=function lineTo(x,y){if(!this.currentPath){this.moveTo(0,0)}var points=this.currentPath.points;var fromX=points[points.length-2];var fromY=points[points.length-1];if(fromX!==x||fromY!==y){points.push(x,y)}return this};Graphics.prototype._initCurve=function _initCurve(x,y){if(x===void 0)x=0;if(y===void 0)y=0;if(this.currentPath){if(this.currentPath.points.length===0){this.currentPath.points=[x,y]}}else{this.moveTo(x,y)}};Graphics.prototype.quadraticCurveTo=function quadraticCurveTo(cpX,cpY,toX,toY){this._initCurve();var points=this.currentPath.points;if(points.length===0){this.moveTo(0,0)}QuadraticUtils.curveTo(cpX,cpY,toX,toY,points);return this};Graphics.prototype.bezierCurveTo=function bezierCurveTo(cpX,cpY,cpX2,cpY2,toX,toY){this._initCurve();BezierUtils.curveTo(cpX,cpY,cpX2,cpY2,toX,toY,this.currentPath.points);return this};Graphics.prototype.arcTo=function arcTo(x1,y1,x2,y2,radius){this._initCurve(x1,y1);var points=this.currentPath.points;var result=ArcUtils.curveTo(x1,y1,x2,y2,radius,points);if(result){var cx=result.cx;var cy=result.cy;var radius$1=result.radius;var startAngle=result.startAngle;var endAngle=result.endAngle;var anticlockwise=result.anticlockwise;this.arc(cx,cy,radius$1,startAngle,endAngle,anticlockwise)}return this};Graphics.prototype.arc=function arc(cx,cy,radius,startAngle,endAngle,anticlockwise){if(anticlockwise===void 0)anticlockwise=false;if(startAngle===endAngle){return this}if(!anticlockwise&&endAngle<=startAngle){endAngle+=math.PI_2}else if(anticlockwise&&startAngle<=endAngle){startAngle+=math.PI_2}var sweep=endAngle-startAngle;if(sweep===0){return this}var startX=cx+Math.cos(startAngle)*radius;var startY=cy+Math.sin(startAngle)*radius;var points=this.currentPath?this.currentPath.points:null;if(points){var xDiff=Math.abs(points[points.length-2]-startX);var yDiff=Math.abs(points[points.length-1]-startY);if(xDiff<.001&&yDiff<.001);else{points.push(startX,startY)}}else{this.moveTo(startX,startY);points=this.currentPath.points}ArcUtils.arc(startX,startY,cx,cy,radius,startAngle,endAngle,anticlockwise,points);return this};Graphics.prototype.beginFill=function beginFill(color,alpha){if(color===void 0)color=0;if(alpha===void 0)alpha=1;return this.beginTextureFill(core.Texture.WHITE,color,alpha)};Graphics.prototype.beginTextureFill=function beginTextureFill(texture,color,alpha,matrix){if(texture===void 0)texture=core.Texture.WHITE;if(color===void 0)color=16777215;if(alpha===void 0)alpha=1;if(matrix===void 0)matrix=null;if(this.currentPath){this.startPoly()}var visible=alpha>0;if(!visible){this._fillStyle.reset()}else{if(matrix){matrix=matrix.clone();matrix.invert()}Object.assign(this._fillStyle,{color:color,alpha:alpha,texture:texture,matrix:matrix,visible:visible})}return this};Graphics.prototype.endFill=function endFill(){this.finishPoly();this._fillStyle.reset();return this};Graphics.prototype.drawRect=function drawRect(x,y,width,height){return this.drawShape(new math.Rectangle(x,y,width,height))};Graphics.prototype.drawRoundedRect=function drawRoundedRect(x,y,width,height,radius){return this.drawShape(new math.RoundedRectangle(x,y,width,height,radius))};Graphics.prototype.drawCircle=function drawCircle(x,y,radius){return this.drawShape(new math.Circle(x,y,radius))};Graphics.prototype.drawEllipse=function drawEllipse(x,y,width,height){return this.drawShape(new math.Ellipse(x,y,width,height))};Graphics.prototype.drawPolygon=function drawPolygon(path){var arguments$1=arguments;var points=path;var closeStroke=true;if(points.points){closeStroke=points.closeStroke;points=points.points}if(!Array.isArray(points)){points=new Array(arguments.length);for(var i=0;i<points.length;++i){points[i]=arguments$1[i]}}var shape=new math.Polygon(points);shape.closeStroke=closeStroke;this.drawShape(shape);return this};Graphics.prototype.drawShape=function drawShape(shape){if(!this._holeMode){this.geometry.drawShape(shape,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix)}else{this.geometry.drawHole(shape,this._matrix)}return this};Graphics.prototype.drawStar=function drawStar(x,y,points,radius,innerRadius,rotation){if(rotation===void 0)rotation=0;return this.drawPolygon(new Star(x,y,points,radius,innerRadius,rotation))};Graphics.prototype.clear=function clear(){this.geometry.clear();this._matrix=null;this._holeMode=false;this.currentPath=null;this._spriteRect=null;return this};Graphics.prototype.isFastRect=function isFastRect(){return false};Graphics.prototype._render=function _render(renderer){this.finishPoly();var geometry=this.geometry;geometry.updateBatches();if(geometry.batchable){if(this.batchDirty!==geometry.batchDirty){this.batches=[];this.batchTint=-1;this._transformID=-1;this.batchDirty=geometry.batchDirty;this.vertexData=new Float32Array(geometry.points);var blendMode=this.blendMode;for(var i=0;i<geometry.batches.length;i++){var gI=geometry.batches[i];var color=gI.style.color;var vertexData=new Float32Array(this.vertexData.buffer,gI.attribStart*4*2,gI.attribSize*2);var uvs=new Float32Array(geometry.uvsFloat32.buffer,gI.attribStart*4*2,gI.attribSize*2);var indices=new Uint16Array(geometry.indicesUint16.buffer,gI.start*2,gI.size);var batch={vertexData:vertexData,blendMode:blendMode,indices:indices,uvs:uvs,_batchRGB:utils.hex2rgb(color),_tintRGB:color,_texture:gI.style.texture,alpha:gI.style.alpha,worldAlpha:1};this.batches[i]=batch}}renderer.batch.setObjectRenderer(renderer.plugins.batch);if(this.batches.length){this.calculateVertices();this.calculateTints();for(var i$1=0;i$1<this.batches.length;i$1++){var batch$1=this.batches[i$1];batch$1.worldAlpha=this.worldAlpha*batch$1.alpha;renderer.plugins.batch.render(batch$1)}}}else{renderer.batch.flush();if(!this.shader){if(!defaultShader){var sampleValues=new Int32Array(16);for(var i$2=0;i$2<16;i$2++){sampleValues[i$2]=i$2}var uniforms={tint:new Float32Array([1,1,1,1]),translationMatrix:new math.Matrix,default:core.UniformGroup.from({uSamplers:sampleValues},true)};var program=renderer.plugins.batch.shader.program;defaultShader=new core.Shader(program,uniforms)}this.shader=defaultShader}var uniforms$1=this.shader.uniforms;uniforms$1.translationMatrix=this.transform.worldTransform;var tint=this.tint;var wa=this.worldAlpha;uniforms$1.tint[0]=(tint>>16&255)/255*wa;uniforms$1.tint[1]=(tint>>8&255)/255*wa;uniforms$1.tint[2]=(tint&255)/255*wa;uniforms$1.tint[3]=wa;renderer.shader.bind(this.shader);renderer.geometry.bind(geometry,this.shader);renderer.state.setState(this.state);for(var i$3=0;i$3<geometry.drawCalls.length;i$3++){var drawCall=geometry.drawCalls[i$3];var groupTextureCount=drawCall.textureCount;for(var j=0;j<groupTextureCount;j++){renderer.texture.bind(drawCall.textures[j],j)}renderer.geometry.draw(drawCall.type,drawCall.size,drawCall.start)}}};Graphics.prototype._calculateBounds=function _calculateBounds(){this.finishPoly();var lb=this.geometry.bounds;this._bounds.addFrame(this.transform,lb.minX,lb.minY,lb.maxX,lb.maxY)};Graphics.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,Graphics._TEMP_POINT);return this.geometry.containsPoint(Graphics._TEMP_POINT)};Graphics.prototype.calculateTints=function calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;var tintRGB=utils.hex2rgb(this.tint,temp);for(var i=0;i<this.batches.length;i++){var batch=this.batches[i];var batchTint=batch._batchRGB;var r=tintRGB[0]*batchTint[0]*255;var g=tintRGB[1]*batchTint[1]*255;var b=tintRGB[2]*batchTint[2]*255;var color=(r<<16)+(g<<8)+(b|0);batch._tintRGB=(color>>16)+(color&65280)+((color&255)<<16)}}};Graphics.prototype.calculateVertices=function calculateVertices(){if(this._transformID===this.transform._worldID){return}this._transformID=this.transform._worldID;var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var data=this.geometry.points;var vertexData=this.vertexData;var count=0;for(var i=0;i<data.length;i+=2){var x=data[i];var y=data[i+1];vertexData[count++]=a*x+c*y+tx;vertexData[count++]=d*y+b*x+ty}};Graphics.prototype.closePath=function closePath(){var currentPath=this.currentPath;if(currentPath){currentPath.closeStroke=true}return this};Graphics.prototype.setMatrix=function setMatrix(matrix){this._matrix=matrix;return this};Graphics.prototype.beginHole=function beginHole(){this.finishPoly();this._holeMode=true;return this};Graphics.prototype.endHole=function endHole(){this.finishPoly();this._holeMode=false;return this};Graphics.prototype.destroy=function destroy(options){Container.prototype.destroy.call(this,options);this.geometry.refCount--;if(this.geometry.refCount===0){this.geometry.dispose()}this._matrix=null;this.currentPath=null;this._lineStyle.destroy();this._lineStyle=null;this._fillStyle.destroy();this._fillStyle=null;this.geometry=null;this.shader=null;this.vertexData=null;this.batches.length=0;this.batches=null;Container.prototype.destroy.call(this,options)};Object.defineProperties(Graphics.prototype,prototypeAccessors);return Graphics}(display.Container);Graphics._TEMP_POINT=new math.Point;exports.FillStyle=FillStyle;exports.GRAPHICS_CURVES=GRAPHICS_CURVES;exports.Graphics=Graphics;exports.GraphicsData=GraphicsData;exports.GraphicsGeometry=GraphicsGeometry;exports.LineStyle=LineStyle},{"@pixi/constants":15,"@pixi/core":16,"@pixi/display":17,"@pixi/math":28,"@pixi/utils":46}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var math=require("@pixi/math");var ticker=require("@pixi/ticker");var display=require("@pixi/display");var utils=require("@pixi/utils");var InteractionData=function InteractionData(){this.global=new math.Point;this.target=null;this.originalEvent=null;this.identifier=null;this.isPrimary=false;this.button=0;this.buttons=0;this.width=0;this.height=0;this.tiltX=0;this.tiltY=0;this.pointerType=null;this.pressure=0;this.rotationAngle=0;this.twist=0;this.tangentialPressure=0};var prototypeAccessors={pointerId:{configurable:true}};prototypeAccessors.pointerId.get=function(){return this.identifier};InteractionData.prototype.getLocalPosition=function getLocalPosition(displayObject,point,globalPos){return displayObject.worldTransform.applyInverse(globalPos||this.global,point)};InteractionData.prototype.copyEvent=function copyEvent(event){if(event.isPrimary){this.isPrimary=true}this.button=event.button;this.buttons=Number.isInteger(event.buttons)?event.buttons:event.which;this.width=event.width;this.height=event.height;this.tiltX=event.tiltX;this.tiltY=event.tiltY;this.pointerType=event.pointerType;this.pressure=event.pressure;this.rotationAngle=event.rotationAngle;this.twist=event.twist||0;this.tangentialPressure=event.tangentialPressure||0};InteractionData.prototype.reset=function reset(){this.isPrimary=false};Object.defineProperties(InteractionData.prototype,prototypeAccessors);var InteractionEvent=function InteractionEvent(){this.stopped=false;this.target=null;this.currentTarget=null;this.type=null;this.data=null};InteractionEvent.prototype.stopPropagation=function stopPropagation(){this.stopped=true};InteractionEvent.prototype.reset=function reset(){this.stopped=false;this.currentTarget=null;this.target=null};var InteractionTrackingData=function InteractionTrackingData(pointerId){this._pointerId=pointerId;this._flags=InteractionTrackingData.FLAGS.NONE};var prototypeAccessors$1={pointerId:{configurable:true},flags:{configurable:true},none:{configurable:true},over:{configurable:true},rightDown:{configurable:true},leftDown:{configurable:true}};InteractionTrackingData.prototype._doSet=function _doSet(flag,yn){if(yn){this._flags=this._flags|flag}else{this._flags=this._flags&~flag}};prototypeAccessors$1.pointerId.get=function(){return this._pointerId};prototypeAccessors$1.flags.get=function(){return this._flags};prototypeAccessors$1.flags.set=function(flags){this._flags=flags};prototypeAccessors$1.none.get=function(){return this._flags===this.constructor.FLAGS.NONE};prototypeAccessors$1.over.get=function(){return(this._flags&this.constructor.FLAGS.OVER)!==0};prototypeAccessors$1.over.set=function(yn){this._doSet(this.constructor.FLAGS.OVER,yn)};prototypeAccessors$1.rightDown.get=function(){return(this._flags&this.constructor.FLAGS.RIGHT_DOWN)!==0};prototypeAccessors$1.rightDown.set=function(yn){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,yn)};prototypeAccessors$1.leftDown.get=function(){return(this._flags&this.constructor.FLAGS.LEFT_DOWN)!==0};prototypeAccessors$1.leftDown.set=function(yn){this._doSet(this.constructor.FLAGS.LEFT_DOWN,yn)};Object.defineProperties(InteractionTrackingData.prototype,prototypeAccessors$1);InteractionTrackingData.FLAGS=Object.freeze({NONE:0,OVER:1<<0,LEFT_DOWN:1<<1,RIGHT_DOWN:1<<2});var interactiveTarget={interactive:false,interactiveChildren:true,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(value){if(value){this.cursor="pointer"}else if(this.cursor==="pointer"){this.cursor=null}},cursor:null,get trackedPointers(){if(this._trackedPointers===undefined){this._trackedPointers={}}return this._trackedPointers},_trackedPointers:undefined};display.DisplayObject.mixin(interactiveTarget);var MOUSE_POINTER_ID=1;var hitTestEvent={target:null,data:{global:null}};var InteractionManager=function(EventEmitter){function InteractionManager(renderer,options){EventEmitter.call(this);options=options||{};this.renderer=renderer;this.autoPreventDefault=options.autoPreventDefault!==undefined?options.autoPreventDefault:true;this.interactionFrequency=options.interactionFrequency||10;this.mouse=new InteractionData;this.mouse.identifier=MOUSE_POINTER_ID;this.mouse.global.set(-999999);this.activeInteractionData={};this.activeInteractionData[MOUSE_POINTER_ID]=this.mouse;this.interactionDataPool=[];this.eventData=new InteractionEvent;this.interactionDOMElement=null;this.moveWhenInside=false;this.eventsAdded=false;this.mouseOverRenderer=false;this.supportsTouchEvents="ontouchstart"in window;this.supportsPointerEvents=!!window.PointerEvent;this.onPointerUp=this.onPointerUp.bind(this);this.processPointerUp=this.processPointerUp.bind(this);this.onPointerCancel=this.onPointerCancel.bind(this);this.processPointerCancel=this.processPointerCancel.bind(this);this.onPointerDown=this.onPointerDown.bind(this);this.processPointerDown=this.processPointerDown.bind(this);this.onPointerMove=this.onPointerMove.bind(this);this.processPointerMove=this.processPointerMove.bind(this);this.onPointerOut=this.onPointerOut.bind(this);this.processPointerOverOut=this.processPointerOverOut.bind(this);this.onPointerOver=this.onPointerOver.bind(this);this.cursorStyles={default:"inherit",pointer:"pointer"};this.currentCursorMode=null;this.cursor=null;this._tempPoint=new math.Point;this.resolution=1;this.setTargetElement(this.renderer.view,this.renderer.resolution)}if(EventEmitter)InteractionManager.__proto__=EventEmitter;InteractionManager.prototype=Object.create(EventEmitter&&EventEmitter.prototype);InteractionManager.prototype.constructor=InteractionManager;InteractionManager.prototype.hitTest=function hitTest(globalPoint,root){hitTestEvent.target=null;hitTestEvent.data.global=globalPoint;if(!root){root=this.renderer._lastObjectRendered}this.processInteractive(hitTestEvent,root,null,true);return hitTestEvent.target};InteractionManager.prototype.setTargetElement=function setTargetElement(element,resolution){if(resolution===void 0)resolution=1;this.removeEvents();this.interactionDOMElement=element;this.resolution=resolution;this.addEvents()};InteractionManager.prototype.addEvents=function addEvents(){if(!this.interactionDOMElement){return}ticker.Ticker.system.add(this.update,this,ticker.UPDATE_PRIORITY.INTERACTION);if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="none";this.interactionDOMElement.style["-ms-touch-action"]="none"}else if(this.supportsPointerEvents){this.interactionDOMElement.style["touch-action"]="none"}if(this.supportsPointerEvents){window.document.addEventListener("pointermove",this.onPointerMove,true);this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,true);this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,true);this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,true);window.addEventListener("pointercancel",this.onPointerCancel,true);window.addEventListener("pointerup",this.onPointerUp,true)}else{window.document.addEventListener("mousemove",this.onPointerMove,true);this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,true);this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,true);this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,true);window.addEventListener("mouseup",this.onPointerUp,true)}if(this.supportsTouchEvents){this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,true);this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,true);this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,true);this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,true)}this.eventsAdded=true};InteractionManager.prototype.removeEvents=function removeEvents(){if(!this.interactionDOMElement){return}ticker.Ticker.system.remove(this.update,this);if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="";this.interactionDOMElement.style["-ms-touch-action"]=""}else if(this.supportsPointerEvents){this.interactionDOMElement.style["touch-action"]=""}if(this.supportsPointerEvents){window.document.removeEventListener("pointermove",this.onPointerMove,true);this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,true);this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,true);window.removeEventListener("pointercancel",this.onPointerCancel,true);window.removeEventListener("pointerup",this.onPointerUp,true)}else{window.document.removeEventListener("mousemove",this.onPointerMove,true);this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,true);this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,true);window.removeEventListener("mouseup",this.onPointerUp,true)}if(this.supportsTouchEvents){this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,true);this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,true);this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,true)}this.interactionDOMElement=null;this.eventsAdded=false};InteractionManager.prototype.update=function update(deltaTime){this._deltaTime+=deltaTime;if(this._deltaTime<this.interactionFrequency){return}this._deltaTime=0;if(!this.interactionDOMElement){return}if(this.didMove){this.didMove=false;return}this.cursor=null;for(var k in this.activeInteractionData){if(this.activeInteractionData.hasOwnProperty(k)){var interactionData=this.activeInteractionData[k];if(interactionData.originalEvent&&interactionData.pointerType!=="touch"){var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,interactionData.originalEvent,interactionData);this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,true)}}}this.setCursorMode(this.cursor)};InteractionManager.prototype.setCursorMode=function setCursorMode(mode){mode=mode||"default";if(this.currentCursorMode===mode){return}this.currentCursorMode=mode;var style=this.cursorStyles[mode];if(style){switch(typeof style){case"string":this.interactionDOMElement.style.cursor=style;break;case"function":style(mode);break;case"object":Object.assign(this.interactionDOMElement.style,style);break}}else if(typeof mode==="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,mode)){this.interactionDOMElement.style.cursor=mode}};InteractionManager.prototype.dispatchEvent=function dispatchEvent(displayObject,eventString,eventData){if(!eventData.stopped){eventData.currentTarget=displayObject;eventData.type=eventString;displayObject.emit(eventString,eventData);if(displayObject[eventString]){displayObject[eventString](eventData)}}};InteractionManager.prototype.mapPositionToPoint=function mapPositionToPoint(point,x,y){var rect;if(!this.interactionDOMElement.parentElement){rect={x:0,y:0,width:0,height:0}}else{rect=this.interactionDOMElement.getBoundingClientRect()}var resolutionMultiplier=1/this.resolution;point.x=(x-rect.left)*(this.interactionDOMElement.width/rect.width)*resolutionMultiplier;point.y=(y-rect.top)*(this.interactionDOMElement.height/rect.height)*resolutionMultiplier};InteractionManager.prototype.processInteractive=function processInteractive(interactionEvent,displayObject,func,hitTest,interactive){if(!displayObject||!displayObject.visible){return false}var point=interactionEvent.data.global;interactive=displayObject.interactive||interactive;var hit=false;var interactiveParent=interactive;var hitTestChildren=true;if(displayObject.hitArea){if(hitTest){displayObject.worldTransform.applyInverse(point,this._tempPoint);if(!displayObject.hitArea.contains(this._tempPoint.x,this._tempPoint.y)){hitTest=false;hitTestChildren=false}else{hit=true}}interactiveParent=false}else if(displayObject._mask){if(hitTest){if(!(displayObject._mask.containsPoint&&displayObject._mask.containsPoint(point))){hitTest=false}}}if(hitTestChildren&&displayObject.interactiveChildren&&displayObject.children){var children=displayObject.children;for(var i=children.length-1;i>=0;i--){var child=children[i];var childHit=this.processInteractive(interactionEvent,child,func,hitTest,interactiveParent);if(childHit){if(!child.parent){continue}interactiveParent=false;if(childHit){if(interactionEvent.target){hitTest=false}hit=true}}}}if(interactive){if(hitTest&&!interactionEvent.target){if(!displayObject.hitArea&&displayObject.containsPoint){if(displayObject.containsPoint(point)){hit=true}}}if(displayObject.interactive){if(hit&&!interactionEvent.target){interactionEvent.target=displayObject}if(func){func(interactionEvent,displayObject,!!hit)}}}return hit};InteractionManager.prototype.onPointerDown=function onPointerDown(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch"){return}var events=this.normalizeToPointerData(originalEvent);if(this.autoPreventDefault&&events[0].isNormalized){var cancelable=originalEvent.cancelable||!("cancelable"in originalEvent);if(cancelable){originalEvent.preventDefault()}}var eventLen=events.length;for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerDown,true);this.emit("pointerdown",interactionEvent);if(event.pointerType==="touch"){this.emit("touchstart",interactionEvent)}else if(event.pointerType==="mouse"||event.pointerType==="pen"){var isRightButton=event.button===2;this.emit(isRightButton?"rightdown":"mousedown",this.eventData)}}};InteractionManager.prototype.processPointerDown=function processPointerDown(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;if(hit){if(!displayObject.trackedPointers[id]){displayObject.trackedPointers[id]=new InteractionTrackingData(id)}this.dispatchEvent(displayObject,"pointerdown",interactionEvent);if(data.pointerType==="touch"){this.dispatchEvent(displayObject,"touchstart",interactionEvent)}else if(data.pointerType==="mouse"||data.pointerType==="pen"){var isRightButton=data.button===2;if(isRightButton){displayObject.trackedPointers[id].rightDown=true}else{displayObject.trackedPointers[id].leftDown=true}this.dispatchEvent(displayObject,isRightButton?"rightdown":"mousedown",interactionEvent)}}};InteractionManager.prototype.onPointerComplete=function onPointerComplete(originalEvent,cancelled,func){var events=this.normalizeToPointerData(originalEvent);var eventLen=events.length;var eventAppend=originalEvent.target!==this.interactionDOMElement?"outside":"";for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,func,cancelled||!eventAppend);this.emit(cancelled?"pointercancel":"pointerup"+eventAppend,interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){var isRightButton=event.button===2;this.emit(isRightButton?"rightup"+eventAppend:"mouseup"+eventAppend,interactionEvent)}else if(event.pointerType==="touch"){this.emit(cancelled?"touchcancel":"touchend"+eventAppend,interactionEvent);this.releaseInteractionDataForPointerId(event.pointerId,interactionData)}}};InteractionManager.prototype.onPointerCancel=function onPointerCancel(event){if(this.supportsTouchEvents&&event.pointerType==="touch"){return}this.onPointerComplete(event,true,this.processPointerCancel)};InteractionManager.prototype.processPointerCancel=function processPointerCancel(interactionEvent,displayObject){var data=interactionEvent.data;var id=interactionEvent.data.identifier;if(displayObject.trackedPointers[id]!==undefined){delete displayObject.trackedPointers[id];this.dispatchEvent(displayObject,"pointercancel",interactionEvent);if(data.pointerType==="touch"){this.dispatchEvent(displayObject,"touchcancel",interactionEvent)}}};InteractionManager.prototype.onPointerUp=function onPointerUp(event){if(this.supportsTouchEvents&&event.pointerType==="touch"){return}this.onPointerComplete(event,false,this.processPointerUp)};InteractionManager.prototype.processPointerUp=function processPointerUp(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;var trackingData=displayObject.trackedPointers[id];var isTouch=data.pointerType==="touch";var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";var isMouseTap=false;if(isMouse){var isRightButton=data.button===2;var flags=InteractionTrackingData.FLAGS;var test=isRightButton?flags.RIGHT_DOWN:flags.LEFT_DOWN;var isDown=trackingData!==undefined&&trackingData.flags&test;if(hit){this.dispatchEvent(displayObject,isRightButton?"rightup":"mouseup",interactionEvent);if(isDown){this.dispatchEvent(displayObject,isRightButton?"rightclick":"click",interactionEvent);isMouseTap=true}}else if(isDown){this.dispatchEvent(displayObject,isRightButton?"rightupoutside":"mouseupoutside",interactionEvent)}if(trackingData){if(isRightButton){trackingData.rightDown=false}else{trackingData.leftDown=false}}}if(hit){this.dispatchEvent(displayObject,"pointerup",interactionEvent);if(isTouch){this.dispatchEvent(displayObject,"touchend",interactionEvent)}if(trackingData){if(!isMouse||isMouseTap){this.dispatchEvent(displayObject,"pointertap",interactionEvent)}if(isTouch){this.dispatchEvent(displayObject,"tap",interactionEvent);trackingData.over=false}}}else if(trackingData){this.dispatchEvent(displayObject,"pointerupoutside",interactionEvent);if(isTouch){this.dispatchEvent(displayObject,"touchendoutside",interactionEvent)}}if(trackingData&&trackingData.none){delete displayObject.trackedPointers[id]}};InteractionManager.prototype.onPointerMove=function onPointerMove(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch"){return}var events=this.normalizeToPointerData(originalEvent);if(events[0].pointerType==="mouse"||events[0].pointerType==="pen"){this.didMove=true;this.cursor=null}var eventLen=events.length;for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;var interactive=event.pointerType==="touch"?this.moveWhenInside:true;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerMove,interactive);this.emit("pointermove",interactionEvent);if(event.pointerType==="touch"){this.emit("touchmove",interactionEvent)}if(event.pointerType==="mouse"||event.pointerType==="pen"){this.emit("mousemove",interactionEvent)}}if(events[0].pointerType==="mouse"){this.setCursorMode(this.cursor)}};InteractionManager.prototype.processPointerMove=function processPointerMove(interactionEvent,displayObject,hit){var data=interactionEvent.data;var isTouch=data.pointerType==="touch";var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";if(isMouse){this.processPointerOverOut(interactionEvent,displayObject,hit)}if(!this.moveWhenInside||hit){this.dispatchEvent(displayObject,"pointermove",interactionEvent);if(isTouch){this.dispatchEvent(displayObject,"touchmove",interactionEvent)}if(isMouse){this.dispatchEvent(displayObject,"mousemove",interactionEvent)}}};InteractionManager.prototype.onPointerOut=function onPointerOut(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch"){return}var events=this.normalizeToPointerData(originalEvent);var event=events[0];if(event.pointerType==="mouse"){this.mouseOverRenderer=false;this.setCursorMode(null)}var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,false);this.emit("pointerout",interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){this.emit("mouseout",interactionEvent)}else{this.releaseInteractionDataForPointerId(interactionData.identifier)}};InteractionManager.prototype.processPointerOverOut=function processPointerOverOut(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";var trackingData=displayObject.trackedPointers[id];if(hit&&!trackingData){trackingData=displayObject.trackedPointers[id]=new InteractionTrackingData(id)}if(trackingData===undefined){return}if(hit&&this.mouseOverRenderer){if(!trackingData.over){trackingData.over=true;this.dispatchEvent(displayObject,"pointerover",interactionEvent);if(isMouse){this.dispatchEvent(displayObject,"mouseover",interactionEvent)}}if(isMouse&&this.cursor===null){this.cursor=displayObject.cursor}}else if(trackingData.over){trackingData.over=false;this.dispatchEvent(displayObject,"pointerout",this.eventData);if(isMouse){this.dispatchEvent(displayObject,"mouseout",interactionEvent)}if(trackingData.none){delete displayObject.trackedPointers[id]}}};InteractionManager.prototype.onPointerOver=function onPointerOver(originalEvent){var events=this.normalizeToPointerData(originalEvent);var event=events[0];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event;if(event.pointerType==="mouse"){this.mouseOverRenderer=true}this.emit("pointerover",interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){this.emit("mouseover",interactionEvent)}};InteractionManager.prototype.getInteractionDataForPointerId=function getInteractionDataForPointerId(event){var pointerId=event.pointerId;var interactionData;if(pointerId===MOUSE_POINTER_ID||event.pointerType==="mouse"){interactionData=this.mouse}else if(this.activeInteractionData[pointerId]){interactionData=this.activeInteractionData[pointerId]}else{interactionData=this.interactionDataPool.pop()||new InteractionData;interactionData.identifier=pointerId;this.activeInteractionData[pointerId]=interactionData}interactionData.copyEvent(event);return interactionData};InteractionManager.prototype.releaseInteractionDataForPointerId=function releaseInteractionDataForPointerId(pointerId){var interactionData=this.activeInteractionData[pointerId];if(interactionData){delete this.activeInteractionData[pointerId];interactionData.reset();this.interactionDataPool.push(interactionData)}};InteractionManager.prototype.configureInteractionEventForDOMEvent=function configureInteractionEventForDOMEvent(interactionEvent,pointerEvent,interactionData){interactionEvent.data=interactionData;this.mapPositionToPoint(interactionData.global,pointerEvent.clientX,pointerEvent.clientY);if(pointerEvent.pointerType==="touch"){pointerEvent.globalX=interactionData.global.x;pointerEvent.globalY=interactionData.global.y}interactionData.originalEvent=pointerEvent;interactionEvent.reset();return interactionEvent};InteractionManager.prototype.normalizeToPointerData=function normalizeToPointerData(event){var normalizedEvents=[];if(this.supportsTouchEvents&&event instanceof TouchEvent){for(var i=0,li=event.changedTouches.length;i<li;i++){var touch=event.changedTouches[i];if(typeof touch.button==="undefined"){touch.button=event.touches.length?1:0}if(typeof touch.buttons==="undefined"){touch.buttons=event.touches.length?1:0}if(typeof touch.isPrimary==="undefined"){touch.isPrimary=event.touches.length===1&&event.type==="touchstart"}if(typeof touch.width==="undefined"){touch.width=touch.radiusX||1}if(typeof touch.height==="undefined"){touch.height=touch.radiusY||1}if(typeof touch.tiltX==="undefined"){touch.tiltX=0}if(typeof touch.tiltY==="undefined"){touch.tiltY=0}if(typeof touch.pointerType==="undefined"){touch.pointerType="touch"}if(typeof touch.pointerId==="undefined"){touch.pointerId=touch.identifier||0}if(typeof touch.pressure==="undefined"){touch.pressure=touch.force||.5}if(typeof touch.twist==="undefined"){touch.twist=0}if(typeof touch.tangentialPressure==="undefined"){touch.tangentialPressure=0}if(typeof touch.layerX==="undefined"){touch.layerX=touch.offsetX=touch.clientX}if(typeof touch.layerY==="undefined"){touch.layerY=touch.offsetY=touch.clientY}touch.isNormalized=true;normalizedEvents.push(touch)}}else if(event instanceof MouseEvent&&(!this.supportsPointerEvents||!(event instanceof window.PointerEvent))){if(typeof event.isPrimary==="undefined"){event.isPrimary=true}if(typeof event.width==="undefined"){event.width=1}if(typeof event.height==="undefined"){event.height=1}if(typeof event.tiltX==="undefined"){event.tiltX=0}if(typeof event.tiltY==="undefined"){event.tiltY=0}if(typeof event.pointerType==="undefined"){event.pointerType="mouse"}if(typeof event.pointerId==="undefined"){event.pointerId=MOUSE_POINTER_ID}if(typeof event.pressure==="undefined"){event.pressure=.5}if(typeof event.twist==="undefined"){event.twist=0}if(typeof event.tangentialPressure==="undefined"){event.tangentialPressure=0}event.isNormalized=true;normalizedEvents.push(event)}else{normalizedEvents.push(event)}return normalizedEvents};InteractionManager.prototype.destroy=function destroy(){this.removeEvents();this.removeAllListeners();this.renderer=null;this.mouse=null;this.eventData=null;this.interactionDOMElement=null;this.onPointerDown=null;this.processPointerDown=null;this.onPointerUp=null;this.processPointerUp=null;this.onPointerCancel=null;this.processPointerCancel=null;this.onPointerMove=null;this.processPointerMove=null;this.onPointerOut=null;this.processPointerOverOut=null;this.onPointerOver=null;this._tempPoint=null};return InteractionManager}(utils.EventEmitter);exports.InteractionData=InteractionData;exports.InteractionEvent=InteractionEvent;exports.InteractionManager=InteractionManager;exports.InteractionTrackingData=InteractionTrackingData;exports.interactiveTarget=interactiveTarget},{"@pixi/display":17,"@pixi/math":28,"@pixi/ticker":45,"@pixi/utils":46}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var ResourceLoader=require("resource-loader");var ResourceLoader__default=_interopDefault(ResourceLoader);var utils=require("@pixi/utils");var core=require("@pixi/core");function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x["default"]:x}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}var parseUri=function parseURI(str,opts){opts=opts||{};var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser[opts.strictMode?"strict":"loose"].exec(str);var uri={};var i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri};var miniSignals=createCommonjsModule(function(module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor){descriptor.writable=true}Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps){defineProperties(Constructor.prototype,protoProps)}if(staticProps){defineProperties(Constructor,staticProps)}return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MiniSignalBinding=function(){function MiniSignalBinding(fn,once,thisArg){if(once===undefined){once=false}_classCallCheck(this,MiniSignalBinding);this._fn=fn;this._once=once;this._thisArg=thisArg;this._next=this._prev=this._owner=null}_createClass(MiniSignalBinding,[{key:"detach",value:function detach(){if(this._owner===null){return false}this._owner.detach(this);return true}}]);return MiniSignalBinding}();function _addMiniSignalBinding(self,node){if(!self._head){self._head=node;self._tail=node}else{self._tail._next=node;node._prev=self._tail;self._tail=node}node._owner=self;return node}var MiniSignal=function(){function MiniSignal(){_classCallCheck(this,MiniSignal);this._head=this._tail=undefined}_createClass(MiniSignal,[{key:"handlers",value:function handlers(){var exists=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var node=this._head;if(exists){return!!node}var ee=[];while(node){ee.push(node);node=node._next}return ee}},{key:"has",value:function has(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.")}return node._owner===this}},{key:"dispatch",value:function dispatch(){var arguments$1=arguments;var node=this._head;if(!node){return false}while(node){if(node._once){this.detach(node)}node._fn.apply(node._thisArg,arguments$1);node=node._next}return true}},{key:"add",value:function add(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#add(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,false,thisArg))}},{key:"once",value:function once(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#once(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,true,thisArg))}},{key:"detach",value:function detach(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.")}if(node._owner!==this){return this}if(node._prev){node._prev._next=node._next}if(node._next){node._next._prev=node._prev}if(node===this._head){this._head=node._next;if(node._next===null){this._tail=null}}else if(node===this._tail){this._tail=node._prev;this._tail._next=null}node._owner=null;return this}},{key:"detachAll",value:function detachAll(){var node=this._head;if(!node){return this}this._head=this._tail=null;while(node){node._owner=null;node=node._next}return this}}]);return MiniSignal}();MiniSignal.MiniSignalBinding=MiniSignalBinding;exports["default"]=MiniSignal;module.exports=exports["default"]});unwrapExports(miniSignals);var Resource_1=createCommonjsModule(function(module,exports){exports.__esModule=true;exports.Resource=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor){descriptor.writable=true}Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps){defineProperties(Constructor.prototype,protoProps)}if(staticProps){defineProperties(Constructor,staticProps)}return Constructor}}();var _parseUri2=_interopRequireDefault(parseUri);var _miniSignals2=_interopRequireDefault(miniSignals);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var useXdr=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest));var tempAnchor=null;var STATUS_NONE=0;var STATUS_OK=200;var STATUS_EMPTY=204;var STATUS_IE_BUG_EMPTY=1223;var STATUS_TYPE_OK=2;function _noop(){}var Resource=exports.Resource=function(){Resource.setExtensionLoadType=function setExtensionLoadType(extname,loadType){setExtMap(Resource._loadTypeMap,extname,loadType)};Resource.setExtensionXhrType=function setExtensionXhrType(extname,xhrType){setExtMap(Resource._xhrTypeMap,extname,xhrType)};function Resource(name,url,options){_classCallCheck(this,Resource);if(typeof name!=="string"||typeof url!=="string"){throw new Error("Both name and url are required for constructing a resource.")}options=options||{};this._flags=0;this._setFlag(Resource.STATUS_FLAGS.DATA_URL,url.indexOf("data:")===0);this.name=name;this.url=url;this.extension=this._getExtension();this.data=null;this.crossOrigin=options.crossOrigin===true?"anonymous":options.crossOrigin;this.timeout=options.timeout||0;this.loadType=options.loadType||this._determineLoadType();this.xhrType=options.xhrType;this.metadata=options.metadata||{};this.error=null;this.xhr=null;this.children=[];this.type=Resource.TYPE.UNKNOWN;this.progressChunk=0;this._dequeue=_noop;this._onLoadBinding=null;this._elementTimer=0;this._boundComplete=this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundOnTimeout=this._onTimeout.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this.onStart=new _miniSignals2.default;this.onProgress=new _miniSignals2.default;this.onComplete=new _miniSignals2.default;this.onAfterMiddleware=new _miniSignals2.default}Resource.prototype.complete=function complete(){this._clearEvents();this._finish()};Resource.prototype.abort=function abort(message){if(this.error){return}this.error=new Error(message);this._clearEvents();if(this.xhr){this.xhr.abort()}else if(this.xdr){this.xdr.abort()}else if(this.data){if(this.data.src){this.data.src=Resource.EMPTY_GIF}else{while(this.data.firstChild){this.data.removeChild(this.data.firstChild)}}}this._finish()};Resource.prototype.load=function load(cb){var _this=this;if(this.isLoading){return}if(this.isComplete){if(cb){setTimeout(function(){return cb(_this)},1)}return}else if(cb){this.onComplete.once(cb)}this._setFlag(Resource.STATUS_FLAGS.LOADING,true);this.onStart.dispatch(this);if(this.crossOrigin===false||typeof this.crossOrigin!=="string"){this.crossOrigin=this._determineCrossOrigin(this.url)}switch(this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE;this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO;this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO;this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:if(useXdr&&this.crossOrigin){this._loadXdr()}else{this._loadXhr()}break}};Resource.prototype._hasFlag=function _hasFlag(flag){return(this._flags&flag)!==0};Resource.prototype._setFlag=function _setFlag(flag,value){this._flags=value?this._flags|flag:this._flags&~flag};Resource.prototype._clearEvents=function _clearEvents(){clearTimeout(this._elementTimer);if(this.data&&this.data.removeEventListener){this.data.removeEventListener("error",this._boundOnError,false);this.data.removeEventListener("load",this._boundComplete,false);this.data.removeEventListener("progress",this._boundOnProgress,false);this.data.removeEventListener("canplaythrough",this._boundComplete,false)}if(this.xhr){if(this.xhr.removeEventListener){this.xhr.removeEventListener("error",this._boundXhrOnError,false);this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,false);this.xhr.removeEventListener("abort",this._boundXhrOnAbort,false);this.xhr.removeEventListener("progress",this._boundOnProgress,false);this.xhr.removeEventListener("load",this._boundXhrOnLoad,false)}else{this.xhr.onerror=null;this.xhr.ontimeout=null;this.xhr.onprogress=null;this.xhr.onload=null}}};Resource.prototype._finish=function _finish(){if(this.isComplete){throw new Error("Complete called again for an already completed resource.")}this._setFlag(Resource.STATUS_FLAGS.COMPLETE,true);this._setFlag(Resource.STATUS_FLAGS.LOADING,false);this.onComplete.dispatch(this)};Resource.prototype._loadElement=function _loadElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="image"&&typeof window.Image!=="undefined"){this.data=new Image}else{this.data=document.createElement(type)}if(this.crossOrigin){this.data.crossOrigin=this.crossOrigin}if(!this.metadata.skipSource){this.data.src=this.url}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);if(this.timeout){this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout)}};Resource.prototype._loadSourceElement=function _loadSourceElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="audio"&&typeof window.Audio!=="undefined"){this.data=new Audio}else{this.data=document.createElement(type)}if(this.data===null){this.abort("Unsupported element: "+type);return}if(this.crossOrigin){this.data.crossOrigin=this.crossOrigin}if(!this.metadata.skipSource){if(navigator.isCocoonJS){this.data.src=Array.isArray(this.url)?this.url[0]:this.url}else if(Array.isArray(this.url)){var mimeTypes=this.metadata.mimeType;for(var i=0;i<this.url.length;++i){this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes))}}else{var _mimeTypes=this.metadata.mimeType;this.data.appendChild(this._createSource(type,this.url,Array.isArray(_mimeTypes)?_mimeTypes[0]:_mimeTypes))}}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);this.data.addEventListener("canplaythrough",this._boundComplete,false);this.data.load();if(this.timeout){this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout)}};Resource.prototype._loadXhr=function _loadXhr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,true);xhr.timeout=this.timeout;if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){xhr.responseType=Resource.XHR_RESPONSE_TYPE.TEXT}else{xhr.responseType=this.xhrType}xhr.addEventListener("error",this._boundXhrOnError,false);xhr.addEventListener("timeout",this._boundXhrOnTimeout,false);xhr.addEventListener("abort",this._boundXhrOnAbort,false);xhr.addEventListener("progress",this._boundOnProgress,false);xhr.addEventListener("load",this._boundXhrOnLoad,false);xhr.send()};Resource.prototype._loadXdr=function _loadXdr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xdr=this.xhr=new XDomainRequest;xdr.timeout=this.timeout||5e3;xdr.onerror=this._boundXhrOnError;xdr.ontimeout=this._boundXhrOnTimeout;xdr.onprogress=this._boundOnProgress;xdr.onload=this._boundXhrOnLoad;xdr.open("GET",this.url,true);setTimeout(function(){return xdr.send()},1)};Resource.prototype._createSource=function _createSource(type,url,mime){if(!mime){mime=type+"/"+this._getExtension(url)}var source=document.createElement("source");source.src=url;source.type=mime;return source};Resource.prototype._onError=function _onError(event){this.abort("Failed to load element using: "+event.target.nodeName)};Resource.prototype._onProgress=function _onProgress(event){if(event&&event.lengthComputable){this.onProgress.dispatch(this,event.loaded/event.total)}};Resource.prototype._onTimeout=function _onTimeout(){this.abort("Load timed out.")};Resource.prototype._xhrOnError=function _xhrOnError(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')};Resource.prototype._xhrOnTimeout=function _xhrOnTimeout(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request timed out.")};Resource.prototype._xhrOnAbort=function _xhrOnAbort(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request was aborted by the user.")};Resource.prototype._xhrOnLoad=function _xhrOnLoad(){var xhr=this.xhr;var text="";var status=typeof xhr.status==="undefined"?STATUS_OK:xhr.status;if(xhr.responseType===""||xhr.responseType==="text"||typeof xhr.responseType==="undefined"){text=xhr.responseText}if(status===STATUS_NONE&&(text.length>0||xhr.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)){status=STATUS_OK}else if(status===STATUS_IE_BUG_EMPTY){status=STATUS_EMPTY}var statusType=status/100|0;if(statusType===STATUS_TYPE_OK){if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT){this.data=text;this.type=Resource.TYPE.TEXT}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON){try{this.data=JSON.parse(text);this.type=Resource.TYPE.JSON}catch(e){this.abort("Error trying to parse loaded json: "+e);return}}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){try{if(window.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(text,"text/xml")}else{var div=document.createElement("div");div.innerHTML=text;this.data=div}this.type=Resource.TYPE.XML}catch(e){this.abort("Error trying to parse loaded xml: "+e);return}}else{this.data=xhr.response||text}}else{this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL);return}this.complete()};Resource.prototype._determineCrossOrigin=function _determineCrossOrigin(url,loc){if(url.indexOf("data:")===0){return""}if(window.origin!==window.location.origin){return"anonymous"}loc=loc||window.location;if(!tempAnchor){tempAnchor=document.createElement("a")}tempAnchor.href=url;url=(0,_parseUri2.default)(tempAnchor.href,{strictMode:true});var samePort=!url.port&&loc.port===""||url.port===loc.port;var protocol=url.protocol?url.protocol+":":"";if(url.host!==loc.hostname||!samePort||protocol!==loc.protocol){return"anonymous"}return""};Resource.prototype._determineXhrType=function _determineXhrType(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT};Resource.prototype._determineLoadType=function _determineLoadType(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR};Resource.prototype._getExtension=function _getExtension(){var url=this.url;var ext="";if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?");var hashStart=url.indexOf("#");var index=Math.min(queryStart>-1?queryStart:url.length,hashStart>-1?hashStart:url.length);url=url.substring(0,index);ext=url.substring(url.lastIndexOf(".")+1)}return ext.toLowerCase()};Resource.prototype._getMimeFromXhrType=function _getMimeFromXhrType(type){switch(type){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}};_createClass(Resource,[{key:"isDataUrl",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]);return Resource}();Resource.STATUS_FLAGS={NONE:0,DATA_URL:1<<0,COMPLETE:1<<1,LOADING:1<<2};Resource.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6};Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE,svg:Resource.LOAD_TYPE.IMAGE,"svg+xml":Resource.LOAD_TYPE.IMAGE,mp3:Resource.LOAD_TYPE.AUDIO,ogg:Resource.LOAD_TYPE.AUDIO,wav:Resource.LOAD_TYPE.AUDIO,mp4:Resource.LOAD_TYPE.VIDEO,webm:Resource.LOAD_TYPE.VIDEO};Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT,ttf:Resource.XHR_RESPONSE_TYPE.BUFFER,otf:Resource.XHR_RESPONSE_TYPE.BUFFER};Resource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function setExtMap(map,extname,val){if(extname&&extname.indexOf(".")===0){extname=extname.substring(1)}if(!extname){return}map[extname]=val}function reqType(xhr){return xhr.toString().replace("object ","")}{module.exports.default=Resource}});unwrapExports(Resource_1);var Resource_2=Resource_1.Resource;var b64=createCommonjsModule(function(module,exports){exports.__esModule=true;exports.encodeBinary=encodeBinary;var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(input){var output="";var inx=0;while(inx<input.length){var bytebuffer=[0,0,0];var encodedCharIndexes=[0,0,0,0];for(var jnx=0;jnx<bytebuffer.length;++jnx){if(inx<input.length){bytebuffer[jnx]=input.charCodeAt(inx++)&255}else{bytebuffer[jnx]=0}}encodedCharIndexes[0]=bytebuffer[0]>>2;encodedCharIndexes[1]=(bytebuffer[0]&3)<<4|bytebuffer[1]>>4;encodedCharIndexes[2]=(bytebuffer[1]&15)<<2|bytebuffer[2]>>6;encodedCharIndexes[3]=bytebuffer[2]&63;var paddingBytes=inx-(input.length-1);switch(paddingBytes){case 2:encodedCharIndexes[3]=64;encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64;break;default:break}for(var _jnx=0;_jnx<encodedCharIndexes.length;++_jnx){output+=_keyStr.charAt(encodedCharIndexes[_jnx])}}return output}{module.exports.default=encodeBinary}});unwrapExports(b64);var b64_1=b64.encodeBinary;var blob=createCommonjsModule(function(module,exports){exports.__esModule=true;exports.blobMiddlewareFactory=blobMiddlewareFactory;var Url=window.URL||window.webkitURL;function blobMiddlewareFactory(){return function blobMiddleware(resource,next){if(!resource.data){next();return}if(resource.xhr&&resource.xhrType===Resource_1.Resource.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof resource.data==="string"){var type=resource.xhr.getResponseHeader("content-type");if(type&&type.indexOf("image")===0){resource.data=new Image;resource.data.src="data:"+type+";base64,"+(0,b64.encodeBinary)(resource.xhr.responseText);resource.type=Resource_1.Resource.TYPE.IMAGE;resource.data.onload=function(){resource.data.onload=null;next()};return}}else if(resource.data.type.indexOf("image")===0){var src=Url.createObjectURL(resource.data);resource.blob=resource.data;resource.data=new Image;resource.data.src=src;resource.type=Resource_1.Resource.TYPE.IMAGE;resource.data.onload=function(){Url.revokeObjectURL(src);resource.data.onload=null;next()};return}}next()}}});unwrapExports(blob);var blob_1=blob.blobMiddlewareFactory;var TextureLoader=function TextureLoader(){};TextureLoader.use=function use(resource,next){if(resource.data&&resource.type===ResourceLoader.Resource.TYPE.IMAGE){resource.texture=core.Texture.fromLoader(resource.data,resource.url,resource.name)}next()};var Loader=function(ResourceLoader){function Loader(baseUrl,concurrency){var this$1=this;ResourceLoader.call(this,baseUrl,concurrency);utils.EventEmitter.call(this);for(var i=0;i<Loader._plugins.length;++i){var plugin=Loader._plugins[i];var pre=plugin.pre;var use=plugin.use;if(pre){this.pre(pre)}if(use){this.use(use)}}this.onStart.add(function(l){return this$1.emit("start",l)});this.onProgress.add(function(l,r){return this$1.emit("progress",l,r)});this.onError.add(function(e,l,r){return this$1.emit("error",e,l,r)});this.onLoad.add(function(l,r){return this$1.emit("load",l,r)});this.onComplete.add(function(l,r){return this$1.emit("complete",l,r)});this._protected=false}if(ResourceLoader)Loader.__proto__=ResourceLoader;Loader.prototype=Object.create(ResourceLoader&&ResourceLoader.prototype);Loader.prototype.constructor=Loader;var staticAccessors={shared:{configurable:true}};Loader.prototype.destroy=function destroy(){if(!this._protected){this.removeAllListeners();this.reset()}};staticAccessors.shared.get=function(){var shared=Loader._shared;if(!shared){shared=new Loader;shared._protected=true;Loader._shared=shared}return shared};Object.defineProperties(Loader,staticAccessors);return Loader}(ResourceLoader__default);Object.assign(Loader.prototype,utils.EventEmitter.prototype);Loader._plugins=[];Loader.registerPlugin=function registerPlugin(plugin){Loader._plugins.push(plugin);if(plugin.add){plugin.add()}return Loader};Loader.registerPlugin({use:blob_1()});Loader.registerPlugin(TextureLoader);var AppLoaderPlugin=function AppLoaderPlugin(){};AppLoaderPlugin.init=function init(options){options=Object.assign({sharedLoader:false},options);this.loader=options.sharedLoader?Loader.shared:new Loader};AppLoaderPlugin.destroy=function destroy(){if(this.loader){this.loader.destroy();this.loader=null}};var LoaderResource=ResourceLoader.Resource;exports.AppLoaderPlugin=AppLoaderPlugin;exports.Loader=Loader;exports.LoaderResource=LoaderResource;exports.TextureLoader=TextureLoader},{"@pixi/core":16,"@pixi/utils":46,"resource-loader":88}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Point=function Point(x,y){if(x===void 0)x=0;if(y===void 0)y=0;this.x=x;this.y=y};Point.prototype.clone=function clone(){return new Point(this.x,this.y)};Point.prototype.copyFrom=function copyFrom(p){this.set(p.x,p.y);return this};Point.prototype.copyTo=function copyTo(p){p.set(this.x,this.y);return p};Point.prototype.equals=function equals(p){return p.x===this.x&&p.y===this.y};Point.prototype.set=function set(x,y){this.x=x||0;this.y=y||(y!==0?this.x:0)};var ObservablePoint=function ObservablePoint(cb,scope,x,y){if(x===void 0)x=0;if(y===void 0)y=0;this._x=x;this._y=y;this.cb=cb;this.scope=scope};var prototypeAccessors={x:{configurable:true},y:{configurable:true}};ObservablePoint.prototype.clone=function clone(cb,scope){if(cb===void 0)cb=null;if(scope===void 0)scope=null;var _cb=cb||this.cb;var _scope=scope||this.scope;return new ObservablePoint(_cb,_scope,this._x,this._y)};ObservablePoint.prototype.set=function set(x,y){var _x=x||0;var _y=y||(y!==0?_x:0);if(this._x!==_x||this._y!==_y){this._x=_x;this._y=_y;this.cb.call(this.scope)}};ObservablePoint.prototype.copyFrom=function copyFrom(p){if(this._x!==p.x||this._y!==p.y){this._x=p.x;this._y=p.y;this.cb.call(this.scope)}return this};ObservablePoint.prototype.copyTo=function copyTo(p){p.set(this._x,this._y);return p};ObservablePoint.prototype.equals=function equals(p){return p.x===this._x&&p.y===this._y};prototypeAccessors.x.get=function(){return this._x};prototypeAccessors.x.set=function(value){if(this._x!==value){this._x=value;this.cb.call(this.scope)}};prototypeAccessors.y.get=function(){return this._y};prototypeAccessors.y.set=function(value){if(this._y!==value){this._y=value;this.cb.call(this.scope)}};Object.defineProperties(ObservablePoint.prototype,prototypeAccessors);var PI_2=Math.PI*2;var RAD_TO_DEG=180/Math.PI;var DEG_TO_RAD=Math.PI/180;var SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};var Matrix=function Matrix(a,b,c,d,tx,ty){if(a===void 0)a=1;if(b===void 0)b=0;if(c===void 0)c=0;if(d===void 0)d=1;if(tx===void 0)tx=0;if(ty===void 0)ty=0;this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;this.array=null};var staticAccessors={IDENTITY:{configurable:true},TEMP_MATRIX:{configurable:true}};Matrix.prototype.fromArray=function fromArray(array){this.a=array[0];this.b=array[1];this.c=array[3];this.d=array[4];this.tx=array[2];this.ty=array[5]};Matrix.prototype.set=function set(a,b,c,d,tx,ty){this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;return this};Matrix.prototype.toArray=function toArray(transpose,out){if(!this.array){this.array=new Float32Array(9)}var array=out||this.array;if(transpose){array[0]=this.a;array[1]=this.b;array[2]=0;array[3]=this.c;array[4]=this.d;array[5]=0;array[6]=this.tx;array[7]=this.ty;array[8]=1}else{array[0]=this.a;array[1]=this.c;array[2]=this.tx;array[3]=this.b;array[4]=this.d;array[5]=this.ty;array[6]=0;array[7]=0;array[8]=1}return array};Matrix.prototype.apply=function apply(pos,newPos){newPos=newPos||new Point;var x=pos.x;var y=pos.y;newPos.x=this.a*x+this.c*y+this.tx;newPos.y=this.b*x+this.d*y+this.ty;return newPos};Matrix.prototype.applyInverse=function applyInverse(pos,newPos){newPos=newPos||new Point;var id=1/(this.a*this.d+this.c*-this.b);var x=pos.x;var y=pos.y;newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id;newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id;return newPos};Matrix.prototype.translate=function translate(x,y){this.tx+=x;this.ty+=y;return this};Matrix.prototype.scale=function scale(x,y){this.a*=x;this.d*=y;this.c*=x;this.b*=y;this.tx*=x;this.ty*=y;return this};Matrix.prototype.rotate=function rotate(angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var a1=this.a;var c1=this.c;var tx1=this.tx;this.a=a1*cos-this.b*sin;this.b=a1*sin+this.b*cos;this.c=c1*cos-this.d*sin;this.d=c1*sin+this.d*cos;this.tx=tx1*cos-this.ty*sin;this.ty=tx1*sin+this.ty*cos;return this};Matrix.prototype.append=function append(matrix){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;this.a=matrix.a*a1+matrix.b*c1;this.b=matrix.a*b1+matrix.b*d1;this.c=matrix.c*a1+matrix.d*c1;this.d=matrix.c*b1+matrix.d*d1;this.tx=matrix.tx*a1+matrix.ty*c1+this.tx;this.ty=matrix.tx*b1+matrix.ty*d1+this.ty;return this};Matrix.prototype.setTransform=function setTransform(x,y,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){this.a=Math.cos(rotation+skewY)*scaleX;this.b=Math.sin(rotation+skewY)*scaleX;this.c=-Math.sin(rotation-skewX)*scaleY;this.d=Math.cos(rotation-skewX)*scaleY;this.tx=x-(pivotX*this.a+pivotY*this.c);this.ty=y-(pivotX*this.b+pivotY*this.d);return this};Matrix.prototype.prepend=function prepend(matrix){var tx1=this.tx;if(matrix.a!==1||matrix.b!==0||matrix.c!==0||matrix.d!==1){var a1=this.a;var c1=this.c;this.a=a1*matrix.a+this.b*matrix.c;this.b=a1*matrix.b+this.b*matrix.d;this.c=c1*matrix.a+this.d*matrix.c;this.d=c1*matrix.b+this.d*matrix.d}this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx;this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty;return this};Matrix.prototype.decompose=function decompose(transform){var a=this.a;var b=this.b;var c=this.c;var d=this.d;var skewX=-Math.atan2(-c,d);var skewY=Math.atan2(b,a);var delta=Math.abs(skewX+skewY);if(delta<1e-5||Math.abs(PI_2-delta)<1e-5){transform.rotation=skewY;transform.skew.x=transform.skew.y=0}else{transform.rotation=0;transform.skew.x=skewX;transform.skew.y=skewY}transform.scale.x=Math.sqrt(a*a+b*b);transform.scale.y=Math.sqrt(c*c+d*d);transform.position.x=this.tx;transform.position.y=this.ty;return transform};Matrix.prototype.invert=function invert(){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;var tx1=this.tx;var n=a1*d1-b1*c1;this.a=d1/n;this.b=-b1/n;this.c=-c1/n;this.d=a1/n;this.tx=(c1*this.ty-d1*tx1)/n;this.ty=-(a1*this.ty-b1*tx1)/n;return this};Matrix.prototype.identity=function identity(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;return this};Matrix.prototype.clone=function clone(){var matrix=new Matrix;matrix.a=this.a;matrix.b=this.b;matrix.c=this.c;matrix.d=this.d;matrix.tx=this.tx;matrix.ty=this.ty;return matrix};Matrix.prototype.copyTo=function copyTo(matrix){matrix.a=this.a;matrix.b=this.b;matrix.c=this.c;matrix.d=this.d;matrix.tx=this.tx;matrix.ty=this.ty;return matrix};Matrix.prototype.copyFrom=function copyFrom(matrix){this.a=matrix.a;this.b=matrix.b;this.c=matrix.c;this.d=matrix.d;this.tx=matrix.tx;this.ty=matrix.ty;return this};staticAccessors.IDENTITY.get=function(){return new Matrix};staticAccessors.TEMP_MATRIX.get=function(){return new Matrix};Object.defineProperties(Matrix,staticAccessors);var ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1];var uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1];var vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1];var vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1];var tempMatrices=[];var mul=[];function signum(x){if(x<0){return-1}if(x>0){return 1}return 0}function init(){for(var i=0;i<16;i++){var row=[];mul.push(row);for(var j=0;j<16;j++){var _ux=signum(ux[i]*ux[j]+vx[i]*uy[j]);var _uy=signum(uy[i]*ux[j]+vy[i]*uy[j]);var _vx=signum(ux[i]*vx[j]+vx[i]*vy[j]);var _vy=signum(uy[i]*vx[j]+vy[i]*vy[j]);for(var k=0;k<16;k++){if(ux[k]===_ux&&uy[k]===_uy&&vx[k]===_vx&&vy[k]===_vy){row.push(k);break}}}}for(var i$1=0;i$1<16;i$1++){var mat=new Matrix;mat.set(ux[i$1],uy[i$1],vx[i$1],vy[i$1],0,0);tempMatrices.push(mat)}}init();var GroupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(ind){return ux[ind]},uY:function(ind){return uy[ind]},vX:function(ind){return vx[ind]},vY:function(ind){return vy[ind]},inv:function(rotation){if(rotation&8){return rotation&15}return-rotation&7},add:function(rotationSecond,rotationFirst){return mul[rotationSecond][rotationFirst]},sub:function(rotationSecond,rotationFirst){return mul[rotationSecond][GroupD8.inv(rotationFirst)]},rotate180:function(rotation){return rotation^4},isVertical:function(rotation){return(rotation&3)===2},byDirection:function(dx,dy){if(Math.abs(dx)*2<=Math.abs(dy)){if(dy>=0){return GroupD8.S}return GroupD8.N}else if(Math.abs(dy)*2<=Math.abs(dx)){if(dx>0){return GroupD8.E}return GroupD8.W}else if(dy>0){if(dx>0){return GroupD8.SE}return GroupD8.SW}else if(dx>0){return GroupD8.NE}return GroupD8.NW},matrixAppendRotationInv:function(matrix,rotation,tx,ty){if(tx===void 0)tx=0;if(ty===void 0)ty=0;var mat=tempMatrices[GroupD8.inv(rotation)];mat.tx=tx;mat.ty=ty;matrix.append(mat)}};var Transform=function Transform(){this.worldTransform=new Matrix;this.localTransform=new Matrix;this.position=new ObservablePoint(this.onChange,this,0,0);this.scale=new ObservablePoint(this.onChange,this,1,1);this.pivot=new ObservablePoint(this.onChange,this,0,0);this.skew=new ObservablePoint(this.updateSkew,this,0,0);this._rotation=0;this._cx=1;this._sx=0;this._cy=0;this._sy=1;this._localID=0;this._currentLocalID=0;this._worldID=0;this._parentID=0};var prototypeAccessors$1={rotation:{configurable:true}};Transform.prototype.onChange=function onChange(){this._localID++};Transform.prototype.updateSkew=function updateSkew(){this._cx=Math.cos(this._rotation+this.skew._y);this._sx=Math.sin(this._rotation+this.skew._y);this._cy=-Math.sin(this._rotation-this.skew._x);this._sy=Math.cos(this._rotation-this.skew._x);this._localID++};Transform.prototype.updateLocalTransform=function updateLocalTransform(){var lt=this.localTransform;if(this._localID!==this._currentLocalID){lt.a=this._cx*this.scale._x;lt.b=this._sx*this.scale._x;lt.c=this._cy*this.scale._y;lt.d=this._sy*this.scale._y;lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c);lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d);this._currentLocalID=this._localID;this._parentID=-1}};Transform.prototype.updateTransform=function updateTransform(parentTransform){var lt=this.localTransform;if(this._localID!==this._currentLocalID){lt.a=this._cx*this.scale._x;lt.b=this._sx*this.scale._x;lt.c=this._cy*this.scale._y;lt.d=this._sy*this.scale._y;lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c);lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d);this._currentLocalID=this._localID;this._parentID=-1}if(this._parentID!==parentTransform._worldID){var pt=parentTransform.worldTransform;var wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c;wt.b=lt.a*pt.b+lt.b*pt.d;wt.c=lt.c*pt.a+lt.d*pt.c;wt.d=lt.c*pt.b+lt.d*pt.d;wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx;wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty;this._parentID=parentTransform._worldID;this._worldID++}};Transform.prototype.setFromMatrix=function setFromMatrix(matrix){matrix.decompose(this);this._localID++};prototypeAccessors$1.rotation.get=function(){return this._rotation};prototypeAccessors$1.rotation.set=function(value){if(this._rotation!==value){this._rotation=value;this.updateSkew()}};Object.defineProperties(Transform.prototype,prototypeAccessors$1);Transform.IDENTITY=new Transform;var Rectangle=function Rectangle(x,y,width,height){if(x===void 0)x=0;if(y===void 0)y=0;if(width===void 0)width=0;if(height===void 0)height=0;this.x=Number(x);this.y=Number(y);this.width=Number(width);this.height=Number(height);this.type=SHAPES.RECT};var prototypeAccessors$2={left:{configurable:true},right:{configurable:true},top:{configurable:true},bottom:{configurable:true}};var staticAccessors$1={EMPTY:{configurable:true}};prototypeAccessors$2.left.get=function(){return this.x};prototypeAccessors$2.right.get=function(){return this.x+this.width};prototypeAccessors$2.top.get=function(){return this.y};prototypeAccessors$2.bottom.get=function(){return this.y+this.height};staticAccessors$1.EMPTY.get=function(){return new Rectangle(0,0,0,0)};Rectangle.prototype.clone=function clone(){return new Rectangle(this.x,this.y,this.width,this.height)};Rectangle.prototype.copyFrom=function copyFrom(rectangle){this.x=rectangle.x;this.y=rectangle.y;this.width=rectangle.width;this.height=rectangle.height;return this};Rectangle.prototype.copyTo=function copyTo(rectangle){rectangle.x=this.x;rectangle.y=this.y;rectangle.width=this.width;rectangle.height=this.height;return rectangle};Rectangle.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}if(x>=this.x&&x<this.x+this.width){if(y>=this.y&&y<this.y+this.height){return true}}return false};Rectangle.prototype.pad=function pad(paddingX,paddingY){paddingX=paddingX||0;paddingY=paddingY||(paddingY!==0?paddingX:0);this.x-=paddingX;this.y-=paddingY;this.width+=paddingX*2;this.height+=paddingY*2};Rectangle.prototype.fit=function fit(rectangle){var x1=Math.max(this.x,rectangle.x);var x2=Math.min(this.x+this.width,rectangle.x+rectangle.width);var y1=Math.max(this.y,rectangle.y);var y2=Math.min(this.y+this.height,rectangle.y+rectangle.height);this.x=x1;this.width=Math.max(x2-x1,0);this.y=y1;this.height=Math.max(y2-y1,0)};Rectangle.prototype.ceil=function ceil(resolution,eps){if(resolution===void 0)resolution=1;if(eps===void 0)eps=.001;var x2=Math.ceil((this.x+this.width-eps)*resolution)/resolution;var y2=Math.ceil((this.y+this.height-eps)*resolution)/resolution;this.x=Math.floor((this.x+eps)*resolution)/resolution;this.y=Math.floor((this.y+eps)*resolution)/resolution;this.width=x2-this.x;this.height=y2-this.y};Rectangle.prototype.enlarge=function enlarge(rectangle){var x1=Math.min(this.x,rectangle.x);var x2=Math.max(this.x+this.width,rectangle.x+rectangle.width);var y1=Math.min(this.y,rectangle.y);var y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);this.x=x1;this.width=x2-x1;this.y=y1;this.height=y2-y1};Object.defineProperties(Rectangle.prototype,prototypeAccessors$2);Object.defineProperties(Rectangle,staticAccessors$1);var Circle=function Circle(x,y,radius){if(x===void 0)x=0;if(y===void 0)y=0;if(radius===void 0)radius=0;this.x=x;this.y=y;this.radius=radius;this.type=SHAPES.CIRC};Circle.prototype.clone=function clone(){return new Circle(this.x,this.y,this.radius)};Circle.prototype.contains=function contains(x,y){if(this.radius<=0){return false}var r2=this.radius*this.radius;var dx=this.x-x;var dy=this.y-y;dx*=dx;dy*=dy;return dx+dy<=r2};Circle.prototype.getBounds=function getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)};var Ellipse=function Ellipse(x,y,halfWidth,halfHeight){if(x===void 0)x=0;if(y===void 0)y=0;if(halfWidth===void 0)halfWidth=0;if(halfHeight===void 0)halfHeight=0;this.x=x;this.y=y;this.width=halfWidth;this.height=halfHeight;this.type=SHAPES.ELIP};Ellipse.prototype.clone=function clone(){return new Ellipse(this.x,this.y,this.width,this.height)};Ellipse.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}var normx=(x-this.x)/this.width;var normy=(y-this.y)/this.height;normx*=normx;normy*=normy;return normx+normy<=1};Ellipse.prototype.getBounds=function getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)};var Polygon=function Polygon(){var points=[],len=arguments.length;while(len--)points[len]=arguments[len];if(Array.isArray(points[0])){points=points[0]}if(points[0]instanceof Point){var p=[];for(var i=0,il=points.length;i<il;i++){p.push(points[i].x,points[i].y)}points=p}this.points=points;this.type=SHAPES.POLY;this.closeStroke=true};Polygon.prototype.clone=function clone(){var polygon=new Polygon(this.points.slice());polygon.closeStroke=this.closeStroke;return polygon};Polygon.prototype.contains=function contains(x,y){var inside=false;var length=this.points.length/2;for(var i=0,j=length-1;i<length;j=i++){var xi=this.points[i*2];var yi=this.points[i*2+1];var xj=this.points[j*2];var yj=this.points[j*2+1];var intersect=yi>y!==yj>y&&x<(xj-xi)*((y-yi)/(yj-yi))+xi;if(intersect){inside=!inside}}return inside};var RoundedRectangle=function RoundedRectangle(x,y,width,height,radius){if(x===void 0)x=0;if(y===void 0)y=0;if(width===void 0)width=0;if(height===void 0)height=0;if(radius===void 0)radius=20;this.x=x;this.y=y;this.width=width;this.height=height;this.radius=radius;this.type=SHAPES.RREC};RoundedRectangle.prototype.clone=function clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)};RoundedRectangle.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}if(x>=this.x&&x<=this.x+this.width){if(y>=this.y&&y<=this.y+this.height){if(y>=this.y+this.radius&&y<=this.y+this.height-this.radius||x>=this.x+this.radius&&x<=this.x+this.width-this.radius){return true}var dx=x-(this.x+this.radius);var dy=y-(this.y+this.radius);var radius2=this.radius*this.radius;if(dx*dx+dy*dy<=radius2){return true}dx=x-(this.x+this.width-this.radius);if(dx*dx+dy*dy<=radius2){return true}dy=y-(this.y+this.height-this.radius);if(dx*dx+dy*dy<=radius2){return true}dx=x-(this.x+this.radius);if(dx*dx+dy*dy<=radius2){return true}}}return false};exports.Circle=Circle;exports.DEG_TO_RAD=DEG_TO_RAD;exports.Ellipse=Ellipse;exports.GroupD8=GroupD8;exports.Matrix=Matrix;exports.ObservablePoint=ObservablePoint;exports.PI_2=PI_2;exports.Point=Point;exports.Polygon=Polygon;exports.RAD_TO_DEG=RAD_TO_DEG;exports.Rectangle=Rectangle;exports.RoundedRectangle=RoundedRectangle;exports.SHAPES=SHAPES;exports.Transform=Transform},{}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var mesh=require("@pixi/mesh");var core=require("@pixi/core");var PlaneGeometry=function(MeshGeometry){function PlaneGeometry(width,height,segWidth,segHeight){if(width===void 0)width=100;if(height===void 0)height=100;if(segWidth===void 0)segWidth=10;if(segHeight===void 0)segHeight=10;MeshGeometry.call(this);this.segWidth=segWidth;this.segHeight=segHeight;this.width=width;this.height=height;this.build()}if(MeshGeometry)PlaneGeometry.__proto__=MeshGeometry;PlaneGeometry.prototype=Object.create(MeshGeometry&&MeshGeometry.prototype);PlaneGeometry.prototype.constructor=PlaneGeometry;PlaneGeometry.prototype.build=function build(){var total=this.segWidth*this.segHeight;var verts=[];var uvs=[];var indices=[];var segmentsX=this.segWidth-1;var segmentsY=this.segHeight-1;var sizeX=this.width/segmentsX;var sizeY=this.height/segmentsY;for(var i=0;i<total;i++){var x=i%this.segWidth;var y=i/this.segWidth|0;verts.push(x*sizeX,y*sizeY);uvs.push(x/segmentsX,y/segmentsY)}var totalSub=segmentsX*segmentsY;for(var i$1=0;i$1<totalSub;i$1++){var xpos=i$1%segmentsX;var ypos=i$1/segmentsX|0;var value=ypos*this.segWidth+xpos;var value2=ypos*this.segWidth+xpos+1;var value3=(ypos+1)*this.segWidth+xpos;var value4=(ypos+1)*this.segWidth+xpos+1;indices.push(value,value2,value3,value2,value4,value3)}this.buffers[0].data=new Float32Array(verts);this.buffers[1].data=new Float32Array(uvs);this.indexBuffer.data=new Uint16Array(indices);this.buffers[0].update();this.buffers[1].update();this.indexBuffer.update()};return PlaneGeometry}(mesh.MeshGeometry);var RopeGeometry=function(MeshGeometry){function RopeGeometry(width,points){if(width===void 0)width=200;MeshGeometry.call(this,new Float32Array(points.length*4),new Float32Array(points.length*4),new Uint16Array((points.length-1)*6));this.points=points;this.width=width;this.build()}if(MeshGeometry)RopeGeometry.__proto__=MeshGeometry;RopeGeometry.prototype=Object.create(MeshGeometry&&MeshGeometry.prototype);RopeGeometry.prototype.constructor=RopeGeometry;RopeGeometry.prototype.build=function build(){var points=this.points;if(!points){return}var vertexBuffer=this.getBuffer("aVertexPosition");var uvBuffer=this.getBuffer("aTextureCoord");var indexBuffer=this.getIndex();if(points.length<1){return}if(vertexBuffer.data.length/4!==points.length){vertexBuffer.data=new Float32Array(points.length*4);uvBuffer.data=new Float32Array(points.length*4);indexBuffer.data=new Uint16Array((points.length-1)*6)}var uvs=uvBuffer.data;var indices=indexBuffer.data;uvs[0]=0;uvs[1]=0;uvs[2]=0;uvs[3]=1;var total=points.length;for(var i=0;i<total;i++){var index=i*4;var amount=i/(total-1);uvs[index]=amount;uvs[index+1]=0;uvs[index+2]=amount;uvs[index+3]=1}var indexCount=0;for(var i$1=0;i$1<total-1;i$1++){var index$1=i$1*2;indices[indexCount++]=index$1;indices[indexCount++]=index$1+1;indices[indexCount++]=index$1+2;indices[indexCount++]=index$1+2;indices[indexCount++]=index$1+1;indices[indexCount++]=index$1+3}uvBuffer.update();indexBuffer.update();this.updateVertices()};RopeGeometry.prototype.updateVertices=function updateVertices(){var points=this.points;if(points.length<1){return}var lastPoint=points[0];var nextPoint;var perpX=0;var perpY=0;var vertices=this.buffers[0].data;var total=points.length;for(var i=0;i<total;i++){var point=points[i];var index=i*4;if(i<points.length-1){nextPoint=points[i+1]}else{nextPoint=point}perpY=-(nextPoint.x-lastPoint.x);perpX=nextPoint.y-lastPoint.y;var perpLength=Math.sqrt(perpX*perpX+perpY*perpY);var num=this.width/2;perpX/=perpLength;perpY/=perpLength;perpX*=num;perpY*=num;vertices[index]=point.x+perpX;vertices[index+1]=point.y+perpY;vertices[index+2]=point.x-perpX;vertices[index+3]=point.y-perpY;lastPoint=point}this.buffers[0].update()};RopeGeometry.prototype.update=function update(){this.updateVertices()};return RopeGeometry}(mesh.MeshGeometry);var SimpleRope=function(Mesh){function SimpleRope(texture,points){var ropeGeometry=new RopeGeometry(texture.height,points);var meshMaterial=new mesh.MeshMaterial(texture);Mesh.call(this,ropeGeometry,meshMaterial);this.autoUpdate=true}if(Mesh)SimpleRope.__proto__=Mesh;SimpleRope.prototype=Object.create(Mesh&&Mesh.prototype);SimpleRope.prototype.constructor=SimpleRope;SimpleRope.prototype._render=function _render(renderer){if(this.autoUpdate||this.geometry.width!==this.shader.texture.height){this.geometry.width=this.shader.texture.height;this.geometry.update()}Mesh.prototype._render.call(this,renderer)};return SimpleRope}(mesh.Mesh);var SimplePlane=function(Mesh){function SimplePlane(texture,verticesX,verticesY){var planeGeometry=new PlaneGeometry(texture.width,texture.height,verticesX,verticesY);var meshMaterial=new mesh.MeshMaterial(core.Texture.WHITE);Mesh.call(this,planeGeometry,meshMaterial);this.texture=texture}if(Mesh)SimplePlane.__proto__=Mesh;SimplePlane.prototype=Object.create(Mesh&&Mesh.prototype);SimplePlane.prototype.constructor=SimplePlane;var prototypeAccessors={texture:{configurable:true}};SimplePlane.prototype.textureUpdated=function textureUpdated(){this._textureID=this.shader.texture._updateID;this.geometry.width=this.shader.texture.width;this.geometry.height=this.shader.texture.height;this.geometry.build()};prototypeAccessors.texture.set=function(value){if(this.shader.texture===value){return}this.shader.texture=value;this._textureID=-1;if(value.baseTexture.valid){this.textureUpdated()}else{value.once("update",this.textureUpdated,this)}};prototypeAccessors.texture.get=function(){return this.shader.texture};SimplePlane.prototype._render=function _render(renderer){if(this._textureID!==this.shader.texture._updateID){this.textureUpdated()}Mesh.prototype._render.call(this,renderer)};Object.defineProperties(SimplePlane.prototype,prototypeAccessors);return SimplePlane}(mesh.Mesh);var SimpleMesh=function(Mesh){function SimpleMesh(texture,vertices,uvs,indices,drawMode){if(texture===void 0)texture=core.Texture.EMPTY;var geometry=new mesh.MeshGeometry(vertices,uvs,indices);geometry.getBuffer("aVertexPosition").static=false;var meshMaterial=new mesh.MeshMaterial(texture);Mesh.call(this,geometry,meshMaterial,null,drawMode);this.autoUpdate=true}if(Mesh)SimpleMesh.__proto__=Mesh;SimpleMesh.prototype=Object.create(Mesh&&Mesh.prototype);SimpleMesh.prototype.constructor=SimpleMesh;var prototypeAccessors={vertices:{configurable:true}};prototypeAccessors.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data};prototypeAccessors.vertices.set=function(value){this.geometry.getBuffer("aVertexPosition").data=value};SimpleMesh.prototype._render=function _render(renderer){if(this.autoUpdate){this.geometry.getBuffer("aVertexPosition").update()}Mesh.prototype._render.call(this,renderer)};Object.defineProperties(SimpleMesh.prototype,prototypeAccessors);return SimpleMesh}(mesh.Mesh);var DEFAULT_BORDER_SIZE=10;var NineSlicePlane=function(SimplePlane){function NineSlicePlane(texture,leftWidth,topHeight,rightWidth,bottomHeight){SimplePlane.call(this,core.Texture.WHITE,4,4);this._origWidth=texture.orig.width;this._origHeight=texture.orig.height;this._width=this._origWidth;this._height=this._origHeight;this._leftWidth=typeof leftWidth!=="undefined"?leftWidth:DEFAULT_BORDER_SIZE;this._rightWidth=typeof rightWidth!=="undefined"?rightWidth:DEFAULT_BORDER_SIZE;this._topHeight=typeof topHeight!=="undefined"?topHeight:DEFAULT_BORDER_SIZE;this._bottomHeight=typeof bottomHeight!=="undefined"?bottomHeight:DEFAULT_BORDER_SIZE;this.texture=texture}if(SimplePlane)NineSlicePlane.__proto__=SimplePlane;NineSlicePlane.prototype=Object.create(SimplePlane&&SimplePlane.prototype);NineSlicePlane.prototype.constructor=NineSlicePlane;var prototypeAccessors={vertices:{configurable:true},width:{configurable:true},height:{configurable:true},leftWidth:{configurable:true},rightWidth:{configurable:true},topHeight:{configurable:true},bottomHeight:{configurable:true}};NineSlicePlane.prototype.textureUpdated=function textureUpdated(){this._textureID=this.shader.texture._updateID;this._refresh()};prototypeAccessors.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data};prototypeAccessors.vertices.set=function(value){this.geometry.getBuffer("aVertexPosition").data=value};NineSlicePlane.prototype.updateHorizontalVertices=function updateHorizontalVertices(){var vertices=this.vertices;var h=this._topHeight+this._bottomHeight;var scale=this._height>h?1:this._height/h;vertices[9]=vertices[11]=vertices[13]=vertices[15]=this._topHeight*scale;vertices[17]=vertices[19]=vertices[21]=vertices[23]=this._height-this._bottomHeight*scale;vertices[25]=vertices[27]=vertices[29]=vertices[31]=this._height};NineSlicePlane.prototype.updateVerticalVertices=function updateVerticalVertices(){var vertices=this.vertices;var w=this._leftWidth+this._rightWidth;var scale=this._width>w?1:this._width/w;vertices[2]=vertices[10]=vertices[18]=vertices[26]=this._leftWidth*scale;vertices[4]=vertices[12]=vertices[20]=vertices[28]=this._width-this._rightWidth*scale;vertices[6]=vertices[14]=vertices[22]=vertices[30]=this._width};prototypeAccessors.width.get=function(){return this._width};prototypeAccessors.width.set=function(value){this._width=value;this._refresh()};prototypeAccessors.height.get=function(){return this._height};prototypeAccessors.height.set=function(value){this._height=value;this._refresh()};prototypeAccessors.leftWidth.get=function(){return this._leftWidth};prototypeAccessors.leftWidth.set=function(value){this._leftWidth=value;this._refresh()};prototypeAccessors.rightWidth.get=function(){return this._rightWidth};prototypeAccessors.rightWidth.set=function(value){this._rightWidth=value;this._refresh()};prototypeAccessors.topHeight.get=function(){return this._topHeight};prototypeAccessors.topHeight.set=function(value){this._topHeight=value;this._refresh()};prototypeAccessors.bottomHeight.get=function(){return this._bottomHeight};prototypeAccessors.bottomHeight.set=function(value){this._bottomHeight=value;this._refresh()};NineSlicePlane.prototype._refresh=function _refresh(){var texture=this.texture;var uvs=this.geometry.buffers[1].data;this._origWidth=texture.orig.width;this._origHeight=texture.orig.height;var _uvw=1/this._origWidth;var _uvh=1/this._origHeight;uvs[0]=uvs[8]=uvs[16]=uvs[24]=0;uvs[1]=uvs[3]=uvs[5]=uvs[7]=0;uvs[6]=uvs[14]=uvs[22]=uvs[30]=1;uvs[25]=uvs[27]=uvs[29]=uvs[31]=1;uvs[2]=uvs[10]=uvs[18]=uvs[26]=_uvw*this._leftWidth;uvs[4]=uvs[12]=uvs[20]=uvs[28]=1-_uvw*this._rightWidth;uvs[9]=uvs[11]=uvs[13]=uvs[15]=_uvh*this._topHeight;uvs[17]=uvs[19]=uvs[21]=uvs[23]=1-_uvh*this._bottomHeight;this.updateHorizontalVertices();this.updateVerticalVertices();this.geometry.buffers[0].update();this.geometry.buffers[1].update()};Object.defineProperties(NineSlicePlane.prototype,prototypeAccessors);return NineSlicePlane}(SimplePlane);exports.NineSlicePlane=NineSlicePlane;exports.PlaneGeometry=PlaneGeometry;exports.RopeGeometry=RopeGeometry;exports.SimpleMesh=SimpleMesh;exports.SimplePlane=SimplePlane;exports.SimpleRope=SimpleRope},{"@pixi/core":16,"@pixi/mesh":30}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var math=require("@pixi/math");var constants=require("@pixi/constants");var display=require("@pixi/display");var settings=require("@pixi/settings");var utils=require("@pixi/utils");var MeshBatchUvs=function MeshBatchUvs(uvBuffer,uvMatrix){this.uvBuffer=uvBuffer;this.uvMatrix=uvMatrix;this.data=null;this._bufferUpdateId=-1;this._textureUpdateId=-1;this._updateID=0};MeshBatchUvs.prototype.update=function update(forceUpdate){if(!forceUpdate&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID){return}this._bufferUpdateId=this.uvBuffer._updateID;this._textureUpdateId=this.uvMatrix._updateID;var data=this.uvBuffer.data;if(!this.data||this.data.length!==data.length){this.data=new Float32Array(data.length)}this.uvMatrix.multiplyUvs(data,this.data);this._updateID++};var tempPoint=new math.Point;var tempPolygon=new math.Polygon;var Mesh=function(Container){function Mesh(geometry,shader,state,drawMode){if(drawMode===void 0)drawMode=constants.DRAW_MODES.TRIANGLES;Container.call(this);this.geometry=geometry;geometry.refCount++;this.shader=shader;this.state=state||core.State.for2d();this.drawMode=drawMode;this.start=0;this.size=0;this.uvs=null;this.indices=null;this.vertexData=new Float32Array(1);this.vertexDirty=0;this._transformID=-1;this.tint=16777215;this.blendMode=constants.BLEND_MODES.NORMAL;this._roundPixels=settings.settings.ROUND_PIXELS;this.batchUvs=null}if(Container)Mesh.__proto__=Container;Mesh.prototype=Object.create(Container&&Container.prototype);Mesh.prototype.constructor=Mesh;var prototypeAccessors={uvBuffer:{configurable:true},verticesBuffer:{configurable:true},material:{configurable:true},blendMode:{configurable:true},roundPixels:{configurable:true},tint:{configurable:true},texture:{configurable:true}};prototypeAccessors.uvBuffer.get=function(){return this.geometry.buffers[1]};prototypeAccessors.verticesBuffer.get=function(){return this.geometry.buffers[0]};prototypeAccessors.material.set=function(value){this.shader=value};prototypeAccessors.material.get=function(){return this.shader};prototypeAccessors.blendMode.set=function(value){this.state.blendMode=value};prototypeAccessors.blendMode.get=function(){return this.state.blendMode};prototypeAccessors.roundPixels.set=function(value){if(this._roundPixels!==value){this._transformID=-1}this._roundPixels=value};prototypeAccessors.roundPixels.get=function(){return this._roundPixels};prototypeAccessors.tint.get=function(){return this.shader.tint};prototypeAccessors.tint.set=function(value){this.shader.tint=value};prototypeAccessors.texture.get=function(){return this.shader.texture};prototypeAccessors.texture.set=function(value){this.shader.texture=value};Mesh.prototype._render=function _render(renderer){var vertices=this.geometry.buffers[0].data;if(this.shader.batchable&&this.drawMode===constants.DRAW_MODES.TRIANGLES&&vertices.length<Mesh.BATCHABLE_SIZE*2){this._renderToBatch(renderer)}else{this._renderDefault(renderer)}};Mesh.prototype._renderDefault=function _renderDefault(renderer){var shader=this.shader;shader.alpha=this.worldAlpha;if(shader.update){shader.update()}renderer.batch.flush();if(shader.program.uniformData.translationMatrix){shader.uniforms.translationMatrix=this.transform.worldTransform.toArray(true)}renderer.shader.bind(shader);renderer.state.setState(this.state);renderer.geometry.bind(this.geometry,shader);renderer.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)};Mesh.prototype._renderToBatch=function _renderToBatch(renderer){var geometry=this.geometry;if(this.shader.uvMatrix){this.shader.uvMatrix.update();this.calculateUvs()}this.calculateVertices();this.indices=geometry.indexBuffer.data;this._tintRGB=this.shader._tintRGB;this._texture=this.shader.texture;var pluginName=this.material.pluginName;renderer.batch.setObjectRenderer(renderer.plugins[pluginName]);renderer.plugins[pluginName].render(this)};Mesh.prototype.calculateVertices=function calculateVertices(){var geometry=this.geometry;var vertices=geometry.buffers[0].data;if(geometry.vertexDirtyId===this.vertexDirty&&this._transformID===this.transform._worldID){return}this._transformID=this.transform._worldID;if(this.vertexData.length!==vertices.length){this.vertexData=new Float32Array(vertices.length)}var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var vertexData=this.vertexData;for(var i=0;i<vertexData.length/2;i++){var x=vertices[i*2];var y=vertices[i*2+1];vertexData[i*2]=a*x+c*y+tx;vertexData[i*2+1]=b*x+d*y+ty}if(this._roundPixels){for(var i$1=0;i$1<vertexData.length;i$1++){vertexData[i$1]=Math.round(vertexData[i$1])}}this.vertexDirty=geometry.vertexDirtyId};Mesh.prototype.calculateUvs=function calculateUvs(){var geomUvs=this.geometry.buffers[1];if(!this.shader.uvMatrix.isSimple){if(!this.batchUvs){this.batchUvs=new MeshBatchUvs(geomUvs,this.shader.uvMatrix)}this.batchUvs.update();this.uvs=this.batchUvs.data}else{this.uvs=geomUvs.data}};Mesh.prototype._calculateBounds=function _calculateBounds(){this.calculateVertices();this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)};Mesh.prototype.containsPoint=function containsPoint(point){if(!this.getBounds().contains(point.x,point.y)){return false}this.worldTransform.applyInverse(point,tempPoint);var vertices=this.geometry.getBuffer("aVertexPosition").data;var points=tempPolygon.points;var indices=this.geometry.getIndex().data;var len=indices.length;var step=this.drawMode===4?3:1;for(var i=0;i+2<len;i+=step){var ind0=indices[i]*2;var ind1=indices[i+1]*2;var ind2=indices[i+2]*2;points[0]=vertices[ind0];points[1]=vertices[ind0+1];points[2]=vertices[ind1];points[3]=vertices[ind1+1];points[4]=vertices[ind2];points[5]=vertices[ind2+1];if(tempPolygon.contains(tempPoint.x,tempPoint.y)){return true}}return false};Mesh.prototype.destroy=function destroy(options){Container.prototype.destroy.call(this,options);this.geometry.refCount--;if(this.geometry.refCount===0){this.geometry.dispose()}this.geometry=null;this.shader=null;this.state=null;this.uvs=null;this.indices=null;this.vertexData=null};Object.defineProperties(Mesh.prototype,prototypeAccessors);return Mesh}(display.Container);Mesh.BATCHABLE_SIZE=100;var vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n";var fragment="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n";var MeshMaterial=function(Shader){function MeshMaterial(uSampler,options){var uniforms={uSampler:uSampler,alpha:1,uTextureMatrix:math.Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};options=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},options);if(options.uniforms){Object.assign(uniforms,options.uniforms)}Shader.call(this,options.program||core.Program.from(vertex,fragment),uniforms);this._colorDirty=false;this.uvMatrix=new core.TextureMatrix(uSampler);this.batchable=options.program===undefined;this.pluginName=options.pluginName;this.tint=options.tint;this.alpha=options.alpha}if(Shader)MeshMaterial.__proto__=Shader;MeshMaterial.prototype=Object.create(Shader&&Shader.prototype);MeshMaterial.prototype.constructor=MeshMaterial;var prototypeAccessors={texture:{configurable:true},alpha:{configurable:true},tint:{configurable:true}};prototypeAccessors.texture.get=function(){return this.uniforms.uSampler};prototypeAccessors.texture.set=function(value){if(this.uniforms.uSampler!==value){this.uniforms.uSampler=value;this.uvMatrix.texture=value}};prototypeAccessors.alpha.set=function(value){if(value===this._alpha){return}this._alpha=value;this._colorDirty=true};prototypeAccessors.alpha.get=function(){return this._alpha};prototypeAccessors.tint.set=function(value){if(value===this._tint){return}this._tint=value;this._tintRGB=(value>>16)+(value&65280)+((value&255)<<16);this._colorDirty=true};prototypeAccessors.tint.get=function(){return this._tint};MeshMaterial.prototype.update=function update(){if(this._colorDirty){this._colorDirty=false;var baseTexture=this.texture.baseTexture;utils.premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,baseTexture.premultiplyAlpha)}if(this.uvMatrix.update()){this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord}};Object.defineProperties(MeshMaterial.prototype,prototypeAccessors);return MeshMaterial}(core.Shader);var MeshGeometry=function(Geometry){function MeshGeometry(vertices,uvs,index){Geometry.call(this);var verticesBuffer=new core.Buffer(vertices);var uvsBuffer=new core.Buffer(uvs,true);var indexBuffer=new core.Buffer(index,true,true);this.addAttribute("aVertexPosition",verticesBuffer,2,false,constants.TYPES.FLOAT).addAttribute("aTextureCoord",uvsBuffer,2,false,constants.TYPES.FLOAT).addIndex(indexBuffer);this._updateId=-1}if(Geometry)MeshGeometry.__proto__=Geometry;MeshGeometry.prototype=Object.create(Geometry&&Geometry.prototype);MeshGeometry.prototype.constructor=MeshGeometry;var prototypeAccessors={vertexDirtyId:{configurable:true}};prototypeAccessors.vertexDirtyId.get=function(){return this.buffers[0]._updateID};Object.defineProperties(MeshGeometry.prototype,prototypeAccessors);return MeshGeometry}(core.Geometry);exports.Mesh=Mesh;exports.MeshBatchUvs=MeshBatchUvs;exports.MeshGeometry=MeshGeometry;exports.MeshMaterial=MeshMaterial},{"@pixi/constants":15,"@pixi/core":16,"@pixi/display":17,"@pixi/math":28,"@pixi/settings":38,"@pixi/utils":46}],31:[function(require,module,exports){"use strict";var core=require("@pixi/core");var sprite=require("@pixi/sprite");var display=require("@pixi/display");var math=require("@pixi/math");var utils=require("@pixi/utils");var settings=require("@pixi/settings");var _tempMatrix=new math.Matrix;display.DisplayObject.prototype._cacheAsBitmap=false;display.DisplayObject.prototype._cacheData=false;var CacheData=function CacheData(){this.textureCacheId=null;this.originalRender=null;this.originalRenderCanvas=null;this.originalCalculateBounds=null;this.originalGetLocalBounds=null;this.originalUpdateTransform=null;this.originalHitTest=null;this.originalDestroy=null;this.originalMask=null;this.originalFilterArea=null;this.sprite=null};Object.defineProperties(display.DisplayObject.prototype,{cacheAsBitmap:{get:function get(){return this._cacheAsBitmap},set:function set(value){if(this._cacheAsBitmap===value){return}this._cacheAsBitmap=value;var data;if(value){if(!this._cacheData){this._cacheData=new CacheData}data=this._cacheData;data.originalRender=this.render;data.originalRenderCanvas=this.renderCanvas;data.originalUpdateTransform=this.updateTransform;data.originalCalculateBounds=this.calculateBounds;data.originalGetLocalBounds=this.getLocalBounds;data.originalDestroy=this.destroy;data.originalContainsPoint=this.containsPoint;data.originalMask=this._mask;data.originalFilterArea=this.filterArea;this.render=this._renderCached;this.renderCanvas=this._renderCachedCanvas;this.destroy=this._cacheAsBitmapDestroy}else{data=this._cacheData;if(data.sprite){this._destroyCachedDisplayObject()}this.render=data.originalRender;this.renderCanvas=data.originalRenderCanvas;this.calculateBounds=data.originalCalculateBounds;this.getLocalBounds=data.originalGetLocalBounds;this.destroy=data.originalDestroy;this.updateTransform=data.originalUpdateTransform;this.containsPoint=data.originalContainsPoint;this._mask=data.originalMask;this.filterArea=data.originalFilterArea}}}});display.DisplayObject.prototype._renderCached=function _renderCached(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}this._initCachedDisplayObject(renderer);this._cacheData.sprite.transform._worldID=this.transform._worldID;this._cacheData.sprite.worldAlpha=this.worldAlpha;this._cacheData.sprite._render(renderer)};display.DisplayObject.prototype._initCachedDisplayObject=function _initCachedDisplayObject(renderer){if(this._cacheData&&this._cacheData.sprite){return}var cacheAlpha=this.alpha;this.alpha=1;renderer.batch.flush();var bounds=this.getLocalBounds().clone();if(this.filters){var padding=this.filters[0].padding;bounds.pad(padding)}bounds.ceil(settings.settings.RESOLUTION);var cachedRenderTarget=renderer._activeRenderTarget;var renderTexture=core.RenderTexture.create(bounds.width,bounds.height);var textureCacheId="cacheAsBitmap_"+utils.uid();this._cacheData.textureCacheId=textureCacheId;core.BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId);core.Texture.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;m.tx=-bounds.x;m.ty=-bounds.y;this.transform.worldTransform.identity();this.render=this._cacheData.originalRender;renderer.render(this,renderTexture,true,m,true);renderer.renderTexture.bind(cachedRenderTarget);this.render=this._renderCached;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this._mask=null;this.filterArea=null;var cachedSprite=new sprite.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform;cachedSprite.anchor.x=-(bounds.x/bounds.width);cachedSprite.anchor.y=-(bounds.y/bounds.height);cachedSprite.alpha=cacheAlpha;cachedSprite._bounds=this._bounds;this._cacheData.sprite=cachedSprite;this.transform._parentID=-1;if(!this.parent){this.parent=renderer._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this.updateTransform()}this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)};display.DisplayObject.prototype._renderCachedCanvas=function _renderCachedCanvas(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}this._initCachedDisplayObjectCanvas(renderer);this._cacheData.sprite.worldAlpha=this.worldAlpha;this._cacheData.sprite._renderCanvas(renderer)};display.DisplayObject.prototype._initCachedDisplayObjectCanvas=function _initCachedDisplayObjectCanvas(renderer){if(this._cacheData&&this._cacheData.sprite){return}var bounds=this.getLocalBounds();var cacheAlpha=this.alpha;this.alpha=1;var cachedRenderTarget=renderer.context;bounds.ceil(settings.settings.RESOLUTION);var renderTexture=core.RenderTexture.create(bounds.width,bounds.height);var textureCacheId="cacheAsBitmap_"+utils.uid();this._cacheData.textureCacheId=textureCacheId;core.BaseTexture.addToCache(renderTexture.baseTexture,textureCacheId);core.Texture.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;this.transform.localTransform.copyTo(m);m.invert();m.tx-=bounds.x;m.ty-=bounds.y;this.renderCanvas=this._cacheData.originalRenderCanvas;renderer.render(this,renderTexture,true,m,false);renderer.context=cachedRenderTarget;this.renderCanvas=this._renderCachedCanvas;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this._mask=null;this.filterArea=null;var cachedSprite=new sprite.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform;cachedSprite.anchor.x=-(bounds.x/bounds.width);cachedSprite.anchor.y=-(bounds.y/bounds.height);cachedSprite.alpha=cacheAlpha;cachedSprite._bounds=this._bounds;this._cacheData.sprite=cachedSprite;this.transform._parentID=-1;if(!this.parent){this.parent=renderer._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this.updateTransform()}this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)};display.DisplayObject.prototype._calculateCachedBounds=function _calculateCachedBounds(){this._bounds.clear();this._cacheData.sprite.transform._worldID=this.transform._worldID;this._cacheData.sprite._calculateBounds();this._lastBoundsID=this._boundsID};display.DisplayObject.prototype._getCachedLocalBounds=function _getCachedLocalBounds(){return this._cacheData.sprite.getLocalBounds()};display.DisplayObject.prototype._destroyCachedDisplayObject=function _destroyCachedDisplayObject(){this._cacheData.sprite._texture.destroy(true);this._cacheData.sprite=null;core.BaseTexture.removeFromCache(this._cacheData.textureCacheId);core.Texture.removeFromCache(this._cacheData.textureCacheId);this._cacheData.textureCacheId=null};display.DisplayObject.prototype._cacheAsBitmapDestroy=function _cacheAsBitmapDestroy(options){this.cacheAsBitmap=false;this.destroy(options)}},{"@pixi/core":16,"@pixi/display":17,"@pixi/math":28,"@pixi/settings":38,"@pixi/sprite":41,"@pixi/utils":46}],32:[function(require,module,exports){"use strict";var display=require("@pixi/display");display.DisplayObject.prototype.name=null;display.Container.prototype.getChildByName=function getChildByName(name){for(var i=0;i<this.children.length;i++){if(this.children[i].name===name){return this.children[i]}}return null}},{"@pixi/display":17}],33:[function(require,module,exports){"use strict";var display=require("@pixi/display");var math=require("@pixi/math");display.DisplayObject.prototype.getGlobalPosition=function getGlobalPosition(point,skipUpdate){if(point===void 0)point=new math.Point;if(skipUpdate===void 0)skipUpdate=false;if(this.parent){this.parent.toGlobal(this.position,point,skipUpdate)}else{point.x=this.position.x;point.y=this.position.y}return point}},{"@pixi/display":17,"@pixi/math":28}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var constants=require("@pixi/constants");var utils=require("@pixi/utils");var display=require("@pixi/display");var core=require("@pixi/core");var math=require("@pixi/math");var ParticleContainer=function(Container){function ParticleContainer(maxSize,properties,batchSize,autoResize){if(maxSize===void 0)maxSize=1500;if(batchSize===void 0)batchSize=16384;if(autoResize===void 0)autoResize=false;Container.call(this);var maxBatchSize=16384;if(batchSize>maxBatchSize){batchSize=maxBatchSize}this._properties=[false,true,false,false,false];this._maxSize=maxSize;this._batchSize=batchSize;this._buffers=null;this._bufferUpdateIDs=[];this._updateID=0;this.interactiveChildren=false;this.blendMode=constants.BLEND_MODES.NORMAL;this.autoResize=autoResize;this.roundPixels=true;this.baseTexture=null;this.setProperties(properties);this._tint=0;this.tintRgb=new Float32Array(4);this.tint=16777215}if(Container)ParticleContainer.__proto__=Container;ParticleContainer.prototype=Object.create(Container&&Container.prototype);ParticleContainer.prototype.constructor=ParticleContainer;var prototypeAccessors={tint:{configurable:true}};ParticleContainer.prototype.setProperties=function setProperties(properties){if(properties){this._properties[0]="vertices"in properties||"scale"in properties?!!properties.vertices||!!properties.scale:this._properties[0];this._properties[1]="position"in properties?!!properties.position:this._properties[1];this._properties[2]="rotation"in properties?!!properties.rotation:this._properties[2];this._properties[3]="uvs"in properties?!!properties.uvs:this._properties[3];this._properties[4]="tint"in properties||"alpha"in properties?!!properties.tint||!!properties.alpha:this._properties[4]}};ParticleContainer.prototype.updateTransform=function updateTransform(){this.displayObjectUpdateTransform()};prototypeAccessors.tint.get=function(){return this._tint};prototypeAccessors.tint.set=function(value){this._tint=value;utils.hex2rgb(value,this.tintRgb)};ParticleContainer.prototype.render=function render(renderer){var this$1=this;if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable){return}if(!this.baseTexture){this.baseTexture=this.children[0]._texture.baseTexture;if(!this.baseTexture.valid){this.baseTexture.once("update",function(){return this$1.onChildrenChange(0)})}}renderer.batch.setObjectRenderer(renderer.plugins.particle);renderer.plugins.particle.render(this)};ParticleContainer.prototype.onChildrenChange=function onChildrenChange(smallestChildIndex){var bufferIndex=Math.floor(smallestChildIndex/this._batchSize);while(this._bufferUpdateIDs.length<bufferIndex){this._bufferUpdateIDs.push(0)}this._bufferUpdateIDs[bufferIndex]=++this._updateID};ParticleContainer.prototype.dispose=function dispose(){if(this._buffers){for(var i=0;i<this._buffers.length;++i){this._buffers[i].destroy()}this._buffers=null}};ParticleContainer.prototype.destroy=function destroy(options){Container.prototype.destroy.call(this,options);this.dispose();this._properties=null;this._buffers=null;this._bufferUpdateIDs=null};Object.defineProperties(ParticleContainer.prototype,prototypeAccessors);return ParticleContainer}(display.Container);var ParticleBuffer=function ParticleBuffer(properties,dynamicPropertyFlags,size){this.geometry=new core.Geometry;this.indexBuffer=null;this.size=size;this.dynamicProperties=[];this.staticProperties=[];for(var i=0;i<properties.length;++i){var property=properties[i];property={attributeName:property.attributeName,size:property.size,uploadFunction:property.uploadFunction,type:property.type||constants.TYPES.FLOAT,offset:property.offset};if(dynamicPropertyFlags[i]){this.dynamicProperties.push(property)}else{this.staticProperties.push(property)}}this.staticStride=0;this.staticBuffer=null;this.staticData=null;this.staticDataUint32=null;this.dynamicStride=0;this.dynamicBuffer=null;this.dynamicData=null;this.dynamicDataUint32=null;this._updateID=0;this.initBuffers()};ParticleBuffer.prototype.initBuffers=function initBuffers(){var geometry=this.geometry;var dynamicOffset=0;this.indexBuffer=new core.Buffer(utils.createIndicesForQuads(this.size),true,true);geometry.addIndex(this.indexBuffer);this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var property=this.dynamicProperties[i];property.offset=dynamicOffset;dynamicOffset+=property.size;this.dynamicStride+=property.size}var dynBuffer=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(dynBuffer);this.dynamicDataUint32=new Uint32Array(dynBuffer);this.dynamicBuffer=new core.Buffer(this.dynamicData,false,false);var staticOffset=0;this.staticStride=0;for(var i$1=0;i$1<this.staticProperties.length;++i$1){var property$1=this.staticProperties[i$1];property$1.offset=staticOffset;staticOffset+=property$1.size;this.staticStride+=property$1.size}var statBuffer=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(statBuffer);this.staticDataUint32=new Uint32Array(statBuffer);this.staticBuffer=new core.Buffer(this.staticData,true,false);for(var i$2=0;i$2<this.dynamicProperties.length;++i$2){var property$2=this.dynamicProperties[i$2];geometry.addAttribute(property$2.attributeName,this.dynamicBuffer,0,property$2.type===constants.TYPES.UNSIGNED_BYTE,property$2.type,this.dynamicStride*4,property$2.offset*4)}for(var i$3=0;i$3<this.staticProperties.length;++i$3){var property$3=this.staticProperties[i$3];geometry.addAttribute(property$3.attributeName,this.staticBuffer,0,property$3.type===constants.TYPES.UNSIGNED_BYTE,property$3.type,this.staticStride*4,property$3.offset*4)}};ParticleBuffer.prototype.uploadDynamic=function uploadDynamic(children,startIndex,amount){for(var i=0;i<this.dynamicProperties.length;i++){var property=this.dynamicProperties[i];property.uploadFunction(children,startIndex,amount,property.type===constants.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,property.offset)}this.dynamicBuffer._updateID++};ParticleBuffer.prototype.uploadStatic=function uploadStatic(children,startIndex,amount){for(var i=0;i<this.staticProperties.length;i++){var property=this.staticProperties[i];property.uploadFunction(children,startIndex,amount,property.type===constants.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,property.offset)}this.staticBuffer._updateID++};ParticleBuffer.prototype.destroy=function destroy(){this.indexBuffer=null;this.dynamicProperties=null;this.dynamicBuffer=null;this.dynamicData=null;this.dynamicDataUint32=null;this.staticProperties=null;this.staticBuffer=null;this.staticData=null;this.staticDataUint32=null;this.geometry.destroy()};var vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n";var fragment="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}";var ParticleRenderer=function(ObjectRenderer){function ParticleRenderer(renderer){ObjectRenderer.call(this,renderer);this.shader=null;this.properties=null;this.tempMatrix=new math.Matrix;this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:constants.TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}];this.shader=core.Shader.from(vertex,fragment,{})}if(ObjectRenderer)ParticleRenderer.__proto__=ObjectRenderer;ParticleRenderer.prototype=Object.create(ObjectRenderer&&ObjectRenderer.prototype);ParticleRenderer.prototype.constructor=ParticleRenderer;ParticleRenderer.prototype.render=function render(container){var children=container.children;var maxSize=container._maxSize;var batchSize=container._batchSize;var renderer=this.renderer;var totalChildren=children.length;if(totalChildren===0){return}else if(totalChildren>maxSize&&!container.autoResize){totalChildren=maxSize}var buffers=container._buffers;if(!buffers){buffers=container._buffers=this.generateBuffers(container)}var baseTexture=children[0]._texture.baseTexture;this.renderer.state.setBlendMode(utils.correctBlendMode(container.blendMode,baseTexture.premultiplyAlpha));var gl=renderer.gl;var m=container.worldTransform.copyTo(this.tempMatrix);m.prepend(renderer.globalUniforms.uniforms.projectionMatrix);this.shader.uniforms.translationMatrix=m.toArray(true);this.shader.uniforms.uColor=utils.premultiplyRgba(container.tintRgb,container.worldAlpha,this.shader.uniforms.uColor,baseTexture.premultiplyAlpha);this.shader.uniforms.uSampler=baseTexture;this.renderer.shader.bind(this.shader);var updateStatic=false;for(var i=0,j=0;i<totalChildren;i+=batchSize,j+=1){var amount=totalChildren-i;if(amount>batchSize){amount=batchSize}if(j>=buffers.length){buffers.push(this._generateOneMoreBuffer(container))}var buffer=buffers[j];buffer.uploadDynamic(children,i,amount);var bid=container._bufferUpdateIDs[j]||0;updateStatic=updateStatic||buffer._updateID<bid;if(updateStatic){buffer._updateID=container._updateID;buffer.uploadStatic(children,i,amount)}renderer.geometry.bind(buffer.geometry);gl.drawElements(gl.TRIANGLES,amount*6,gl.UNSIGNED_SHORT,0)}};ParticleRenderer.prototype.generateBuffers=function generateBuffers(container){var buffers=[];var size=container._maxSize;var batchSize=container._batchSize;var dynamicPropertyFlags=container._properties;for(var i=0;i<size;i+=batchSize){buffers.push(new ParticleBuffer(this.properties,dynamicPropertyFlags,batchSize))}return buffers};ParticleRenderer.prototype._generateOneMoreBuffer=function _generateOneMoreBuffer(container){var batchSize=container._batchSize;var dynamicPropertyFlags=container._properties;return new ParticleBuffer(this.properties,dynamicPropertyFlags,batchSize)};ParticleRenderer.prototype.uploadVertices=function uploadVertices(children,startIndex,amount,array,stride,offset){var w0=0;var w1=0;var h0=0;var h1=0;for(var i=0;i<amount;++i){var sprite=children[startIndex+i];var texture=sprite._texture;var sx=sprite.scale.x;var sy=sprite.scale.y;var trim=texture.trim;var orig=texture.orig;if(trim){w1=trim.x-sprite.anchor.x*orig.width;w0=w1+trim.width;h1=trim.y-sprite.anchor.y*orig.height;h0=h1+trim.height}else{w0=orig.width*(1-sprite.anchor.x);w1=orig.width*-sprite.anchor.x;h0=orig.height*(1-sprite.anchor.y);h1=orig.height*-sprite.anchor.y}array[offset]=w1*sx;array[offset+1]=h1*sy;array[offset+stride]=w0*sx;array[offset+stride+1]=h1*sy;array[offset+stride*2]=w0*sx;array[offset+stride*2+1]=h0*sy;array[offset+stride*3]=w1*sx;array[offset+stride*3+1]=h0*sy;offset+=stride*4}};ParticleRenderer.prototype.uploadPosition=function uploadPosition(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spritePosition=children[startIndex+i].position;array[offset]=spritePosition.x;array[offset+1]=spritePosition.y;array[offset+stride]=spritePosition.x;array[offset+stride+1]=spritePosition.y;array[offset+stride*2]=spritePosition.x;array[offset+stride*2+1]=spritePosition.y;array[offset+stride*3]=spritePosition.x;array[offset+stride*3+1]=spritePosition.y;offset+=stride*4}};ParticleRenderer.prototype.uploadRotation=function uploadRotation(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spriteRotation=children[startIndex+i].rotation;array[offset]=spriteRotation;array[offset+stride]=spriteRotation;array[offset+stride*2]=spriteRotation;array[offset+stride*3]=spriteRotation;offset+=stride*4}};ParticleRenderer.prototype.uploadUvs=function uploadUvs(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var textureUvs=children[startIndex+i]._texture._uvs;if(textureUvs){array[offset]=textureUvs.x0;array[offset+1]=textureUvs.y0;array[offset+stride]=textureUvs.x1;array[offset+stride+1]=textureUvs.y1;array[offset+stride*2]=textureUvs.x2;array[offset+stride*2+1]=textureUvs.y2;array[offset+stride*3]=textureUvs.x3;array[offset+stride*3+1]=textureUvs.y3;offset+=stride*4}else{array[offset]=0;array[offset+1]=0;array[offset+stride]=0;array[offset+stride+1]=0;array[offset+stride*2]=0;array[offset+stride*2+1]=0;array[offset+stride*3]=0;array[offset+stride*3+1]=0;offset+=stride*4}}};ParticleRenderer.prototype.uploadTint=function uploadTint(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var sprite=children[startIndex+i];var premultiplied=sprite._texture.baseTexture.premultiplyAlpha;var alpha=sprite.alpha;var argb=alpha<1&&premultiplied?utils.premultiplyTint(sprite._tintRGB,alpha):sprite._tintRGB+(alpha*255<<24);array[offset]=argb;array[offset+stride]=argb;array[offset+stride*2]=argb;array[offset+stride*3]=argb;offset+=stride*4}};ParticleRenderer.prototype.destroy=function destroy(){ObjectRenderer.prototype.destroy.call(this);if(this.shader){this.shader.destroy();this.shader=null}this.tempMatrix=null};return ParticleRenderer}(core.ObjectRenderer);exports.ParticleContainer=ParticleContainer;exports.ParticleRenderer=ParticleRenderer},{"@pixi/constants":15,"@pixi/core":16,"@pixi/display":17,"@pixi/math":28,"@pixi/utils":46}],35:[function(require,module,exports){(function(global){"use strict";function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var es6PromisePolyfill=require("es6-promise-polyfill");var objectAssign=_interopDefault(require("object-assign"));if(!window.Promise){window.Promise=es6PromisePolyfill.Polyfill}if(!Object.assign){Object.assign=objectAssign}var commonjsGlobal=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};var ONE_FRAME_TIME=16;if(!(Date.now&&Date.prototype.getTime)){Date.now=function now(){return(new Date).getTime()}}if(!(commonjsGlobal.performance&&commonjsGlobal.performance.now)){var startTime=Date.now();if(!commonjsGlobal.performance){commonjsGlobal.performance={}}commonjsGlobal.performance.now=function(){return Date.now()-startTime}}var lastTime=Date.now();var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!commonjsGlobal.requestAnimationFrame;++x){var p=vendors[x];commonjsGlobal.requestAnimationFrame=commonjsGlobal[p+"RequestAnimationFrame"];commonjsGlobal.cancelAnimationFrame=commonjsGlobal[p+"CancelAnimationFrame"]||commonjsGlobal[p+"CancelRequestAnimationFrame"]}if(!commonjsGlobal.requestAnimationFrame){commonjsGlobal.requestAnimationFrame=function(callback){if(typeof callback!=="function"){throw new TypeError(callback+"is not a function")}var currentTime=Date.now();var delay=ONE_FRAME_TIME+lastTime-currentTime;if(delay<0){delay=0}lastTime=currentTime;return setTimeout(function(){lastTime=Date.now();callback(performance.now())},delay)}}if(!commonjsGlobal.cancelAnimationFrame){commonjsGlobal.cancelAnimationFrame=function(id){return clearTimeout(id)}}if(!Math.sign){Math.sign=function mathSign(x){x=Number(x);if(x===0||isNaN(x)){return x}return x>0?1:-1}}if(!Number.isInteger){Number.isInteger=function numberIsInteger(value){return typeof value==="number"&&isFinite(value)&&Math.floor(value)===value}}if(!window.ArrayBuffer){window.ArrayBuffer=Array}if(!window.Float32Array){window.Float32Array=Array}if(!window.Uint32Array){window.Uint32Array=Array}if(!window.Uint16Array){window.Uint16Array=Array}if(!window.Uint8Array){window.Uint8Array=Array}if(!window.Int32Array){window.Int32Array=Array}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"es6-promise-polyfill":70,"object-assign":79}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var settings=require("@pixi/settings");var core=require("@pixi/core");var graphics=require("@pixi/graphics");var ticker=require("@pixi/ticker");var display=require("@pixi/display");var text=require("@pixi/text");settings.settings.UPLOADS_PER_FRAME=4;var CountLimiter=function CountLimiter(maxItemsPerFrame){this.maxItemsPerFrame=maxItemsPerFrame;this.itemsLeft=0};CountLimiter.prototype.beginFrame=function beginFrame(){this.itemsLeft=this.maxItemsPerFrame};CountLimiter.prototype.allowedToUpload=function allowedToUpload(){return this.itemsLeft-- >0};var BasePrepare=function BasePrepare(renderer){var this$1=this;this.limiter=new CountLimiter(settings.settings.UPLOADS_PER_FRAME);this.renderer=renderer;this.uploadHookHelper=null;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=false;this.delayedTick=function(){if(!this$1.queue){return}this$1.prepareItems()};this.registerFindHook(findText);this.registerFindHook(findTextStyle);this.registerFindHook(findMultipleBaseTextures);this.registerFindHook(findBaseTexture);this.registerFindHook(findTexture);this.registerUploadHook(drawText);this.registerUploadHook(calculateTextStyle)};BasePrepare.prototype.upload=function upload(item,done){if(typeof item==="function"){done=item;item=null}if(item){this.add(item)}if(this.queue.length){if(done){this.completes.push(done)}if(!this.ticking){this.ticking=true;ticker.Ticker.system.addOnce(this.tick,this,ticker.UPDATE_PRIORITY.UTILITY)}}else if(done){done()}};BasePrepare.prototype.tick=function tick(){setTimeout(this.delayedTick,0)};BasePrepare.prototype.prepareItems=function prepareItems(){this.limiter.beginFrame();while(this.queue.length&&this.limiter.allowedToUpload()){var item=this.queue[0];var uploaded=false;if(item&&!item._destroyed){for(var i=0,len=this.uploadHooks.length;i<len;i++){if(this.uploadHooks[i](this.uploadHookHelper,item)){this.queue.shift();uploaded=true;break}}}if(!uploaded){this.queue.shift()}}if(!this.queue.length){this.ticking=false;var completes=this.completes.slice(0);this.completes.length=0;for(var i$1=0,len$1=completes.length;i$1<len$1;i$1++){completes[i$1]()}}else{ticker.Ticker.system.addOnce(this.tick,this,ticker.UPDATE_PRIORITY.UTILITY)}};BasePrepare.prototype.registerFindHook=function registerFindHook(addHook){if(addHook){this.addHooks.push(addHook)}return this};BasePrepare.prototype.registerUploadHook=function registerUploadHook(uploadHook){if(uploadHook){this.uploadHooks.push(uploadHook)}return this};BasePrepare.prototype.add=function add(item){for(var i=0,len=this.addHooks.length;i<len;i++){if(this.addHooks[i](item,this.queue)){break}}if(item instanceof display.Container){for(var i$1=item.children.length-1;i$1>=0;i$1--){this.add(item.children[i$1])}}return this};BasePrepare.prototype.destroy=function destroy(){if(this.ticking){ticker.Ticker.system.remove(this.tick,this)}this.ticking=false;this.addHooks=null;this.uploadHooks=null;this.renderer=null;this.completes=null;this.queue=null;this.limiter=null;this.uploadHookHelper=null};function findMultipleBaseTextures(item,queue){var result=false;if(item&&item._textures&&item._textures.length){for(var i=0;i<item._textures.length;i++){if(item._textures[i]instanceof core.Texture){var baseTexture=item._textures[i].baseTexture;if(queue.indexOf(baseTexture)===-1){queue.push(baseTexture);result=true}}}}return result}function findBaseTexture(item,queue){if(item instanceof core.BaseTexture){if(queue.indexOf(item)===-1){queue.push(item)}return true}return false}function findTexture(item,queue){if(item._texture&&item._texture instanceof core.Texture){var texture=item._texture.baseTexture;if(queue.indexOf(texture)===-1){queue.push(texture)}return true}return false}function drawText(helper,item){if(item instanceof text.Text){item.updateText(true);return true}return false}function calculateTextStyle(helper,item){if(item instanceof text.TextStyle){var font=item.toFontString();text.TextMetrics.measureFont(font);return true}return false}function findText(item,queue){if(item instanceof text.Text){if(queue.indexOf(item.style)===-1){queue.push(item.style)}if(queue.indexOf(item)===-1){queue.push(item)}var texture=item._texture.baseTexture;if(queue.indexOf(texture)===-1){queue.push(texture)}return true}return false}function findTextStyle(item,queue){if(item instanceof text.TextStyle){if(queue.indexOf(item)===-1){queue.push(item)}return true}return false}var Prepare=function(BasePrepare){function Prepare(renderer){BasePrepare.call(this,renderer);this.uploadHookHelper=this.renderer;this.registerFindHook(findGraphics);this.registerUploadHook(uploadBaseTextures);this.registerUploadHook(uploadGraphics)}if(BasePrepare)Prepare.__proto__=BasePrepare;Prepare.prototype=Object.create(BasePrepare&&BasePrepare.prototype);Prepare.prototype.constructor=Prepare;return Prepare}(BasePrepare);function uploadBaseTextures(renderer,item){if(item instanceof core.BaseTexture){if(!item._glTextures[renderer.CONTEXT_UID]){renderer.textureManager.updateTexture(item)}return true}return false}function uploadGraphics(renderer,item){if(item instanceof graphics.Graphics){if(item.dirty||item.clearDirty||!item._webGL[renderer.plugins.graphics.CONTEXT_UID]){renderer.plugins.graphics.updateGraphics(item)}return true}return false}function findGraphics(item,queue){if(item instanceof graphics.Graphics){queue.push(item);return true}return false}var TimeLimiter=function TimeLimiter(maxMilliseconds){this.maxMilliseconds=maxMilliseconds;this.frameStart=0};TimeLimiter.prototype.beginFrame=function beginFrame(){this.frameStart=Date.now()};TimeLimiter.prototype.allowedToUpload=function allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds};exports.BasePrepare=BasePrepare;exports.CountLimiter=CountLimiter;exports.Prepare=Prepare;exports.TimeLimiter=TimeLimiter},{"@pixi/core":16,"@pixi/display":17,"@pixi/graphics":25,"@pixi/settings":38,"@pixi/text":44,"@pixi/ticker":45}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Runner=function Runner(name){this.items=[];this._name=name};var prototypeAccessors={empty:{configurable:true},name:{configurable:true}};Runner.prototype.emit=function emit(a0,a1,a2,a3,a4,a5,a6,a7){if(arguments.length>8){throw new Error("max arguments reached")}var ref=this;var name=ref.name;var items=ref.items;for(var i=0,len=items.length;i<len;i++){items[i][name](a0,a1,a2,a3,a4,a5,a6,a7)}return this};Runner.prototype.add=function add(item){if(item[this._name]){this.remove(item);this.items.push(item)}return this};Runner.prototype.remove=function remove(item){var index=this.items.indexOf(item);if(index!==-1){this.items.splice(index,1)}return this};Runner.prototype.contains=function contains(item){return this.items.indexOf(item)!==-1};Runner.prototype.removeAll=function removeAll(){this.items.length=0;return this};Runner.prototype.destroy=function destroy(){this.removeAll();this.items=null;this._name=null};prototypeAccessors.empty.get=function(){return this.items.length===0};prototypeAccessors.name.get=function(){return this._name};Object.defineProperties(Runner.prototype,prototypeAccessors);Runner.prototype.dispatch=Runner.prototype.emit;Runner.prototype.run=Runner.prototype.emit;exports.Runner=Runner},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var isMobile=_interopDefault(require("ismobilejs"));function maxRecommendedTextures(max){var allowMax=true;if(isMobile.tablet||isMobile.phone){allowMax=false;if(isMobile.apple.device){var match=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(match){var majorVersion=parseInt(match[1],10);if(majorVersion>=11){allowMax=true}}}if(isMobile.android.device){var match$1=navigator.userAgent.match(/Android\s([0-9.]*)/);if(match$1){var majorVersion$1=parseInt(match$1[1],10);if(majorVersion$1>=7){allowMax=true}}}}return allowMax?max:4}function canUploadSameBuffer(){return!isMobile.apple.device}var settings={MIPMAP_TEXTURES:1,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:maxRecommendedTextures(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:false,forceFXAA:false,autoDensity:false,transparent:false,backgroundColor:0,clearBeforeRender:true,preserveDrawingBuffer:false,width:800,height:600,legacy:false},GC_MODE:0,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:isMobile.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:canUploadSameBuffer(),CREATE_IMAGE_BITMAP:false,ROUND_PIXELS:false};exports.isMobile=isMobile;exports.settings=settings},{ismobilejs:76}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var sprite=require("@pixi/sprite");var ticker=require("@pixi/ticker");var AnimatedSprite=function(Sprite){function AnimatedSprite(textures,autoUpdate){Sprite.call(this,textures[0]instanceof core.Texture?textures[0]:textures[0].texture);this._textures=null;this._durations=null;this.textures=textures;this._autoUpdate=autoUpdate!==false;this.animationSpeed=1;this.loop=true;this.updateAnchor=false;this.onComplete=null;this.onFrameChange=null;this.onLoop=null;this._currentTime=0;this.playing=false}if(Sprite)AnimatedSprite.__proto__=Sprite;AnimatedSprite.prototype=Object.create(Sprite&&Sprite.prototype);AnimatedSprite.prototype.constructor=AnimatedSprite;var prototypeAccessors={totalFrames:{configurable:true},textures:{configurable:true},currentFrame:{configurable:true}};AnimatedSprite.prototype.stop=function stop(){if(!this.playing){return}this.playing=false;if(this._autoUpdate){ticker.Ticker.shared.remove(this.update,this)}};AnimatedSprite.prototype.play=function play(){if(this.playing){return}this.playing=true;if(this._autoUpdate){ticker.Ticker.shared.add(this.update,this,ticker.UPDATE_PRIORITY.HIGH)}};AnimatedSprite.prototype.gotoAndStop=function gotoAndStop(frameNumber){this.stop();var previousFrame=this.currentFrame;this._currentTime=frameNumber;if(previousFrame!==this.currentFrame){this.updateTexture()}};AnimatedSprite.prototype.gotoAndPlay=function gotoAndPlay(frameNumber){var previousFrame=this.currentFrame;this._currentTime=frameNumber;if(previousFrame!==this.currentFrame){this.updateTexture()}this.play()};AnimatedSprite.prototype.update=function update(deltaTime){var elapsed=this.animationSpeed*deltaTime;var previousFrame=this.currentFrame;if(this._durations!==null){var lag=this._currentTime%1*this._durations[this.currentFrame];lag+=elapsed/60*1e3;while(lag<0){this._currentTime--;lag+=this._durations[this.currentFrame]}var sign=Math.sign(this.animationSpeed*deltaTime);this._currentTime=Math.floor(this._currentTime);while(lag>=this._durations[this.currentFrame]){lag-=this._durations[this.currentFrame]*sign;this._currentTime+=sign}this._currentTime+=lag/this._durations[this.currentFrame]}else{this._currentTime+=elapsed}if(this._currentTime<0&&!this.loop){this.gotoAndStop(0);if(this.onComplete){this.onComplete()}}else if(this._currentTime>=this._textures.length&&!this.loop){this.gotoAndStop(this._textures.length-1);if(this.onComplete){this.onComplete()}}else if(previousFrame!==this.currentFrame){if(this.loop&&this.onLoop){if(this.animationSpeed>0&&this.currentFrame<previousFrame){this.onLoop()}else if(this.animationSpeed<0&&this.currentFrame>previousFrame){this.onLoop()}}this.updateTexture()}};AnimatedSprite.prototype.updateTexture=function updateTexture(){this._texture=this._textures[this.currentFrame];this._textureID=-1;this._textureTrimmedID=-1;this._cachedTint=16777215;this.uvs=this._texture._uvs.uvsFloat32;if(this.updateAnchor){this._anchor.copy(this._texture.defaultAnchor)}if(this.onFrameChange){this.onFrameChange(this.currentFrame)}};AnimatedSprite.prototype.destroy=function destroy(options){this.stop();Sprite.prototype.destroy.call(this,options);this.onComplete=null;this.onFrameChange=null;this.onLoop=null};AnimatedSprite.fromFrames=function fromFrames(frames){var textures=[];for(var i=0;i<frames.length;++i){textures.push(core.Texture.from(frames[i]))}return new AnimatedSprite(textures)};AnimatedSprite.fromImages=function fromImages(images){var textures=[];for(var i=0;i<images.length;++i){textures.push(core.Texture.from(images[i]))}return new AnimatedSprite(textures)};prototypeAccessors.totalFrames.get=function(){return this._textures.length};prototypeAccessors.textures.get=function(){return this._textures};prototypeAccessors.textures.set=function(value){if(value[0]instanceof core.Texture){this._textures=value;this._durations=null}else{this._textures=[];this._durations=[];for(var i=0;i<value.length;i++){this._textures.push(value[i].texture);this._durations.push(value[i].time)}}this.gotoAndStop(0);this.updateTexture()};prototypeAccessors.currentFrame.get=function(){var currentFrame=Math.floor(this._currentTime)%this._textures.length;if(currentFrame<0){currentFrame+=this._textures.length}return currentFrame};Object.defineProperties(AnimatedSprite.prototype,prototypeAccessors);return AnimatedSprite}(sprite.Sprite);exports.AnimatedSprite=AnimatedSprite},{"@pixi/core":16,"@pixi/sprite":41,"@pixi/ticker":45}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var math=require("@pixi/math");var utils=require("@pixi/utils");var sprite=require("@pixi/sprite");var constants=require("@pixi/constants");var tempPoint=new math.Point;var TilingSprite=function(Sprite){function TilingSprite(texture,width,height){if(width===void 0)width=100;if(height===void 0)height=100;Sprite.call(this,texture);this.tileTransform=new math.Transform;this._width=width;this._height=height;this._canvasPattern=null;this.uvMatrix=texture.uvMatrix||new core.TextureMatrix(texture);this.pluginName="tilingSprite";this.uvRespectAnchor=false}if(Sprite)TilingSprite.__proto__=Sprite;TilingSprite.prototype=Object.create(Sprite&&Sprite.prototype);TilingSprite.prototype.constructor=TilingSprite;var prototypeAccessors={clampMargin:{configurable:true},tileScale:{configurable:true},tilePosition:{configurable:true},width:{configurable:true},height:{configurable:true}};prototypeAccessors.clampMargin.get=function(){return this.uvMatrix.clampMargin};prototypeAccessors.clampMargin.set=function(value){this.uvMatrix.clampMargin=value;this.uvMatrix.update(true)};prototypeAccessors.tileScale.get=function(){return this.tileTransform.scale};prototypeAccessors.tileScale.set=function(value){this.tileTransform.scale.copyFrom(value)};prototypeAccessors.tilePosition.get=function(){return this.tileTransform.position};prototypeAccessors.tilePosition.set=function(value){this.tileTransform.position.copyFrom(value)};TilingSprite.prototype._onTextureUpdate=function _onTextureUpdate(){if(this.uvMatrix){this.uvMatrix.texture=this._texture}this._cachedTint=16777215};TilingSprite.prototype._render=function _render(renderer){var texture=this._texture;if(!texture||!texture.valid){return}this.tileTransform.updateLocalTransform();this.uvMatrix.update();renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);renderer.plugins[this.pluginName].render(this)};TilingSprite.prototype._calculateBounds=function _calculateBounds(){var minX=this._width*-this._anchor._x;var minY=this._height*-this._anchor._y;var maxX=this._width*(1-this._anchor._x);var maxY=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,minX,minY,maxX,maxY)};TilingSprite.prototype.getLocalBounds=function getLocalBounds(rect){if(this.children.length===0){this._bounds.minX=this._width*-this._anchor._x;this._bounds.minY=this._height*-this._anchor._y;this._bounds.maxX=this._width*(1-this._anchor._x);this._bounds.maxY=this._height*(1-this._anchor._y);if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new math.Rectangle}rect=this._localBoundsRect}return this._bounds.getRectangle(rect)}return Sprite.prototype.getLocalBounds.call(this,rect)};TilingSprite.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._width;var height=this._height;var x1=-width*this.anchor._x;if(tempPoint.x>=x1&&tempPoint.x<x1+width){var y1=-height*this.anchor._y;if(tempPoint.y>=y1&&tempPoint.y<y1+height){return true}}return false};TilingSprite.prototype.destroy=function destroy(options){Sprite.prototype.destroy.call(this,options);this.tileTransform=null;this.uvMatrix=null};TilingSprite.from=function from(source,width,height){return new TilingSprite(core.Texture.from(source),width,height)};TilingSprite.fromFrame=function fromFrame(frameId,width,height){var texture=utils.TextureCache[frameId];if(!texture){throw new Error('The frameId "'+frameId+'" does not exist in the texture cache '+this)}return new TilingSprite(texture,width,height)};TilingSprite.fromImage=function fromImage(imageId,width,height,options){if(options&&typeof options!=="object"){options={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}}return new TilingSprite(core.Texture.from(imageId,options),width,height)};prototypeAccessors.width.get=function(){return this._width};prototypeAccessors.width.set=function(value){this._width=value};prototypeAccessors.height.get=function(){return this._height};prototypeAccessors.height.set=function(value){this._height=value};Object.defineProperties(TilingSprite.prototype,prototypeAccessors);return TilingSprite}(sprite.Sprite);var vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";var fragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n";var fragmentSimple="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n";var tempMat=new math.Matrix;var TilingSpriteRenderer=function(ObjectRenderer){function TilingSpriteRenderer(renderer){ObjectRenderer.call(this,renderer);var uniforms={globals:this.renderer.globalUniforms};this.shader=core.Shader.from(vertex,fragment,uniforms);this.simpleShader=core.Shader.from(vertex,fragmentSimple,uniforms);this.quad=new core.QuadUv}if(ObjectRenderer)TilingSpriteRenderer.__proto__=ObjectRenderer;TilingSpriteRenderer.prototype=Object.create(ObjectRenderer&&ObjectRenderer.prototype);TilingSpriteRenderer.prototype.constructor=TilingSpriteRenderer;TilingSpriteRenderer.prototype.render=function render(ts){var renderer=this.renderer;var quad=this.quad;var vertices=quad.vertices;vertices[0]=vertices[6]=ts._width*-ts.anchor.x;vertices[1]=vertices[3]=ts._height*-ts.anchor.y;vertices[2]=vertices[4]=ts._width*(1-ts.anchor.x);vertices[5]=vertices[7]=ts._height*(1-ts.anchor.y);if(ts.uvRespectAnchor){vertices=quad.uvs;vertices[0]=vertices[6]=-ts.anchor.x;vertices[1]=vertices[3]=-ts.anchor.y;vertices[2]=vertices[4]=1-ts.anchor.x;vertices[5]=vertices[7]=1-ts.anchor.y}quad.invalidate();var tex=ts._texture;var baseTex=tex.baseTexture;var lt=ts.tileTransform.localTransform;var uv=ts.uvMatrix;var isSimple=baseTex.isPowerOfTwo&&tex.frame.width===baseTex.width&&tex.frame.height===baseTex.height;if(isSimple){if(!baseTex._glTextures[renderer.CONTEXT_UID]){if(baseTex.wrapMode===constants.WRAP_MODES.CLAMP){baseTex.wrapMode=constants.WRAP_MODES.REPEAT}}else{isSimple=baseTex.wrapMode!==constants.WRAP_MODES.CLAMP}}var shader=isSimple?this.simpleShader:this.shader;var w=tex.width;var h=tex.height;var W=ts._width;var H=ts._height;tempMat.set(lt.a*w/W,lt.b*w/H,lt.c*h/W,lt.d*h/H,lt.tx/W,lt.ty/H);tempMat.invert();if(isSimple){tempMat.prepend(uv.mapCoord)}else{shader.uniforms.uMapCoord=uv.mapCoord.toArray(true);shader.uniforms.uClampFrame=uv.uClampFrame;shader.uniforms.uClampOffset=uv.uClampOffset}shader.uniforms.uTransform=tempMat.toArray(true);shader.uniforms.uColor=utils.premultiplyTintToRgba(ts.tint,ts.worldAlpha,shader.uniforms.uColor,baseTex.premultiplyAlpha);shader.uniforms.translationMatrix=ts.transform.worldTransform.toArray(true);shader.uniforms.uSampler=tex;renderer.shader.bind(shader);renderer.geometry.bind(quad);renderer.state.setBlendMode(utils.correctBlendMode(ts.blendMode,baseTex.premultiplyAlpha));renderer.geometry.draw(this.renderer.gl.TRIANGLES,6,0)};return TilingSpriteRenderer}(core.ObjectRenderer);exports.TilingSprite=TilingSprite;exports.TilingSpriteRenderer=TilingSpriteRenderer},{"@pixi/constants":15,"@pixi/core":16,"@pixi/math":28,"@pixi/sprite":41,"@pixi/utils":46}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var math=require("@pixi/math");var utils=require("@pixi/utils");var core=require("@pixi/core");var constants=require("@pixi/constants");var display=require("@pixi/display");var settings=require("@pixi/settings");var tempPoint=new math.Point;var indices=new Uint16Array([0,1,2,0,2,3]);var Sprite=function(Container){function Sprite(texture){Container.call(this);this._anchor=new math.ObservablePoint(this._onAnchorUpdate,this,texture?texture.defaultAnchor.x:0,texture?texture.defaultAnchor.y:0);this._texture=null;this._width=0;this._height=0;this._tint=null;this._tintRGB=null;this.tint=16777215;this.blendMode=constants.BLEND_MODES.NORMAL;this.shader=null;this._cachedTint=16777215;this.uvs=null;this.texture=texture||core.Texture.EMPTY;this.vertexData=new Float32Array(8);this.vertexTrimmedData=null;this._transformID=-1;this._textureID=-1;this._transformTrimmedID=-1;this._textureTrimmedID=-1;this.indices=indices;this.size=4;this.start=0;this.pluginName="batch";this.isSprite=true;this._roundPixels=settings.settings.ROUND_PIXELS}if(Container)Sprite.__proto__=Container;Sprite.prototype=Object.create(Container&&Container.prototype);Sprite.prototype.constructor=Sprite;var prototypeAccessors={roundPixels:{configurable:true},width:{configurable:true},height:{configurable:true},anchor:{configurable:true},tint:{configurable:true},texture:{configurable:true}};Sprite.prototype._onTextureUpdate=function _onTextureUpdate(){this._textureID=-1;this._textureTrimmedID=-1;this._cachedTint=16777215;this.uvs=this._texture._uvs.uvsFloat32;if(this._width){this.scale.x=utils.sign(this.scale.x)*this._width/this._texture.orig.width}if(this._height){this.scale.y=utils.sign(this.scale.y)*this._height/this._texture.orig.height}};Sprite.prototype._onAnchorUpdate=function _onAnchorUpdate(){this._transformID=-1;this._transformTrimmedID=-1};Sprite.prototype.calculateVertices=function calculateVertices(){var texture=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===texture._updateID){return}this._transformID=this.transform._worldID;this._textureID=texture._updateID;var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var vertexData=this.vertexData;var trim=texture.trim;var orig=texture.orig;var anchor=this._anchor;var w0=0;var w1=0;var h0=0;var h1=0;if(trim){w1=trim.x-anchor._x*orig.width;w0=w1+trim.width;h1=trim.y-anchor._y*orig.height;h0=h1+trim.height}else{w1=-anchor._x*orig.width;w0=w1+orig.width;h1=-anchor._y*orig.height;h0=h1+orig.height}vertexData[0]=a*w1+c*h1+tx;vertexData[1]=d*h1+b*w1+ty;vertexData[2]=a*w0+c*h1+tx;vertexData[3]=d*h1+b*w0+ty;vertexData[4]=a*w0+c*h0+tx;vertexData[5]=d*h0+b*w0+ty;vertexData[6]=a*w1+c*h0+tx;vertexData[7]=d*h0+b*w1+ty;if(this._roundPixels){for(var i=0;i<8;i++){vertexData[i]=Math.round(vertexData[i])}}};Sprite.prototype.calculateTrimmedVertices=function calculateTrimmedVertices(){if(!this.vertexTrimmedData){this.vertexTrimmedData=new Float32Array(8)}else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID){return}this._transformTrimmedID=this.transform._worldID;this._textureTrimmedID=this._texture._updateID;var texture=this._texture;var vertexData=this.vertexTrimmedData;var orig=texture.orig;var anchor=this._anchor;var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var w1=-anchor._x*orig.width;var w0=w1+orig.width;var h1=-anchor._y*orig.height;var h0=h1+orig.height;vertexData[0]=a*w1+c*h1+tx;vertexData[1]=d*h1+b*w1+ty;vertexData[2]=a*w0+c*h1+tx;vertexData[3]=d*h1+b*w0+ty;vertexData[4]=a*w0+c*h0+tx;vertexData[5]=d*h0+b*w0+ty;vertexData[6]=a*w1+c*h0+tx;vertexData[7]=d*h0+b*w1+ty};Sprite.prototype._render=function _render(renderer){this.calculateVertices();renderer.batch.setObjectRenderer(renderer.plugins[this.pluginName]);renderer.plugins[this.pluginName].render(this)};Sprite.prototype._calculateBounds=function _calculateBounds(){var trim=this._texture.trim;var orig=this._texture.orig;if(!trim||trim.width===orig.width&&trim.height===orig.height){this.calculateVertices();this._bounds.addQuad(this.vertexData)}else{this.calculateTrimmedVertices();this._bounds.addQuad(this.vertexTrimmedData)}};Sprite.prototype.getLocalBounds=function getLocalBounds(rect){if(this.children.length===0){this._bounds.minX=this._texture.orig.width*-this._anchor._x;this._bounds.minY=this._texture.orig.height*-this._anchor._y;this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x);this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y);if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new math.Rectangle}rect=this._localBoundsRect}return this._bounds.getRectangle(rect)}return Container.prototype.getLocalBounds.call(this,rect)};Sprite.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._texture.orig.width;var height=this._texture.orig.height;var x1=-width*this.anchor.x;var y1=0;if(tempPoint.x>=x1&&tempPoint.x<x1+width){y1=-height*this.anchor.y;if(tempPoint.y>=y1&&tempPoint.y<y1+height){return true}}return false};Sprite.prototype.destroy=function destroy(options){Container.prototype.destroy.call(this,options);this._texture.off("update",this._onTextureUpdate,this);this._anchor=null;var destroyTexture=typeof options==="boolean"?options:options&&options.texture;if(destroyTexture){var destroyBaseTexture=typeof options==="boolean"?options:options&&options.baseTexture;this._texture.destroy(!!destroyBaseTexture)}this._texture=null;this.shader=null};Sprite.from=function from(source,options){var texture=source instanceof core.Texture?source:core.Texture.from(source,options);return new Sprite(texture)};prototypeAccessors.roundPixels.set=function(value){if(this._roundPixels!==value){this._transformID=-1}this._roundPixels=value};prototypeAccessors.roundPixels.get=function(){return this._roundPixels};prototypeAccessors.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width};prototypeAccessors.width.set=function(value){var s=utils.sign(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width;this._width=value};prototypeAccessors.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height};prototypeAccessors.height.set=function(value){var s=utils.sign(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height;this._height=value};prototypeAccessors.anchor.get=function(){return this._anchor};prototypeAccessors.anchor.set=function(value){this._anchor.copyFrom(value)};prototypeAccessors.tint.get=function(){return this._tint};prototypeAccessors.tint.set=function(value){this._tint=value;this._tintRGB=(value>>16)+(value&65280)+((value&255)<<16)};prototypeAccessors.texture.get=function(){return this._texture};prototypeAccessors.texture.set=function(value){if(this._texture===value){return}this._texture=value||core.Texture.EMPTY;this._cachedTint=16777215;this._textureID=-1;this._textureTrimmedID=-1;if(value){if(value.baseTexture.valid){this._onTextureUpdate()}else{value.once("update",this._onTextureUpdate,this)}}};Object.defineProperties(Sprite.prototype,prototypeAccessors);return Sprite}(display.Container);exports.Sprite=Sprite},{"@pixi/constants":15,"@pixi/core":16,"@pixi/display":17,"@pixi/math":28,"@pixi/settings":38,"@pixi/utils":46}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var math=require("@pixi/math");var core=require("@pixi/core");var utils=require("@pixi/utils");var loaders=require("@pixi/loaders");var Spritesheet=function Spritesheet(baseTexture,data,resolutionFilename){if(resolutionFilename===void 0)resolutionFilename=null;this.baseTexture=baseTexture;this.textures={};this.animations={};this.data=data;this.resolution=this._updateResolution(resolutionFilename||(this.baseTexture.resource?this.baseTexture.resource.url:null));this._frames=this.data.frames;this._frameKeys=Object.keys(this._frames);this._batchIndex=0;this._callback=null};var staticAccessors={BATCH_SIZE:{configurable:true}};staticAccessors.BATCH_SIZE.get=function(){return 1e3};Spritesheet.prototype._updateResolution=function _updateResolution(resolutionFilename){var scale=this.data.meta.scale;var resolution=utils.getResolutionOfUrl(resolutionFilename,null);if(resolution===null){resolution=scale!==undefined?parseFloat(scale):1}if(resolution!==1){this.baseTexture.setResolution(resolution)}return resolution};Spritesheet.prototype.parse=function parse(callback){this._batchIndex=0;this._callback=callback;if(this._frameKeys.length<=Spritesheet.BATCH_SIZE){this._processFrames(0);this._processAnimations();this._parseComplete()}else{this._nextBatch()}};Spritesheet.prototype._processFrames=function _processFrames(initialFrameIndex){var frameIndex=initialFrameIndex;var maxFrames=Spritesheet.BATCH_SIZE;while(frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length){var i=this._frameKeys[frameIndex];var data=this._frames[i];var rect=data.frame;if(rect){var frame=null;var trim=null;var sourceSize=data.trimmed!==false&&data.sourceSize?data.sourceSize:data.frame;var orig=new math.Rectangle(0,0,Math.floor(sourceSize.w)/this.resolution,Math.floor(sourceSize.h)/this.resolution);if(data.rotated){frame=new math.Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.h)/this.resolution,Math.floor(rect.w)/this.resolution)}else{frame=new math.Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution)}if(data.trimmed!==false&&data.spriteSourceSize){trim=new math.Rectangle(Math.floor(data.spriteSourceSize.x)/this.resolution,Math.floor(data.spriteSourceSize.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution)}this.textures[i]=new core.Texture(this.baseTexture,frame,orig,trim,data.rotated?2:0,data.anchor);core.Texture.addToCache(this.textures[i],i)}frameIndex++}};Spritesheet.prototype._processAnimations=function _processAnimations(){var animations=this.data.animations||{};for(var animName in animations){this.animations[animName]=[];for(var i=0;i<animations[animName].length;i++){var frameName=animations[animName][i];this.animations[animName].push(this.textures[frameName])}}};Spritesheet.prototype._parseComplete=function _parseComplete(){var callback=this._callback;this._callback=null;this._batchIndex=0;callback.call(this,this.textures)};Spritesheet.prototype._nextBatch=function _nextBatch(){var this$1=this;this._processFrames(this._batchIndex*Spritesheet.BATCH_SIZE);this._batchIndex++;setTimeout(function(){if(this$1._batchIndex*Spritesheet.BATCH_SIZE<this$1._frameKeys.length){this$1._nextBatch()}else{this$1._processAnimations();this$1._parseComplete()}},0)};Spritesheet.prototype.destroy=function destroy(destroyBase){if(destroyBase===void 0)destroyBase=false;for(var i in this.textures){this.textures[i].destroy()}this._frames=null;this._frameKeys=null;this.data=null;this.textures=null;if(destroyBase){this.baseTexture.destroy()}this.baseTexture=null};Object.defineProperties(Spritesheet,staticAccessors);var SpritesheetLoader=function SpritesheetLoader(){};SpritesheetLoader.use=function use(resource,next){var imageResourceName=resource.name+"_image";if(!resource.data||resource.type!==loaders.LoaderResource.TYPE.JSON||!resource.data.frames||this.resources[imageResourceName]){next();return}var loadOptions={crossOrigin:resource.crossOrigin,metadata:resource.metadata.imageMetadata,parentResource:resource};var resourcePath=SpritesheetLoader.getResourcePath(resource,this.baseUrl);this.add(imageResourceName,resourcePath,loadOptions,function onImageLoad(res){if(res.error){next(res.error);return}var spritesheet=new Spritesheet(res.texture.baseTexture,resource.data,resource.url);spritesheet.parse(function(){resource.spritesheet=spritesheet;resource.textures=spritesheet.textures;next()})})};SpritesheetLoader.getResourcePath=function getResourcePath(resource,baseUrl){if(resource.isDataUrl){return resource.data.meta.image}return utils.url.resolve(resource.url.replace(baseUrl,""),resource.data.meta.image)};exports.Spritesheet=Spritesheet;exports.SpritesheetLoader=SpritesheetLoader},{"@pixi/core":16,"@pixi/loaders":27,"@pixi/math":28,"@pixi/utils":46}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var core=require("@pixi/core");var display=require("@pixi/display");var math=require("@pixi/math");var settings=require("@pixi/settings");var sprite=require("@pixi/sprite");var utils=require("@pixi/utils");var loaders=require("@pixi/loaders");var BitmapText=function(Container){function BitmapText(text,style){var this$1=this;if(style===void 0)style={};Container.call(this);this._textWidth=0;this._textHeight=0;this._glyphs=[];this._font={tint:style.tint!==undefined?style.tint:16777215,align:style.align||"left",name:null,size:0};this.font=style.font;this._text=text;this._maxWidth=0;this._maxLineHeight=0;this._letterSpacing=0;this._anchor=new math.ObservablePoint(function(){this$1.dirty=true},this,0,0);this.dirty=false;this.roundPixels=settings.settings.ROUND_PIXELS;this.updateText()}if(Container)BitmapText.__proto__=Container;BitmapText.prototype=Object.create(Container&&Container.prototype);BitmapText.prototype.constructor=BitmapText;var prototypeAccessors={tint:{configurable:true},align:{configurable:true},anchor:{configurable:true},font:{configurable:true},text:{configurable:true},maxWidth:{configurable:true},maxLineHeight:{configurable:true},textWidth:{configurable:true},letterSpacing:{configurable:true},textHeight:{configurable:true}};BitmapText.prototype.updateText=function updateText(){var data=BitmapText.fonts[this._font.name];var scale=this._font.size/data.size;var pos=new math.Point;var chars=[];var lineWidths=[];var text=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ";var textLength=text.length;var maxWidth=this._maxWidth*data.size/this._font.size;var prevCharCode=null;var lastLineWidth=0;var maxLineWidth=0;var line=0;var lastBreakPos=-1;var lastBreakWidth=0;var spacesRemoved=0;var maxLineHeight=0;for(var i=0;i<textLength;i++){var charCode=text.charCodeAt(i);var char=text.charAt(i);if(/(?:\s)/.test(char)){lastBreakPos=i;lastBreakWidth=lastLineWidth}if(char==="\r"||char==="\n"){lineWidths.push(lastLineWidth);maxLineWidth=Math.max(maxLineWidth,lastLineWidth);++line;++spacesRemoved;pos.x=0;pos.y+=data.lineHeight;prevCharCode=null;continue}var charData=data.chars[charCode];if(!charData){continue}if(prevCharCode&&charData.kerning[prevCharCode]){pos.x+=charData.kerning[prevCharCode]}chars.push({texture:charData.texture,line:line,charCode:charCode,position:new math.Point(pos.x+charData.xOffset+this._letterSpacing/2,pos.y+charData.yOffset)});pos.x+=charData.xAdvance+this._letterSpacing;lastLineWidth=pos.x;maxLineHeight=Math.max(maxLineHeight,charData.yOffset+charData.texture.height);prevCharCode=charCode;if(lastBreakPos!==-1&&maxWidth>0&&pos.x>maxWidth){++spacesRemoved;utils.removeItems(chars,1+lastBreakPos-spacesRemoved,1+i-lastBreakPos);i=lastBreakPos;lastBreakPos=-1;lineWidths.push(lastBreakWidth);maxLineWidth=Math.max(maxLineWidth,lastBreakWidth);line++;pos.x=0;pos.y+=data.lineHeight;prevCharCode=null}}var lastChar=text.charAt(text.length-1);if(lastChar!=="\r"&&lastChar!=="\n"){if(/(?:\s)/.test(lastChar)){lastLineWidth=lastBreakWidth}lineWidths.push(lastLineWidth);maxLineWidth=Math.max(maxLineWidth,lastLineWidth)}var lineAlignOffsets=[];for(var i$1=0;i$1<=line;i$1++){var alignOffset=0;if(this._font.align==="right"){alignOffset=maxLineWidth-lineWidths[i$1]}else if(this._font.align==="center"){alignOffset=(maxLineWidth-lineWidths[i$1])/2}lineAlignOffsets.push(alignOffset)}var lenChars=chars.length;var tint=this.tint;for(var i$2=0;i$2<lenChars;i$2++){var c=this._glyphs[i$2];if(c){c.texture=chars[i$2].texture}else{c=new sprite.Sprite(chars[i$2].texture);c.roundPixels=this.roundPixels;this._glyphs.push(c)}c.position.x=(chars[i$2].position.x+lineAlignOffsets[chars[i$2].line])*scale;c.position.y=chars[i$2].position.y*scale;c.scale.x=c.scale.y=scale;c.tint=tint;if(!c.parent){this.addChild(c)}}for(var i$3=lenChars;i$3<this._glyphs.length;++i$3){this.removeChild(this._glyphs[i$3])}this._textWidth=maxLineWidth*scale;this._textHeight=(pos.y+data.lineHeight)*scale;if(this.anchor.x!==0||this.anchor.y!==0){for(var i$4=0;i$4<lenChars;i$4++){this._glyphs[i$4].x-=this._textWidth*this.anchor.x;this._glyphs[i$4].y-=this._textHeight*this.anchor.y}}this._maxLineHeight=maxLineHeight*scale};BitmapText.prototype.updateTransform=function updateTransform(){this.validate();this.containerUpdateTransform()};BitmapText.prototype.getLocalBounds=function getLocalBounds(){this.validate();return Container.prototype.getLocalBounds.call(this)};BitmapText.prototype.validate=function validate(){if(this.dirty){this.updateText();this.dirty=false}};prototypeAccessors.tint.get=function(){return this._font.tint};prototypeAccessors.tint.set=function(value){this._font.tint=typeof value==="number"&&value>=0?value:16777215;this.dirty=true};prototypeAccessors.align.get=function(){return this._font.align};prototypeAccessors.align.set=function(value){this._font.align=value||"left";this.dirty=true};prototypeAccessors.anchor.get=function(){return this._anchor};prototypeAccessors.anchor.set=function(value){if(typeof value==="number"){this._anchor.set(value)}else{this._anchor.copyFrom(value)}};prototypeAccessors.font.get=function(){return this._font};prototypeAccessors.font.set=function(value){if(!value){return}if(typeof value==="string"){value=value.split(" ");this._font.name=value.length===1?value[0]:value.slice(1).join(" ");this._font.size=value.length>=2?parseInt(value[0],10):BitmapText.fonts[this._font.name].size}else{this._font.name=value.name;this._font.size=typeof value.size==="number"?value.size:parseInt(value.size,10)}this.dirty=true};prototypeAccessors.text.get=function(){return this._text};prototypeAccessors.text.set=function(text){text=String(text===null||text===undefined?"":text);if(this._text===text){return}this._text=text;this.dirty=true};prototypeAccessors.maxWidth.get=function(){return this._maxWidth};prototypeAccessors.maxWidth.set=function(value){if(this._maxWidth===value){return}this._maxWidth=value;this.dirty=true};prototypeAccessors.maxLineHeight.get=function(){this.validate();return this._maxLineHeight};prototypeAccessors.textWidth.get=function(){this.validate();return this._textWidth};prototypeAccessors.letterSpacing.get=function(){return this._letterSpacing};prototypeAccessors.letterSpacing.set=function(value){if(this._letterSpacing!==value){this._letterSpacing=value;this.dirty=true}};prototypeAccessors.textHeight.get=function(){this.validate();return this._textHeight};BitmapText.registerFont=function registerFont(xml,textures){var data={};var info=xml.getElementsByTagName("info")[0];var common=xml.getElementsByTagName("common")[0];var pages=xml.getElementsByTagName("page");var res=utils.getResolutionOfUrl(pages[0].getAttribute("file"),settings.settings.RESOLUTION);var pagesTextures={};data.font=info.getAttribute("face");data.size=parseInt(info.getAttribute("size"),10);data.lineHeight=parseInt(common.getAttribute("lineHeight"),10)/res;data.chars={};if(textures instanceof core.Texture){textures=[textures]}for(var i=0;i<pages.length;i++){var id=pages[i].getAttribute("id");var file=pages[i].getAttribute("file");pagesTextures[id]=textures instanceof Array?textures[i]:textures[file]}var letters=xml.getElementsByTagName("char");for(var i$1=0;i$1<letters.length;i$1++){var letter=letters[i$1];var charCode=parseInt(letter.getAttribute("id"),10);var page=letter.getAttribute("page")||0;var textureRect=new math.Rectangle(parseInt(letter.getAttribute("x"),10)/res+pagesTextures[page].frame.x/res,parseInt(letter.getAttribute("y"),10)/res+pagesTextures[page].frame.y/res,parseInt(letter.getAttribute("width"),10)/res,parseInt(letter.getAttribute("height"),10)/res);data.chars[charCode]={xOffset:parseInt(letter.getAttribute("xoffset"),10)/res,yOffset:parseInt(letter.getAttribute("yoffset"),10)/res,xAdvance:parseInt(letter.getAttribute("xadvance"),10)/res,kerning:{},texture:new core.Texture(pagesTextures[page].baseTexture,textureRect),page:page}}var kernings=xml.getElementsByTagName("kerning");for(var i$2=0;i$2<kernings.length;i$2++){var kerning=kernings[i$2];var first=parseInt(kerning.getAttribute("first"),10)/res;var second=parseInt(kerning.getAttribute("second"),10)/res;var amount=parseInt(kerning.getAttribute("amount"),10)/res;if(data.chars[second]){data.chars[second].kerning[first]=amount}}BitmapText.fonts[data.font]=data;return data};Object.defineProperties(BitmapText.prototype,prototypeAccessors);return BitmapText}(display.Container);BitmapText.fonts={};var BitmapFontLoader=function BitmapFontLoader(){};BitmapFontLoader.parse=function parse(resource,texture){resource.bitmapFont=BitmapText.registerFont(resource.data,texture)};BitmapFontLoader.add=function add(){loaders.LoaderResource.setExtensionXhrType("fnt",loaders.LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT)};BitmapFontLoader.dirname=function dirname(url){var dir=url.replace(/\/$/,"").replace(/\/[^\/]*$/,"");if(dir===url){return"."}else if(dir===""){return"/"}return dir};BitmapFontLoader.use=function use(resource,next){if(!resource.data||resource.type!==loaders.LoaderResource.TYPE.XML){next();return}if(resource.data.getElementsByTagName("page").length===0||resource.data.getElementsByTagName("info").length===0||resource.data.getElementsByTagName("info")[0].getAttribute("face")===null){next();return}var xmlUrl=!resource.isDataUrl?BitmapFontLoader.dirname(resource.url):"";if(resource.isDataUrl){if(xmlUrl==="."){xmlUrl=""}if(this.baseUrl&&xmlUrl){if(this.baseUrl.charAt(this.baseUrl.length-1)==="/"){xmlUrl+="/"}}}xmlUrl=xmlUrl.replace(this.baseUrl,"");if(xmlUrl&&xmlUrl.charAt(xmlUrl.length-1)!=="/"){xmlUrl+="/"}var pages=resource.data.getElementsByTagName("page");var textures={};var completed=function(page){textures[page.metadata.pageFile]=page.texture;if(Object.keys(textures).length===pages.length){BitmapFontLoader.parse(resource,textures);next()}};for(var i=0;i<pages.length;++i){var pageFile=pages[i].getAttribute("file");var url=xmlUrl+pageFile;var exists=false;for(var name in this.resources){var bitmapResource=this.resources[name];if(bitmapResource.url===url){bitmapResource.metadata.pageFile=pageFile;if(bitmapResource.texture){completed(bitmapResource)}else{bitmapResource.onAfterMiddleware.add(completed)}exists=true;break}}if(!exists){var options={crossOrigin:resource.crossOrigin,loadType:loaders.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:pageFile},resource.metadata.imageMetadata),parentResource:resource};this.add(url,options,completed)}}};exports.BitmapFontLoader=BitmapFontLoader;exports.BitmapText=BitmapText},{"@pixi/core":16,"@pixi/display":17,"@pixi/loaders":27,"@pixi/math":28,"@pixi/settings":38,"@pixi/sprite":41,"@pixi/utils":46}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var sprite=require("@pixi/sprite");var core=require("@pixi/core");var settings=require("@pixi/settings");var math=require("@pixi/math");var utils=require("@pixi/utils");var TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1};var defaultStyle={align:"left",breakWords:false,dropShadow:false,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:false,whiteSpace:"pre",wordWrap:false,wordWrapWidth:100,leading:0};var genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];var TextStyle=function TextStyle(style){this.styleID=0;this.reset();deepCopyProperties(this,style,style)};var prototypeAccessors={align:{configurable:true},breakWords:{configurable:true},dropShadow:{configurable:true},dropShadowAlpha:{configurable:true},dropShadowAngle:{configurable:true},dropShadowBlur:{configurable:true},dropShadowColor:{configurable:true},dropShadowDistance:{configurable:true},fill:{configurable:true},fillGradientType:{configurable:true},fillGradientStops:{configurable:true},fontFamily:{configurable:true},fontSize:{configurable:true},fontStyle:{configurable:true},fontVariant:{configurable:true},fontWeight:{configurable:true},letterSpacing:{configurable:true},lineHeight:{configurable:true},leading:{configurable:true},lineJoin:{configurable:true},miterLimit:{configurable:true},padding:{configurable:true},stroke:{configurable:true},strokeThickness:{configurable:true},textBaseline:{configurable:true},trim:{configurable:true},whiteSpace:{configurable:true},wordWrap:{configurable:true},wordWrapWidth:{configurable:true}};TextStyle.prototype.clone=function clone(){var clonedProperties={};deepCopyProperties(clonedProperties,this,defaultStyle);return new TextStyle(clonedProperties)};TextStyle.prototype.reset=function reset(){deepCopyProperties(this,defaultStyle,defaultStyle)};prototypeAccessors.align.get=function(){return this._align};prototypeAccessors.align.set=function(align){if(this._align!==align){this._align=align;this.styleID++}};prototypeAccessors.breakWords.get=function(){return this._breakWords};prototypeAccessors.breakWords.set=function(breakWords){if(this._breakWords!==breakWords){this._breakWords=breakWords;this.styleID++}};prototypeAccessors.dropShadow.get=function(){return this._dropShadow};prototypeAccessors.dropShadow.set=function(dropShadow){if(this._dropShadow!==dropShadow){this._dropShadow=dropShadow;this.styleID++}};prototypeAccessors.dropShadowAlpha.get=function(){return this._dropShadowAlpha};prototypeAccessors.dropShadowAlpha.set=function(dropShadowAlpha){if(this._dropShadowAlpha!==dropShadowAlpha){this._dropShadowAlpha=dropShadowAlpha;this.styleID++}};prototypeAccessors.dropShadowAngle.get=function(){return this._dropShadowAngle};prototypeAccessors.dropShadowAngle.set=function(dropShadowAngle){if(this._dropShadowAngle!==dropShadowAngle){this._dropShadowAngle=dropShadowAngle;this.styleID++}};prototypeAccessors.dropShadowBlur.get=function(){return this._dropShadowBlur};prototypeAccessors.dropShadowBlur.set=function(dropShadowBlur){if(this._dropShadowBlur!==dropShadowBlur){this._dropShadowBlur=dropShadowBlur;this.styleID++}};prototypeAccessors.dropShadowColor.get=function(){return this._dropShadowColor};prototypeAccessors.dropShadowColor.set=function(dropShadowColor){var outputColor=getColor(dropShadowColor);if(this._dropShadowColor!==outputColor){this._dropShadowColor=outputColor;this.styleID++}};prototypeAccessors.dropShadowDistance.get=function(){return this._dropShadowDistance};prototypeAccessors.dropShadowDistance.set=function(dropShadowDistance){if(this._dropShadowDistance!==dropShadowDistance){this._dropShadowDistance=dropShadowDistance;this.styleID++}};prototypeAccessors.fill.get=function(){return this._fill};prototypeAccessors.fill.set=function(fill){var outputColor=getColor(fill);if(this._fill!==outputColor){this._fill=outputColor;this.styleID++}};prototypeAccessors.fillGradientType.get=function(){return this._fillGradientType};prototypeAccessors.fillGradientType.set=function(fillGradientType){if(this._fillGradientType!==fillGradientType){this._fillGradientType=fillGradientType;this.styleID++}};prototypeAccessors.fillGradientStops.get=function(){return this._fillGradientStops};prototypeAccessors.fillGradientStops.set=function(fillGradientStops){if(!areArraysEqual(this._fillGradientStops,fillGradientStops)){this._fillGradientStops=fillGradientStops;this.styleID++}};prototypeAccessors.fontFamily.get=function(){return this._fontFamily};prototypeAccessors.fontFamily.set=function(fontFamily){if(this.fontFamily!==fontFamily){this._fontFamily=fontFamily;this.styleID++}};prototypeAccessors.fontSize.get=function(){return this._fontSize};prototypeAccessors.fontSize.set=function(fontSize){if(this._fontSize!==fontSize){this._fontSize=fontSize;this.styleID++}};prototypeAccessors.fontStyle.get=function(){return this._fontStyle};prototypeAccessors.fontStyle.set=function(fontStyle){if(this._fontStyle!==fontStyle){this._fontStyle=fontStyle;this.styleID++}};prototypeAccessors.fontVariant.get=function(){return this._fontVariant};prototypeAccessors.fontVariant.set=function(fontVariant){if(this._fontVariant!==fontVariant){this._fontVariant=fontVariant;this.styleID++}};prototypeAccessors.fontWeight.get=function(){return this._fontWeight};prototypeAccessors.fontWeight.set=function(fontWeight){if(this._fontWeight!==fontWeight){this._fontWeight=fontWeight;this.styleID++}};prototypeAccessors.letterSpacing.get=function(){return this._letterSpacing};prototypeAccessors.letterSpacing.set=function(letterSpacing){if(this._letterSpacing!==letterSpacing){this._letterSpacing=letterSpacing;this.styleID++}};prototypeAccessors.lineHeight.get=function(){return this._lineHeight};prototypeAccessors.lineHeight.set=function(lineHeight){if(this._lineHeight!==lineHeight){this._lineHeight=lineHeight;this.styleID++}};prototypeAccessors.leading.get=function(){return this._leading};prototypeAccessors.leading.set=function(leading){if(this._leading!==leading){this._leading=leading;this.styleID++}};prototypeAccessors.lineJoin.get=function(){return this._lineJoin};prototypeAccessors.lineJoin.set=function(lineJoin){if(this._lineJoin!==lineJoin){this._lineJoin=lineJoin;this.styleID++}};prototypeAccessors.miterLimit.get=function(){return this._miterLimit};prototypeAccessors.miterLimit.set=function(miterLimit){if(this._miterLimit!==miterLimit){this._miterLimit=miterLimit;this.styleID++}};prototypeAccessors.padding.get=function(){return this._padding};prototypeAccessors.padding.set=function(padding){if(this._padding!==padding){this._padding=padding;this.styleID++}};prototypeAccessors.stroke.get=function(){return this._stroke};prototypeAccessors.stroke.set=function(stroke){var outputColor=getColor(stroke);if(this._stroke!==outputColor){this._stroke=outputColor;this.styleID++}};prototypeAccessors.strokeThickness.get=function(){return this._strokeThickness};prototypeAccessors.strokeThickness.set=function(strokeThickness){if(this._strokeThickness!==strokeThickness){this._strokeThickness=strokeThickness;this.styleID++}};prototypeAccessors.textBaseline.get=function(){return this._textBaseline};prototypeAccessors.textBaseline.set=function(textBaseline){if(this._textBaseline!==textBaseline){this._textBaseline=textBaseline;this.styleID++}};prototypeAccessors.trim.get=function(){return this._trim};prototypeAccessors.trim.set=function(trim){if(this._trim!==trim){this._trim=trim;this.styleID++}};prototypeAccessors.whiteSpace.get=function(){return this._whiteSpace};prototypeAccessors.whiteSpace.set=function(whiteSpace){if(this._whiteSpace!==whiteSpace){this._whiteSpace=whiteSpace;this.styleID++}};prototypeAccessors.wordWrap.get=function(){return this._wordWrap};prototypeAccessors.wordWrap.set=function(wordWrap){if(this._wordWrap!==wordWrap){this._wordWrap=wordWrap;this.styleID++}};prototypeAccessors.wordWrapWidth.get=function(){return this._wordWrapWidth};prototypeAccessors.wordWrapWidth.set=function(wordWrapWidth){if(this._wordWrapWidth!==wordWrapWidth){this._wordWrapWidth=wordWrapWidth;this.styleID++}};TextStyle.prototype.toFontString=function toFontString(){var fontSizeString=typeof this.fontSize==="number"?this.fontSize+"px":this.fontSize;var fontFamilies=this.fontFamily;if(!Array.isArray(this.fontFamily)){fontFamilies=this.fontFamily.split(",")}for(var i=fontFamilies.length-1;i>=0;i--){var fontFamily=fontFamilies[i].trim();if(!/([\"\'])[^\'\"]+\1/.test(fontFamily)&&genericFontFamilies.indexOf(fontFamily)<0){fontFamily='"'+fontFamily+'"'}fontFamilies[i]=fontFamily}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+fontSizeString+" "+fontFamilies.join(",")};Object.defineProperties(TextStyle.prototype,prototypeAccessors);function getSingleColor(color){if(typeof color==="number"){return utils.hex2string(color)}else if(typeof color==="string"){if(color.indexOf("0x")===0){color=color.replace("0x","#")}}return color}function getColor(color){if(!Array.isArray(color)){return getSingleColor(color)}else{for(var i=0;i<color.length;++i){color[i]=getSingleColor(color[i])}return color}}function areArraysEqual(array1,array2){if(!Array.isArray(array1)||!Array.isArray(array2)){return false}if(array1.length!==array2.length){return false}for(var i=0;i<array1.length;++i){if(array1[i]!==array2[i]){return false}}return true}function deepCopyProperties(target,source,propertyObj){for(var prop in propertyObj){if(Array.isArray(source[prop])){target[prop]=source[prop].slice()}else{target[prop]=source[prop]}}}var TextMetrics=function TextMetrics(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){this.text=text;this.style=style;this.width=width;this.height=height;this.lines=lines;this.lineWidths=lineWidths;this.lineHeight=lineHeight;this.maxLineWidth=maxLineWidth;this.fontProperties=fontProperties};TextMetrics.measureText=function measureText(text,style,wordWrap,canvas){if(canvas===void 0)canvas=TextMetrics._canvas;wordWrap=wordWrap===undefined||wordWrap===null?style.wordWrap:wordWrap;var font=style.toFontString();var fontProperties=TextMetrics.measureFont(font);if(fontProperties.fontSize===0){fontProperties.fontSize=style.fontSize;fontProperties.ascent=style.fontSize}var context=canvas.getContext("2d");context.font=font;var outputText=wordWrap?TextMetrics.wordWrap(text,style,canvas):text;var lines=outputText.split(/(?:\r\n|\r|\n)/);var lineWidths=new Array(lines.length);var maxLineWidth=0;for(var i=0;i<lines.length;i++){var lineWidth=context.measureText(lines[i]).width+(lines[i].length-1)*style.letterSpacing;lineWidths[i]=lineWidth;maxLineWidth=Math.max(maxLineWidth,lineWidth)}var width=maxLineWidth+style.strokeThickness;if(style.dropShadow){width+=style.dropShadowDistance}var lineHeight=style.lineHeight||fontProperties.fontSize+style.strokeThickness;var height=Math.max(lineHeight,fontProperties.fontSize+style.strokeThickness)+(lines.length-1)*(lineHeight+style.leading);if(style.dropShadow){height+=style.dropShadowDistance}return new TextMetrics(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties)};TextMetrics.wordWrap=function wordWrap(text,style,canvas){if(canvas===void 0)canvas=TextMetrics._canvas;var context=canvas.getContext("2d");var width=0;var line="";var lines="";var cache={};var letterSpacing=style.letterSpacing;var whiteSpace=style.whiteSpace;var collapseSpaces=TextMetrics.collapseSpaces(whiteSpace);var collapseNewlines=TextMetrics.collapseNewlines(whiteSpace);var canPrependSpaces=!collapseSpaces;var wordWrapWidth=style.wordWrapWidth+letterSpacing;var tokens=TextMetrics.tokenize(text);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(TextMetrics.isNewline(token)){if(!collapseNewlines){lines+=TextMetrics.addLine(line);canPrependSpaces=!collapseSpaces;line="";width=0;continue}token=" "}if(collapseSpaces){var currIsBreakingSpace=TextMetrics.isBreakingSpace(token);var lastIsBreakingSpace=TextMetrics.isBreakingSpace(line[line.length-1]);if(currIsBreakingSpace&&lastIsBreakingSpace){continue}}var tokenWidth=TextMetrics.getFromCache(token,letterSpacing,cache,context);if(tokenWidth>wordWrapWidth){if(line!==""){lines+=TextMetrics.addLine(line);line="";width=0}if(TextMetrics.canBreakWords(token,style.breakWords)){var characters=token.split("");for(var j=0;j<characters.length;j++){var char=characters[j];var k=1;while(characters[j+k]){var nextChar=characters[j+k];var lastChar=char[char.length-1];if(!TextMetrics.canBreakChars(lastChar,nextChar,token,j,style.breakWords)){char+=nextChar}else{break}k++}j+=char.length-1;var characterWidth=TextMetrics.getFromCache(char,letterSpacing,cache,context);if(characterWidth+width>wordWrapWidth){lines+=TextMetrics.addLine(line);canPrependSpaces=false;line="";width=0}line+=char;width+=characterWidth}}else{if(line.length>0){lines+=TextMetrics.addLine(line);line="";width=0}var isLastToken=i===tokens.length-1;lines+=TextMetrics.addLine(token,!isLastToken);canPrependSpaces=false;line="";width=0}}else{if(tokenWidth+width>wordWrapWidth){canPrependSpaces=false;lines+=TextMetrics.addLine(line);line="";width=0}if(line.length>0||!TextMetrics.isBreakingSpace(token)||canPrependSpaces){line+=token;width+=tokenWidth}}}lines+=TextMetrics.addLine(line,false);return lines};TextMetrics.addLine=function addLine(line,newLine){if(newLine===void 0)newLine=true;line=TextMetrics.trimRight(line);line=newLine?line+"\n":line;return line};TextMetrics.getFromCache=function getFromCache(key,letterSpacing,cache,context){var width=cache[key];if(width===undefined){var spacing=key.length*letterSpacing;width=context.measureText(key).width+spacing;cache[key]=width}return width};TextMetrics.collapseSpaces=function collapseSpaces(whiteSpace){return whiteSpace==="normal"||whiteSpace==="pre-line"};TextMetrics.collapseNewlines=function collapseNewlines(whiteSpace){return whiteSpace==="normal"};TextMetrics.trimRight=function trimRight(text){if(typeof text!=="string"){return""}for(var i=text.length-1;i>=0;i--){var char=text[i];if(!TextMetrics.isBreakingSpace(char)){break}text=text.slice(0,-1)}return text};TextMetrics.isNewline=function isNewline(char){if(typeof char!=="string"){return false}return TextMetrics._newlines.indexOf(char.charCodeAt(0))>=0};TextMetrics.isBreakingSpace=function isBreakingSpace(char){if(typeof char!=="string"){return false}return TextMetrics._breakingSpaces.indexOf(char.charCodeAt(0))>=0};TextMetrics.tokenize=function tokenize(text){var tokens=[];var token="";if(typeof text!=="string"){return tokens}for(var i=0;i<text.length;i++){var char=text[i];if(TextMetrics.isBreakingSpace(char)||TextMetrics.isNewline(char)){if(token!==""){tokens.push(token);token=""}tokens.push(char);continue}token+=char}if(token!==""){tokens.push(token)}return tokens};TextMetrics.canBreakWords=function canBreakWords(token,breakWords){return breakWords};TextMetrics.canBreakChars=function canBreakChars(char,nextChar,token,index,breakWords){return true};TextMetrics.measureFont=function measureFont(font){if(TextMetrics._fonts[font]){return TextMetrics._fonts[font]}var properties={};var canvas=TextMetrics._canvas;var context=TextMetrics._context;context.font=font;var metricsString=TextMetrics.METRICS_STRING+TextMetrics.BASELINE_SYMBOL;var width=Math.ceil(context.measureText(metricsString).width);var baseline=Math.ceil(context.measureText(TextMetrics.BASELINE_SYMBOL).width);var height=2*baseline;baseline=baseline*TextMetrics.BASELINE_MULTIPLIER|0;canvas.width=width;canvas.height=height;context.fillStyle="#f00";context.fillRect(0,0,width,height);context.font=font;context.textBaseline="alphabetic";context.fillStyle="#000";context.fillText(metricsString,0,baseline);var imagedata=context.getImageData(0,0,width,height).data;var pixels=imagedata.length;var line=width*4;var i=0;var idx=0;var stop=false;for(i=0;i<baseline;++i){for(var j=0;j<line;j+=4){if(imagedata[idx+j]!==255){stop=true;break}}if(!stop){idx+=line}else{break}}properties.ascent=baseline-i;idx=pixels-line;stop=false;for(i=height;i>baseline;--i){for(var j$1=0;j$1<line;j$1+=4){if(imagedata[idx+j$1]!==255){stop=true;break}}if(!stop){idx-=line}else{break}}properties.descent=i-baseline;properties.fontSize=properties.ascent+properties.descent;TextMetrics._fonts[font]=properties;return properties};TextMetrics.clearMetrics=function clearMetrics(font){if(font===void 0)font="";if(font){delete TextMetrics._fonts[font]}else{TextMetrics._fonts={}}};var canvas=document.createElement("canvas");canvas.width=canvas.height=10;TextMetrics._canvas=canvas;TextMetrics._context=canvas.getContext("2d");TextMetrics._fonts={};TextMetrics.METRICS_STRING="|q";TextMetrics.BASELINE_SYMBOL="M";TextMetrics.BASELINE_MULTIPLIER=1.4;TextMetrics._newlines=[10,13];TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var defaultDestroyOptions={texture:true,children:false,baseTexture:true};var Text=function(Sprite){function Text(text,style,canvas){canvas=canvas||document.createElement("canvas");canvas.width=3;canvas.height=3;var texture=core.Texture.from(canvas);texture.orig=new math.Rectangle;texture.trim=new math.Rectangle;Sprite.call(this,texture);this.canvas=canvas;this.context=this.canvas.getContext("2d");this._resolution=settings.settings.RESOLUTION;this._autoResolution=true;this._text=null;this._style=null;this._styleListener=null;this._font="";this.text=text;this.style=style;this.localStyleID=-1}if(Sprite)Text.__proto__=Sprite;Text.prototype=Object.create(Sprite&&Sprite.prototype);Text.prototype.constructor=Text;var prototypeAccessors={width:{configurable:true},height:{configurable:true},style:{configurable:true},text:{configurable:true},resolution:{configurable:true}};Text.prototype.updateText=function updateText(respectDirty){var style=this._style;if(this.localStyleID!==style.styleID){this.dirty=true;this.localStyleID=style.styleID}if(!this.dirty&&respectDirty){return}this._font=this._style.toFontString();var context=this.context;var measured=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas);var width=measured.width;var height=measured.height;var lines=measured.lines;var lineHeight=measured.lineHeight;var lineWidths=measured.lineWidths;var maxLineWidth=measured.maxLineWidth;var fontProperties=measured.fontProperties;this.canvas.width=Math.ceil((Math.max(1,width)+style.padding*2)*this._resolution);this.canvas.height=Math.ceil((Math.max(1,height)+style.padding*2)*this._resolution);context.scale(this._resolution,this._resolution);context.clearRect(0,0,this.canvas.width,this.canvas.height);context.font=this._font;context.strokeStyle=style.stroke;context.lineWidth=style.strokeThickness;context.textBaseline=style.textBaseline;context.lineJoin=style.lineJoin;context.miterLimit=style.miterLimit;var linePositionX;var linePositionY;if(style.dropShadow){var dropShadowColor=style.dropShadowColor;var rgb=utils.hex2rgb(typeof dropShadowColor==="number"?dropShadowColor:utils.string2hex(dropShadowColor));context.shadowColor="rgba("+rgb[0]*255+","+rgb[1]*255+","+rgb[2]*255+","+style.dropShadowAlpha+")";context.shadowBlur=style.dropShadowBlur;context.shadowOffsetX=Math.cos(style.dropShadowAngle)*style.dropShadowDistance;context.shadowOffsetY=Math.sin(style.dropShadowAngle)*style.dropShadowDistance}else{context.shadowColor=0;context.shadowBlur=0;context.shadowOffsetX=0;context.shadowOffsetY=0}context.fillStyle=this._generateFillStyle(style,lines);for(var i=0;i<lines.length;i++){linePositionX=style.strokeThickness/2;linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent;if(style.align==="right"){linePositionX+=maxLineWidth-lineWidths[i]}else if(style.align==="center"){linePositionX+=(maxLineWidth-lineWidths[i])/2}if(style.stroke&&style.strokeThickness){this.drawLetterSpacing(lines[i],linePositionX+style.padding,linePositionY+style.padding,true)}if(style.fill){this.drawLetterSpacing(lines[i],linePositionX+style.padding,linePositionY+style.padding)}}this.updateTexture()};Text.prototype.drawLetterSpacing=function drawLetterSpacing(text,x,y,isStroke){if(isStroke===void 0)isStroke=false;var style=this._style;var letterSpacing=style.letterSpacing;if(letterSpacing===0){if(isStroke){this.context.strokeText(text,x,y)}else{this.context.fillText(text,x,y)}return}var currentPosition=x;var stringArray=Array.from?Array.from(text):text.split("");for(var i=0;i<stringArray.length;++i){var currentChar=stringArray[i];if(isStroke){this.context.strokeText(currentChar,currentPosition,y)}else{this.context.fillText(currentChar,currentPosition,y)}currentPosition+=this.context.measureText(currentChar).width+letterSpacing}};Text.prototype.updateTexture=function updateTexture(){var canvas=this.canvas;if(this._style.trim){var trimmed=utils.trimCanvas(canvas);if(trimmed.data){canvas.width=trimmed.width;canvas.height=trimmed.height;this.context.putImageData(trimmed.data,0,0)}}var texture=this._texture;var style=this._style;var padding=style.trim?0:style.padding;var baseTexture=texture.baseTexture;texture.trim.width=texture._frame.width=canvas.width/this._resolution;texture.trim.height=texture._frame.height=canvas.height/this._resolution;texture.trim.x=-padding;texture.trim.y=-padding;texture.orig.width=texture._frame.width-padding*2;texture.orig.height=texture._frame.height-padding*2;this._onTextureUpdate();baseTexture.setRealSize(canvas.width,canvas.height,this._resolution);this.dirty=false};Text.prototype.render=function render(renderer){if(this._autoResolution&&this._resolution!==renderer.resolution){this._resolution=renderer.resolution;this.dirty=true}this.updateText(true);Sprite.prototype.render.call(this,renderer)};Text.prototype._renderCanvas=function _renderCanvas(renderer){if(this._autoResolution&&this._resolution!==renderer.resolution){this._resolution=renderer.resolution;this.dirty=true}this.updateText(true);Sprite.prototype._renderCanvas.call(this,renderer)};Text.prototype.getLocalBounds=function getLocalBounds(rect){this.updateText(true);return Sprite.prototype.getLocalBounds.call(this,rect)};Text.prototype._calculateBounds=function _calculateBounds(){this.updateText(true);this.calculateVertices();this._bounds.addQuad(this.vertexData)};Text.prototype._onStyleChange=function _onStyleChange(){this.dirty=true};Text.prototype._generateFillStyle=function _generateFillStyle(style,lines){if(!Array.isArray(style.fill)){return style.fill}var gradient;var totalIterations;var currentIteration;var stop;var width=this.canvas.width/this._resolution;var height=this.canvas.height/this._resolution;var fill=style.fill.slice();var fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length){var lengthPlus1=fill.length+1;for(var i=1;i<lengthPlus1;++i){fillGradientStops.push(i/lengthPlus1)}}fill.unshift(style.fill[0]);fillGradientStops.unshift(0);fill.push(style.fill[style.fill.length-1]);fillGradientStops.push(1);if(style.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){gradient=this.context.createLinearGradient(width/2,0,width/2,height);totalIterations=(fill.length+1)*lines.length;currentIteration=0;for(var i$1=0;i$1<lines.length;i$1++){currentIteration+=1;for(var j=0;j<fill.length;j++){if(typeof fillGradientStops[j]==="number"){stop=fillGradientStops[j]/lines.length+i$1/lines.length}else{stop=currentIteration/totalIterations}gradient.addColorStop(stop,fill[j]);currentIteration++}}}else{gradient=this.context.createLinearGradient(0,height/2,width,height/2);totalIterations=fill.length+1;currentIteration=1;for(var i$2=0;i$2<fill.length;i$2++){if(typeof fillGradientStops[i$2]==="number"){stop=fillGradientStops[i$2]}else{stop=currentIteration/totalIterations}gradient.addColorStop(stop,fill[i$2]);currentIteration++}}return gradient};Text.prototype.destroy=function destroy(options){if(typeof options==="boolean"){options={children:options}}options=Object.assign({},defaultDestroyOptions,options);Sprite.prototype.destroy.call(this,options);this.context=null;this.canvas=null;this._style=null};prototypeAccessors.width.get=function(){this.updateText(true);return Math.abs(this.scale.x)*this._texture.orig.width};prototypeAccessors.width.set=function(value){this.updateText(true);var s=utils.sign(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width;this._width=value};prototypeAccessors.height.get=function(){this.updateText(true);return Math.abs(this.scale.y)*this._texture.orig.height};prototypeAccessors.height.set=function(value){this.updateText(true);var s=utils.sign(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height;this._height=value};prototypeAccessors.style.get=function(){return this._style};prototypeAccessors.style.set=function(style){style=style||{};if(style instanceof TextStyle){this._style=style}else{this._style=new TextStyle(style)}this.localStyleID=-1;this.dirty=true};prototypeAccessors.text.get=function(){return this._text};prototypeAccessors.text.set=function(text){text=String(text===null||text===undefined?"":text);if(this._text===text){return}this._text=text;this.dirty=true};prototypeAccessors.resolution.get=function(){return this._resolution};prototypeAccessors.resolution.set=function(value){this._autoResolution=false;if(this._resolution===value){return}this._resolution=value;this.dirty=true};Object.defineProperties(Text.prototype,prototypeAccessors);return Text}(sprite.Sprite);exports.TEXT_GRADIENT=TEXT_GRADIENT;exports.Text=Text;exports.TextMetrics=TextMetrics;exports.TextStyle=TextStyle},{"@pixi/core":16,"@pixi/math":28,"@pixi/settings":38,"@pixi/sprite":41,"@pixi/utils":46}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var settings=require("@pixi/settings");settings.settings.TARGET_FPMS=.06;var UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50};var TickerListener=function TickerListener(fn,context,priority,once){if(context===void 0)context=null;if(priority===void 0)priority=0;if(once===void 0)once=false;this.fn=fn;this.context=context;this.priority=priority;this.once=once;this.next=null;this.previous=null;this._destroyed=false};TickerListener.prototype.match=function match(fn,context){context=context||null;return this.fn===fn&&this.context===context};TickerListener.prototype.emit=function emit(deltaTime){if(this.fn){if(this.context){this.fn.call(this.context,deltaTime)}else{this.fn(deltaTime)}}var redirect=this.next;if(this.once){this.destroy(true)}if(this._destroyed){this.next=null}return redirect};TickerListener.prototype.connect=function connect(previous){this.previous=previous;if(previous.next){previous.next.previous=this}this.next=previous.next;previous.next=this};TickerListener.prototype.destroy=function destroy(hard){if(hard===void 0)hard=false;this._destroyed=true;this.fn=null;this.context=null;if(this.previous){this.previous.next=this.next}if(this.next){this.next.previous=this.previous}var redirect=this.next;this.next=hard?null:redirect;this.previous=null;return redirect};var Ticker=function Ticker(){var this$1=this;this._head=new TickerListener(null,null,Infinity);this._requestId=null;this._maxElapsedMS=100;this._minElapsedMS=0;this.autoStart=false;this.deltaTime=1;this.deltaMS=1/settings.settings.TARGET_FPMS;this.elapsedMS=1/settings.settings.TARGET_FPMS;this.lastTime=-1;this.speed=1;this.started=false;this._protected=false;this._tick=function(time){this$1._requestId=null;if(this$1.started){this$1.update(time);if(this$1.started&&this$1._requestId===null&&this$1._head.next){this$1._requestId=requestAnimationFrame(this$1._tick)}}}};var prototypeAccessors={FPS:{configurable:true},minFPS:{configurable:true},maxFPS:{configurable:true}};var staticAccessors={shared:{configurable:true},system:{configurable:true}};Ticker.prototype._requestIfNeeded=function _requestIfNeeded(){if(this._requestId===null&&this._head.next){this.lastTime=performance.now();this._requestId=requestAnimationFrame(this._tick)}};Ticker.prototype._cancelIfNeeded=function _cancelIfNeeded(){if(this._requestId!==null){cancelAnimationFrame(this._requestId);this._requestId=null}};Ticker.prototype._startIfPossible=function _startIfPossible(){if(this.started){this._requestIfNeeded()}else if(this.autoStart){this.start()}};Ticker.prototype.add=function add(fn,context,priority){if(priority===void 0)priority=UPDATE_PRIORITY.NORMAL;return this._addListener(new TickerListener(fn,context,priority))};Ticker.prototype.addOnce=function addOnce(fn,context,priority){if(priority===void 0)priority=UPDATE_PRIORITY.NORMAL;return this._addListener(new TickerListener(fn,context,priority,true))};Ticker.prototype._addListener=function _addListener(listener){var current=this._head.next;var previous=this._head;if(!current){listener.connect(previous)}else{while(current){if(listener.priority>current.priority){listener.connect(previous);break}previous=current;current=current.next}if(!listener.previous){listener.connect(previous)}}this._startIfPossible();return this};Ticker.prototype.remove=function remove(fn,context){var listener=this._head.next;while(listener){if(listener.match(fn,context)){listener=listener.destroy()}else{listener=listener.next}}if(!this._head.next){this._cancelIfNeeded()}return this};Ticker.prototype.start=function start(){if(!this.started){this.started=true;this._requestIfNeeded()}};Ticker.prototype.stop=function stop(){if(this.started){this.started=false;this._cancelIfNeeded()}};Ticker.prototype.destroy=function destroy(){if(!this._protected){this.stop();var listener=this._head.next;while(listener){listener=listener.destroy(true)}this._head.destroy();this._head=null}};Ticker.prototype.update=function update(currentTime){if(currentTime===void 0)currentTime=performance.now();var elapsedMS;if(currentTime>this.lastTime){elapsedMS=this.elapsedMS=currentTime-this.lastTime;if(elapsedMS>this._maxElapsedMS){elapsedMS=this._maxElapsedMS}elapsedMS*=this.speed;if(this._minElapsedMS&&elapsedMS+1<this._minElapsedMS){return}this.deltaMS=elapsedMS;this.deltaTime=this.deltaMS*settings.settings.TARGET_FPMS;var head=this._head;var listener=head.next;while(listener){listener=listener.emit(this.deltaTime)}if(!head.next){this._cancelIfNeeded()}}else{this.deltaTime=this.deltaMS=this.elapsedMS=0}this.lastTime=currentTime};prototypeAccessors.FPS.get=function(){return 1e3/this.elapsedMS};prototypeAccessors.minFPS.get=function(){return 1e3/this._maxElapsedMS};prototypeAccessors.minFPS.set=function(fps){var minFPS=Math.min(this.maxFPS,fps);var minFPMS=Math.min(Math.max(0,minFPS)/1e3,settings.settings.TARGET_FPMS);this._maxElapsedMS=1/minFPMS};prototypeAccessors.maxFPS.get=function(){if(this._minElapsedMS){return 1e3/this._minElapsedMS}return settings.settings.TARGET_FPMS*1e3};prototypeAccessors.maxFPS.set=function(fps){if(fps/1e3>=settings.settings.TARGET_FPMS){this._minElapsedMS=0}else{var maxFPS=Math.max(this.minFPS,fps);var maxFPMS=Math.min(Math.max(1,maxFPS)/1e3,settings.settings.TARGET_FPMS);this._minElapsedMS=1/maxFPMS}};staticAccessors.shared.get=function(){if(!Ticker._shared){var shared=Ticker._shared=new Ticker;shared.autoStart=true;shared._protected=true}return Ticker._shared};staticAccessors.system.get=function(){if(!Ticker._system){var system=Ticker._system=new Ticker;system.autoStart=true;system._protected=true}return Ticker._system};Object.defineProperties(Ticker.prototype,prototypeAccessors);Object.defineProperties(Ticker,staticAccessors);var TickerPlugin=function TickerPlugin(){};TickerPlugin.init=function init(options){var this$1=this;options=Object.assign({autoStart:true,sharedTicker:false},options);Object.defineProperty(this,"ticker",{set:function set(ticker){if(this._ticker){this._ticker.remove(this.render,this)}this._ticker=ticker;if(ticker){ticker.add(this.render,this,UPDATE_PRIORITY.LOW)}},get:function get(){return this._ticker}});this.stop=function(){this$1._ticker.stop()};this.start=function(){this$1._ticker.start()};this._ticker=null;this.ticker=options.sharedTicker?Ticker.shared:new Ticker;if(options.autoStart){this.start()}};TickerPlugin.destroy=function destroy(){if(this._ticker){var oldTicker=this._ticker;this.ticker=null;oldTicker.destroy()}};exports.Ticker=Ticker;exports.TickerPlugin=TickerPlugin;exports.UPDATE_PRIORITY=UPDATE_PRIORITY},{"@pixi/settings":38}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var settings=require("@pixi/settings");var eventemitter3=_interopDefault(require("eventemitter3"));var earcut=_interopDefault(require("earcut"));var _url=_interopDefault(require("url"));var constants=require("@pixi/constants");settings.settings.RETINA_PREFIX=/@([0-9\.]+)x/;var saidHello=false;var VERSION="5.0.4";function skipHello(){saidHello=true}function sayHello(type){if(saidHello){return}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c PixiJS "+VERSION+" -  "+type+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,args)}else if(window.console){window.console.log("PixiJS "+VERSION+" - "+type+" - http://www.pixijs.com/")}saidHello=true}var supported;function isWebGLSupported(){if(typeof supported==="undefined"){supported=function supported(){var contextOptions={stencil:true,failIfMajorPerformanceCaveat:true};try{if(!window.WebGLRenderingContext){return false}var canvas=document.createElement("canvas");var gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions);var success=!!(gl&&gl.getContextAttributes().stencil);if(gl){var loseContext=gl.getExtension("WEBGL_lose_context");if(loseContext){loseContext.loseContext()}}gl=null;return success}catch(e){return false}}()}return supported}function hex2rgb(hex,out){out=out||[];out[0]=(hex>>16&255)/255;out[1]=(hex>>8&255)/255;out[2]=(hex&255)/255;return out}function hex2string(hex){hex=hex.toString(16);hex="000000".substr(0,6-hex.length)+hex;return"#"+hex}function string2hex(string){if(typeof string==="string"&&string[0]==="#"){string=string.substr(1)}return parseInt(string,16)}function rgb2hex(rgb){return(rgb[0]*255<<16)+(rgb[1]*255<<8)+(rgb[2]*255|0)}function mapPremultipliedBlendModes(){var pm=[];var npm=[];for(var i=0;i<32;i++){pm[i]=i;npm[i]=i}pm[constants.BLEND_MODES.NORMAL_NPM]=constants.BLEND_MODES.NORMAL;pm[constants.BLEND_MODES.ADD_NPM]=constants.BLEND_MODES.ADD;pm[constants.BLEND_MODES.SCREEN_NPM]=constants.BLEND_MODES.SCREEN;npm[constants.BLEND_MODES.NORMAL]=constants.BLEND_MODES.NORMAL_NPM;npm[constants.BLEND_MODES.ADD]=constants.BLEND_MODES.ADD_NPM;npm[constants.BLEND_MODES.SCREEN]=constants.BLEND_MODES.SCREEN_NPM;var array=[];array.push(npm);array.push(pm);return array}var premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(blendMode,premultiplied){return premultiplyBlendMode[premultiplied?1:0][blendMode]}function premultiplyRgba(rgb,alpha,out,premultiply){out=out||new Float32Array(4);if(premultiply||premultiply===undefined){out[0]=rgb[0]*alpha;out[1]=rgb[1]*alpha;out[2]=rgb[2]*alpha}else{out[0]=rgb[0];out[1]=rgb[1];out[2]=rgb[2]}out[3]=alpha;return out}function premultiplyTint(tint,alpha){if(alpha===1){return(alpha*255<<24)+tint}if(alpha===0){return 0}var R=tint>>16&255;var G=tint>>8&255;var B=tint&255;R=R*alpha+.5|0;G=G*alpha+.5|0;B=B*alpha+.5|0;return(alpha*255<<24)+(R<<16)+(G<<8)+B}function premultiplyTintToRgba(tint,alpha,out,premultiply){out=out||new Float32Array(4);out[0]=(tint>>16&255)/255;out[1]=(tint>>8&255)/255;out[2]=(tint&255)/255;if(premultiply||premultiply===undefined){out[0]*=alpha;out[1]*=alpha;out[2]*=alpha}out[3]=alpha;return out}function createIndicesForQuads(size){var totalIndices=size*6;var indices=new Uint16Array(totalIndices);for(var i=0,j=0;i<totalIndices;i+=6,j+=4){indices[i+0]=j+0;indices[i+1]=j+1;indices[i+2]=j+2;indices[i+3]=j+0;indices[i+4]=j+2;indices[i+5]=j+3}return indices}function removeItems(arr,startIdx,removeCount){var length=arr.length;var i;if(startIdx>=length||removeCount===0){return}removeCount=startIdx+removeCount>length?length-startIdx:removeCount;var len=length-removeCount;for(i=startIdx;i<len;++i){arr[i]=arr[i+removeCount]}arr.length=len}var nextUid=0;function uid(){return++nextUid}function sign(n){if(n===0){return 0}return n<0?-1:1}function nextPow2(v){v+=v===0;--v;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v+1}function isPow2(v){return!(v&v-1)&&!!v}function log2(v){var r=(v>65535)<<4;v>>>=r;var shift=(v>255)<<3;v>>>=shift;r|=shift;shift=(v>15)<<2;v>>>=shift;r|=shift;shift=(v>3)<<1;v>>>=shift;r|=shift;return r|v>>1}var ProgramCache={};var TextureCache=Object.create(null);var BaseTextureCache=Object.create(null);function destroyTextureCache(){var key;for(key in TextureCache){TextureCache[key].destroy()}for(key in BaseTextureCache){BaseTextureCache[key].destroy()}}function clearTextureCache(){var key;for(key in TextureCache){delete TextureCache[key]}for(key in BaseTextureCache){delete BaseTextureCache[key]}}function trimCanvas(canvas){var width=canvas.width;var height=canvas.height;var context=canvas.getContext("2d");var imageData=context.getImageData(0,0,width,height);var pixels=imageData.data;var len=pixels.length;var bound={top:null,left:null,right:null,bottom:null};var data=null;var i;var x;var y;for(i=0;i<len;i+=4){if(pixels[i+3]!==0){x=i/4%width;y=~~(i/4/width);if(bound.top===null){bound.top=y}if(bound.left===null){bound.left=x}else if(x<bound.left){bound.left=x}if(bound.right===null){bound.right=x+1}else if(bound.right<x){bound.right=x+1}if(bound.bottom===null){bound.bottom=y}else if(bound.bottom<y){bound.bottom=y}}}if(bound.top!==null){width=bound.right-bound.left;height=bound.bottom-bound.top+1;data=context.getImageData(bound.left,bound.top,width,height)}return{height:height,width:width,data:data}}var CanvasRenderTarget=function CanvasRenderTarget(width,height,resolution){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=resolution||settings.settings.RESOLUTION;this.resize(width,height)};var prototypeAccessors={width:{configurable:true},height:{configurable:true}};CanvasRenderTarget.prototype.clear=function clear(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};CanvasRenderTarget.prototype.resize=function resize(width,height){this.canvas.width=width*this.resolution;this.canvas.height=height*this.resolution};CanvasRenderTarget.prototype.destroy=function destroy(){this.context=null;this.canvas=null};prototypeAccessors.width.get=function(){return this.canvas.width};prototypeAccessors.width.set=function(val){this.canvas.width=val};prototypeAccessors.height.get=function(){return this.canvas.height};prototypeAccessors.height.set=function(val){this.canvas.height=val};Object.defineProperties(CanvasRenderTarget.prototype,prototypeAccessors);var DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function decomposeDataUri(dataUri){var dataUriMatch=DATA_URI.exec(dataUri);if(dataUriMatch){return{mediaType:dataUriMatch[1]?dataUriMatch[1].toLowerCase():undefined,subType:dataUriMatch[2]?dataUriMatch[2].toLowerCase():undefined,charset:dataUriMatch[3]?dataUriMatch[3].toLowerCase():undefined,encoding:dataUriMatch[4]?dataUriMatch[4].toLowerCase():undefined,data:dataUriMatch[5]}}return undefined}var tempAnchor;function determineCrossOrigin(url,loc){if(loc===void 0)loc=window.location;if(url.indexOf("data:")===0){return""}loc=loc||window.location;if(!tempAnchor){tempAnchor=document.createElement("a")}tempAnchor.href=url;url=_url.parse(tempAnchor.href);var samePort=!url.port&&loc.port===""||url.port===loc.port;if(url.hostname!==loc.hostname||!samePort||url.protocol!==loc.protocol){return"anonymous"}return""}function getResolutionOfUrl(url,defaultValue){var resolution=settings.settings.RETINA_PREFIX.exec(url);if(resolution){return parseFloat(resolution[1])}return defaultValue!==undefined?defaultValue:1}var warnings={};function deprecation(version,message,ignoreDepth){if(ignoreDepth===void 0)ignoreDepth=3;if(warnings[message]){return}var stack=(new Error).stack;if(typeof stack==="undefined"){console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version)}else{stack=stack.split("\n").splice(ignoreDepth).join("\n");if(console.groupCollapsed){console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",message+"\nDeprecated since v"+version);console.warn(stack);console.groupEnd()}else{console.warn("PixiJS Deprecation Warning: ",message+"\nDeprecated since v"+version);console.warn(stack)}}warnings[message]=true}Object.defineProperty(exports,"isMobile",{enumerable:true,get:function(){return settings.isMobile}});exports.EventEmitter=eventemitter3;exports.earcut=earcut;exports.url=_url;exports.BaseTextureCache=BaseTextureCache;exports.CanvasRenderTarget=CanvasRenderTarget;exports.DATA_URI=DATA_URI;exports.ProgramCache=ProgramCache;exports.TextureCache=TextureCache;exports.clearTextureCache=clearTextureCache;exports.correctBlendMode=correctBlendMode;exports.createIndicesForQuads=createIndicesForQuads;exports.decomposeDataUri=decomposeDataUri;exports.deprecation=deprecation;exports.destroyTextureCache=destroyTextureCache;exports.determineCrossOrigin=determineCrossOrigin;exports.getResolutionOfUrl=getResolutionOfUrl;exports.hex2rgb=hex2rgb;exports.hex2string=hex2string;exports.isPow2=isPow2;exports.isWebGLSupported=isWebGLSupported;exports.log2=log2;exports.nextPow2=nextPow2;exports.premultiplyBlendMode=premultiplyBlendMode;exports.premultiplyRgba=premultiplyRgba;exports.premultiplyTint=premultiplyTint;exports.premultiplyTintToRgba=premultiplyTintToRgba;exports.removeItems=removeItems;exports.rgb2hex=rgb2hex;exports.sayHello=sayHello;exports.sign=sign;exports.skipHello=skipHello;exports.string2hex=string2hex;exports.trimCanvas=trimCanvas;exports.uid=uid},{"@pixi/constants":15,"@pixi/settings":38,earcut:55,eventemitter3:71,url:11}],47:[function(require,module,exports){module.exports=after;function after(count,callback,err_cb){var bail=false;err_cb=err_cb||noop;proxy.count=count;return count===0?callback():proxy;function proxy(err,result){if(proxy.count<=0){throw new Error("after called too many times")}--proxy.count;if(err){bail=true;callback(err);callback=err_cb}else if(proxy.count===0&&!bail){callback(null,result)}}}function noop(){}},{}],48:[function(require,module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;start=start||0;end=end||bytes;if(arraybuffer.slice){return arraybuffer.slice(start,end)}if(start<0){start+=bytes}if(end<0){end+=bytes}if(end>bytes){end=bytes}if(start>=bytes||start>=end||bytes===0){return new ArrayBuffer(0)}var abv=new Uint8Array(arraybuffer);var result=new Uint8Array(end-start);for(var i=start,ii=0;i<end;i++,ii++){result[ii]=abv[i]}return result.buffer}},{}],49:[function(require,module,exports){module.exports=Backoff;function Backoff(opts){opts=opts||{};this.ms=opts.min||100;this.max=opts.max||1e4;this.factor=opts.factor||2;this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0;this.attempts=0}Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random();var deviation=Math.floor(rand*this.jitter*ms);ms=(Math.floor(rand*10)&1)==0?ms-deviation:ms+deviation}return Math.min(ms,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(min){this.ms=min};Backoff.prototype.setMax=function(max){this.max=max};Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}},{}],50:[function(require,module,exports){(function(){"use strict";var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var lookup=new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i}exports.encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),i,len=bytes.length,base64="";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};exports.decode=function(base64){var bufferLength=base64.length*.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){bufferLength--;if(base64[base64.length-2]==="="){bufferLength--}}var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4){encoded1=lookup[base64.charCodeAt(i)];encoded2=lookup[base64.charCodeAt(i+1)];encoded3=lookup[base64.charCodeAt(i+2)];encoded4=lookup[base64.charCodeAt(i+3)];bytes[p++]=encoded1<<2|encoded2>>4;bytes[p++]=(encoded2&15)<<4|encoded3>>2;bytes[p++]=(encoded3&3)<<6|encoded4&63}return arraybuffer}})()},{}],51:[function(require,module,exports){var BlobBuilder=typeof BlobBuilder!=="undefined"?BlobBuilder:typeof WebKitBlobBuilder!=="undefined"?WebKitBlobBuilder:typeof MSBlobBuilder!=="undefined"?MSBlobBuilder:typeof MozBlobBuilder!=="undefined"?MozBlobBuilder:false;var blobSupported=function(){try{var a=new Blob(["hi"]);return a.size===2}catch(e){return false}}();var blobSupportsArrayBufferView=blobSupported&&function(){try{var b=new Blob([new Uint8Array([1,2])]);return b.size===2}catch(e){return false}}();var blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;function mapArrayBufferViews(ary){return ary.map(function(chunk){if(chunk.buffer instanceof ArrayBuffer){var buf=chunk.buffer;if(chunk.byteLength!==buf.byteLength){var copy=new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf,chunk.byteOffset,chunk.byteLength));buf=copy.buffer}return buf}return chunk})}function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder;mapArrayBufferViews(ary).forEach(function(part){bb.append(part)});return options.type?bb.getBlob(options.type):bb.getBlob()}function BlobConstructor(ary,options){return new Blob(mapArrayBufferViews(ary),options||{})}if(typeof Blob!=="undefined"){BlobBuilderConstructor.prototype=Blob.prototype;BlobConstructor.prototype=Blob.prototype}module.exports=function(){if(blobSupported){return blobSupportsArrayBufferView?Blob:BlobConstructor}else if(blobBuilderSupported){return BlobBuilderConstructor}else{return undefined}}()},{}],52:[function(require,module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},{}],53:[function(require,module,exports){if(typeof module!=="undefined"){module.exports=Emitter}function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],54:[function(require,module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype;a.prototype=new fn;a.prototype.constructor=a}},{}],55:[function(require,module,exports){"use strict";module.exports=earcut;module.exports.default=earcut;function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,true),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles)outerNode=eliminateHoles(data,holeIndices,outerNode,dim);if(data.length>80*dim){minX=maxX=data[0];minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim){x=data[i];y=data[i+1];if(x<minX)minX=x;if(y<minY)minY=y;if(x>maxX)maxX=x;if(y>maxY)maxY=y}invSize=Math.max(maxX-minX,maxY-minY);invSize=invSize!==0?1/invSize:0}earcutLinked(outerNode,triangles,dim,minX,minY,invSize);return triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0){for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last)}else{for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last)}if(last&&equals(last,last.next)){removeNode(last);last=last.next}return last}function filterPoints(start,end){if(!start)return start;if(!end)end=start;var p=start,again;do{again=false;if(!p.steiner&&(equals(p,p.next)||area(p.prev,p,p.next)===0)){removeNode(p);p=end=p.prev;if(p===p.next)break;again=true}else{p=p.next}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(!ear)return;if(!pass&&invSize)indexCurve(ear,minX,minY,invSize);var stop=ear,prev,next;while(ear.prev!==ear.next){prev=ear.prev;next=ear.next;if(invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear)){triangles.push(prev.i/dim);triangles.push(ear.i/dim);triangles.push(next.i/dim);removeNode(ear);ear=next.next;stop=next.next;continue}ear=next;if(ear===stop){if(!pass){earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1)}else if(pass===1){ear=cureLocalIntersections(ear,triangles,dim);earcutLinked(ear,triangles,dim,minX,minY,invSize,2)}else if(pass===2){splitEarcut(ear,triangles,dim,minX,minY,invSize)}break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var p=ear.next.next;while(p!==ear.prev){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.next}return true}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y;var minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize);var p=ear.prevZ,n=ear.nextZ;while(p&&p.z>=minZ&&n&&n.z<=maxZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}while(p&&p.z>=minZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(n&&n.z<=maxZ){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}return true}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;if(!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)){triangles.push(a.i/dim);triangles.push(p.i/dim);triangles.push(b.i/dim);removeNode(p);removeNode(p.next);p=start=b}p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{var b=a.next.next;while(b!==a.prev){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);a=filterPoints(a,a.next);c=filterPoints(c,c.next);earcutLinked(a,triangles,dim,minX,minY,invSize);earcutLinked(c,triangles,dim,minX,minY,invSize);return}b=b.next}a=a.next}while(a!==start)}function eliminateHoles(data,holeIndices,outerNode,dim){var queue=[],i,len,start,end,list;for(i=0,len=holeIndices.length;i<len;i++){start=holeIndices[i]*dim;end=i<len-1?holeIndices[i+1]*dim:data.length;list=linkedList(data,start,end,dim,false);if(list===list.next)list.steiner=true;queue.push(getLeftmost(list))}queue.sort(compareX);for(i=0;i<queue.length;i++){eliminateHole(queue[i],outerNode);outerNode=filterPoints(outerNode,outerNode.next)}return outerNode}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){outerNode=findHoleBridge(hole,outerNode);if(outerNode){var b=splitPolygon(outerNode,hole);filterPoints(b,b.next)}}function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole.x,hy=hole.y,qx=-Infinity,m;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var stop=m,mx=m.x,my=m.y,tanMin=Infinity,tan;p=m.next;while(p!==stop){if(hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)){tan=Math.abs(hy-p.y)/(hx-p.x);if((tan<tanMin||tan===tanMin&&p.x>m.x)&&locallyInside(p,hole)){m=p;tanMin=tan}}p=p.next}return m}function indexCurve(start,minX,minY,invSize){var p=start;do{if(p.z===null)p.z=zOrder(p.x,p.y,minX,minY,invSize);p.prevZ=p.prev;p.nextZ=p.next;p=p.next}while(p!==start);p.prevZ.nextZ=null;p.prevZ=null;sortLinked(p)}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{p=list;list=null;tail=null;numMerges=0;while(p){numMerges++;q=p;pSize=0;for(i=0;i<inSize;i++){pSize++;q=q.nextZ;if(!q)break}qSize=inSize;while(pSize>0||qSize>0&&q){if(pSize!==0&&(qSize===0||!q||p.z<=q.z)){e=p;p=p.nextZ;pSize--}else{e=q;q=q.nextZ;qSize--}if(tail)tail.nextZ=e;else list=e;e.prevZ=tail;tail=e}p=q}tail.nextZ=null;inSize*=2}while(numMerges>1);return list}function zOrder(x,y,minX,minY,invSize){x=32767*(x-minX)*invSize;y=32767*(y-minY)*invSize;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1}function getLeftmost(start){var p=start,leftmost=start;do{if(p.x<leftmost.x||p.x===leftmost.x&&p.y<leftmost.y)leftmost=p;p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!intersectsPolygon(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){if(equals(p1,q1)&&equals(p2,q2)||equals(p1,q2)&&equals(p2,q1))return true;return area(p1,q1,p2)>0!==area(p1,q1,q2)>0&&area(p2,q2,p1)>0!==area(p2,q2,q1)>0}function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return true;p=p.next}while(p!==a);return false}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function middleInside(a,b){var p=a,inside=false,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{if(p.y>py!==p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x)inside=!inside;p=p.next}while(p!==a);return inside}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);if(!last){p.prev=p;p.next=p}else{p.next=last.next;p.prev=last;last.next.prev=p;last.next=p}return p}function removeNode(p){p.next.prev=p.prev;p.prev.next=p.next;if(p.prevZ)p.prevZ.nextZ=p.nextZ;if(p.nextZ)p.nextZ.prevZ=p.prevZ}function Node(i,x,y){this.i=i;this.x=x;this.y=y;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length;var outerLen=hasHoles?holeIndices[0]*dim:data.length;var polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles){for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim;var end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim;var b=triangles[i+1]*dim;var c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return polygonArea===0&&trianglesArea===0?0:Math.abs((trianglesArea-polygonArea)/polygonArea)};function signedArea(data,start,end,dim){var sum=0;for(var i=start,j=end-dim;i<end;i+=dim){sum+=(data[j]-data[i])*(data[i+1]+data[j+1]);j=i}return sum}earcut.flatten=function(data){var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0;for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d])}if(i>0){holeIndex+=data[i-1].length;result.holes.push(holeIndex)}}return result}},{}],56:[function(require,module,exports){module.exports=require("./socket");module.exports.parser=require("engine.io-parser")},{"./socket":57,"engine.io-parser":67}],57:[function(require,module,exports){var transports=require("./transports/index");var Emitter=require("component-emitter");var debug=require("debug")("engine.io-client:socket");var index=require("indexof");var parser=require("engine.io-parser");var parseuri=require("parseuri");var parseqs=require("parseqs");module.exports=Socket;function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);opts=opts||{};if(uri&&"object"===typeof uri){opts=uri;uri=null}if(uri){uri=parseuri(uri);opts.hostname=uri.host;opts.secure=uri.protocol==="https"||uri.protocol==="wss";opts.port=uri.port;if(uri.query)opts.query=uri.query}else if(opts.host){opts.hostname=parseuri(opts.host).host}this.secure=null!=opts.secure?opts.secure:typeof location!=="undefined"&&"https:"===location.protocol;if(opts.hostname&&!opts.port){opts.port=this.secure?"443":"80"}this.agent=opts.agent||false;this.hostname=opts.hostname||(typeof location!=="undefined"?location.hostname:"localhost");this.port=opts.port||(typeof location!=="undefined"&&location.port?location.port:this.secure?443:80);this.query=opts.query||{};if("string"===typeof this.query)this.query=parseqs.decode(this.query);this.upgrade=false!==opts.upgrade;this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!opts.forceJSONP;this.jsonp=false!==opts.jsonp;this.forceBase64=!!opts.forceBase64;this.enablesXDR=!!opts.enablesXDR;this.timestampParam=opts.timestampParam||"t";this.timestampRequests=opts.timestampRequests;this.transports=opts.transports||["polling","websocket"];this.transportOptions=opts.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=opts.policyPort||843;this.rememberUpgrade=opts.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades;this.perMessageDeflate=false!==opts.perMessageDeflate?opts.perMessageDeflate||{}:false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024}this.pfx=opts.pfx||null;this.key=opts.key||null;this.passphrase=opts.passphrase||null;this.cert=opts.cert||null;this.ca=opts.ca||null;this.ciphers=opts.ciphers||null;this.rejectUnauthorized=opts.rejectUnauthorized===undefined?true:opts.rejectUnauthorized;this.forceNode=!!opts.forceNode;this.isReactNative=typeof navigator!=="undefined"&&typeof navigator.product==="string"&&navigator.product.toLowerCase()==="reactnative";if(typeof self==="undefined"||this.isReactNative){if(opts.extraHeaders&&Object.keys(opts.extraHeaders).length>0){this.extraHeaders=opts.extraHeaders}if(opts.localAddress){this.localAddress=opts.localAddress}}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingIntervalTimer=null;this.pingTimeoutTimer=null;this.open()}Socket.priorWebsocketSuccess=false;Emitter(Socket.prototype);Socket.protocol=parser.protocol;Socket.Socket=Socket;Socket.Transport=require("./transport");Socket.transports=require("./transports/index");Socket.parser=require("engine.io-parser");Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol;query.transport=name;var options=this.transportOptions[name]||{};if(this.id)query.sid=this.id;var transport=new transports[name]({query:query,socket:this,agent:options.agent||this.agent,hostname:options.hostname||this.hostname,port:options.port||this.port,secure:options.secure||this.secure,path:options.path||this.path,forceJSONP:options.forceJSONP||this.forceJSONP,jsonp:options.jsonp||this.jsonp,forceBase64:options.forceBase64||this.forceBase64,enablesXDR:options.enablesXDR||this.enablesXDR,timestampRequests:options.timestampRequests||this.timestampRequests,timestampParam:options.timestampParam||this.timestampParam,policyPort:options.policyPort||this.policyPort,pfx:options.pfx||this.pfx,key:options.key||this.key,passphrase:options.passphrase||this.passphrase,cert:options.cert||this.cert,ca:options.ca||this.ca,ciphers:options.ciphers||this.ciphers,rejectUnauthorized:options.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:options.perMessageDeflate||this.perMessageDeflate,extraHeaders:options.extraHeaders||this.extraHeaders,forceNode:options.forceNode||this.forceNode,localAddress:options.localAddress||this.localAddress,requestTimeout:options.requestTimeout||this.requestTimeout,protocols:options.protocols||void 0,isReactNative:this.isReactNative});return transport};function clone(obj){var o={};for(var i in obj){if(obj.hasOwnProperty(i)){o[i]=obj[i]}}return o}Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){transport="websocket"}else if(0===this.transports.length){var self=this;setTimeout(function(){self.emit("error","No transports available")},0);return}else{transport=this.transports[0]}this.readyState="opening";try{transport=this.createTransport(transport)}catch(e){this.transports.shift();this.open();return}transport.open();this.setTransport(transport)};Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;if(this.transport){debug("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=transport;transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})};Socket.prototype.probe=function(name){debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1});var failed=false;var self=this;Socket.priorWebsocketSuccess=false;function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}if(failed)return;debug('probe transport "%s" opened',name);transport.send([{type:"ping",data:"probe"}]);transport.once("packet",function(msg){if(failed)return;if("pong"===msg.type&&"probe"===msg.data){debug('probe transport "%s" pong',name);self.upgrading=true;self.emit("upgrading",transport);if(!transport)return;Socket.priorWebsocketSuccess="websocket"===transport.name;debug('pausing current transport "%s"',self.transport.name);self.transport.pause(function(){if(failed)return;if("closed"===self.readyState)return;debug("changing transport and sending upgrade packet");cleanup();self.setTransport(transport);transport.send([{type:"upgrade"}]);self.emit("upgrade",transport);transport=null;self.upgrading=false;self.flush()})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name;self.emit("upgradeError",err)}})}function freezeTransport(){if(failed)return;failed=true;cleanup();transport.close();transport=null}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name;freezeTransport();debug('probe transport "%s" failed because of error: %s',name,err);self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){if(transport&&to.name!==transport.name){debug('"%s" works - aborting "%s"',to.name,transport.name);freezeTransport()}}function cleanup(){transport.removeListener("open",onTransportOpen);transport.removeListener("error",onerror);transport.removeListener("close",onTransportClose);self.removeListener("close",onclose);self.removeListener("upgrading",onupgrade)}transport.once("open",onTransportOpen);transport.once("error",onerror);transport.once("close",onTransportClose);this.once("close",onclose);this.once("upgrading",onupgrade);transport.open()};Socket.prototype.onOpen=function(){debug("socket open");this.readyState="open";Socket.priorWebsocketSuccess="websocket"===this.transport.name;this.emit("open");this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++){this.probe(this.upgrades[i])}}};Socket.prototype.onPacket=function(packet){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug('socket receive: type "%s", data "%s"',packet.type,packet.data);this.emit("packet",packet);this.emit("heartbeat");switch(packet.type){case"open":this.onHandshake(JSON.parse(packet.data));break;case"pong":this.setPing();this.emit("pong");break;case"error":var err=new Error("server error");err.code=packet.data;this.onError(err);break;case"message":this.emit("data",packet.data);this.emit("message",packet.data);break}}else{debug('packet received with socket readyState "%s"',this.readyState)}};Socket.prototype.onHandshake=function(data){this.emit("handshake",data);this.id=data.sid;this.transport.query.sid=data.sid;this.upgrades=this.filterUpgrades(data.upgrades);this.pingInterval=data.pingInterval;this.pingTimeout=data.pingTimeout;this.onOpen();if("closed"===this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){if("closed"===self.readyState)return;self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)};Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout)},self.pingInterval)};Socket.prototype.ping=function(){var self=this;this.sendPacket("ping",function(){self.emit("ping")})};Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit("drain")}else{this.flush()}};Socket.prototype.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){debug("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};Socket.prototype.write=Socket.prototype.send=function(msg,options,fn){this.sendPacket("message",msg,options,fn);return this};Socket.prototype.sendPacket=function(type,data,options,fn){if("function"===typeof data){fn=data;data=undefined}if("function"===typeof options){fn=options;options=null}if("closing"===this.readyState||"closed"===this.readyState){return}options=options||{};options.compress=false!==options.compress;var packet={type:type,data:data,options:options};this.emit("packetCreate",packet);this.writeBuffer.push(packet);if(fn)this.once("flush",fn);this.flush()};Socket.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var self=this;if(this.writeBuffer.length){this.once("drain",function(){if(this.upgrading){waitForUpgrade()}else{close()}})}else if(this.upgrading){waitForUpgrade()}else{close()}}function close(){self.onClose("forced close");debug("socket closing - telling transport to close");self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose);self.removeListener("upgradeError",cleanupAndClose);close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose);self.once("upgradeError",cleanupAndClose)}return this};Socket.prototype.onError=function(err){debug("socket error %j",err);Socket.priorWebsocketSuccess=false;this.emit("error",err);this.onClose("transport error",err)};Socket.prototype.onClose=function(reason,desc){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",reason,desc);self.writeBuffer=[];self.prevBufferLen=0}};Socket.prototype.filterUpgrades=function(upgrades){var filteredUpgrades=[];for(var i=0,j=upgrades.length;i<j;i++){if(~index(this.transports,upgrades[i]))filteredUpgrades.push(upgrades[i])}return filteredUpgrades}},{"./transport":58,"./transports/index":59,"component-emitter":53,debug:65,"engine.io-parser":67,indexof:74,parseqs:81,parseuri:82}],58:[function(require,module,exports){var parser=require("engine.io-parser");var Emitter=require("component-emitter");module.exports=Transport;function Transport(opts){this.path=opts.path;this.hostname=opts.hostname;this.port=opts.port;this.secure=opts.secure;this.query=opts.query;this.timestampParam=opts.timestampParam;this.timestampRequests=opts.timestampRequests;this.readyState="";this.agent=opts.agent||false;this.socket=opts.socket;this.enablesXDR=opts.enablesXDR;this.pfx=opts.pfx;this.key=opts.key;this.passphrase=opts.passphrase;this.cert=opts.cert;this.ca=opts.ca;this.ciphers=opts.ciphers;this.rejectUnauthorized=opts.rejectUnauthorized;this.forceNode=opts.forceNode;this.isReactNative=opts.isReactNative;this.extraHeaders=opts.extraHeaders;this.localAddress=opts.localAddress}Emitter(Transport.prototype);Transport.prototype.onError=function(msg,desc){var err=new Error(msg);err.type="TransportError";err.description=desc;this.emit("error",err);return this};Transport.prototype.open=function(){if("closed"===this.readyState||""===this.readyState){this.readyState="opening";this.doOpen()}return this};Transport.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.doClose();this.onClose()}return this};Transport.prototype.send=function(packets){if("open"===this.readyState){this.write(packets)}else{throw new Error("Transport not open")}};Transport.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)};Transport.prototype.onPacket=function(packet){this.emit("packet",packet)};Transport.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":53,"engine.io-parser":67}],59:[function(require,module,exports){var XMLHttpRequest=require("xmlhttprequest-ssl");var XHR=require("./polling-xhr");var JSONP=require("./polling-jsonp");var websocket=require("./websocket");exports.polling=polling;exports.websocket=websocket;function polling(opts){var xhr;var xd=false;var xs=false;var jsonp=false!==opts.jsonp;if(typeof location!=="undefined"){var isSSL="https:"===location.protocol;var port=location.port;if(!port){port=isSSL?443:80}xd=opts.hostname!==location.hostname||port!==opts.port;xs=opts.secure!==isSSL}opts.xdomain=xd;opts.xscheme=xs;xhr=new XMLHttpRequest(opts);if("open"in xhr&&!opts.forceJSONP){return new XHR(opts)}else{if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}}},{"./polling-jsonp":60,"./polling-xhr":61,"./websocket":63,"xmlhttprequest-ssl":64}],60:[function(require,module,exports){(function(global){var Polling=require("./polling");var inherit=require("component-inherit");module.exports=JSONPPolling;var rNewline=/\n/g;var rEscapedNewline=/\\n/g;var callbacks;function empty(){}function glob(){return typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{}}function JSONPPolling(opts){Polling.call(this,opts);this.query=this.query||{};if(!callbacks){var global=glob();callbacks=global.___eio=global.___eio||[]}this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)});this.query.j=this.index;if(typeof addEventListener==="function"){addEventListener("beforeunload",function(){if(self.script)self.script.onerror=empty},false)}}inherit(JSONPPolling,Polling);JSONPPolling.prototype.supportsBinary=false;JSONPPolling.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null;this.iframe=null}Polling.prototype.doClose.call(this)};JSONPPolling.prototype.doPoll=function(){var self=this;var script=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}script.async=true;script.src=this.uri();script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];if(insertAt){insertAt.parentNode.insertBefore(script,insertAt)}else{(document.head||document.body).appendChild(script)}this.script=script;var isUAgecko="undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent);if(isUAgecko){setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe);document.body.removeChild(iframe)},100)}};JSONPPolling.prototype.doWrite=function(data,fn){var self=this;if(!this.form){var form=document.createElement("form");var area=document.createElement("textarea");var id=this.iframeId="eio_iframe_"+this.index;var iframe;form.className="socketio";form.style.position="absolute";form.style.top="-1000px";form.style.left="-1000px";form.target=id;form.method="POST";form.setAttribute("accept-charset","utf-8");area.name="d";form.appendChild(area);document.body.appendChild(form);this.form=form;this.area=area}this.form.action=this.uri();function complete(){initIframe();fn()}function initIframe(){if(self.iframe){try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe");iframe.name=self.iframeId;iframe.src="javascript:0"}iframe.id=self.iframeId;self.form.appendChild(iframe);self.iframe=iframe}initIframe();data=data.replace(rEscapedNewline,"\\\n");this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(self.iframe.readyState==="complete"){complete()}}}else{this.iframe.onload=complete}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling":62,"component-inherit":54}],61:[function(require,module,exports){var XMLHttpRequest=require("xmlhttprequest-ssl");var Polling=require("./polling");var Emitter=require("component-emitter");var inherit=require("component-inherit");var debug=require("debug")("engine.io-client:polling-xhr");module.exports=XHR;module.exports.Request=Request;function empty(){}function XHR(opts){Polling.call(this,opts);this.requestTimeout=opts.requestTimeout;this.extraHeaders=opts.extraHeaders;if(typeof location!=="undefined"){var isSSL="https:"===location.protocol;var port=location.port;if(!port){port=isSSL?443:80}this.xd=typeof location!=="undefined"&&opts.hostname!==location.hostname||port!==opts.port;this.xs=opts.secure!==isSSL}}inherit(XHR,Polling);XHR.prototype.supportsBinary=true;XHR.prototype.request=function(opts){opts=opts||{};opts.uri=this.uri();opts.xd=this.xd;opts.xs=this.xs;opts.agent=this.agent||false;opts.supportsBinary=this.supportsBinary;opts.enablesXDR=this.enablesXDR;opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;opts.requestTimeout=this.requestTimeout;opts.extraHeaders=this.extraHeaders;return new Request(opts)};XHR.prototype.doWrite=function(data,fn){var isBinary=typeof data!=="string"&&data!==undefined;var req=this.request({method:"POST",data:data,isBinary:isBinary});var self=this;req.on("success",fn);req.on("error",function(err){self.onError("xhr post error",err)});this.sendXhr=req};XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request();var self=this;req.on("data",function(data){self.onData(data)});req.on("error",function(err){self.onError("xhr poll error",err)});this.pollXhr=req};function Request(opts){this.method=opts.method||"GET";this.uri=opts.uri;this.xd=!!opts.xd;this.xs=!!opts.xs;this.async=false!==opts.async;this.data=undefined!==opts.data?opts.data:null;this.agent=opts.agent;this.isBinary=opts.isBinary;this.supportsBinary=opts.supportsBinary;this.enablesXDR=opts.enablesXDR;this.requestTimeout=opts.requestTimeout;this.pfx=opts.pfx;this.key=opts.key;this.passphrase=opts.passphrase;this.cert=opts.cert;this.ca=opts.ca;this.ciphers=opts.ciphers;this.rejectUnauthorized=opts.rejectUnauthorized;this.extraHeaders=opts.extraHeaders;this.create()}Emitter(Request.prototype);Request.prototype.create=function(){var opts={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;var xhr=this.xhr=new XMLHttpRequest(opts);var self=this;try{debug("xhr open %s: %s",this.method,this.uri);xhr.open(this.method,this.uri,this.async);try{if(this.extraHeaders){xhr.setDisableHeaderCheck&&xhr.setDisableHeaderCheck(true);for(var i in this.extraHeaders){if(this.extraHeaders.hasOwnProperty(i)){xhr.setRequestHeader(i,this.extraHeaders[i])}}}}catch(e){}if("POST"===this.method){try{if(this.isBinary){xhr.setRequestHeader("Content-type","application/octet-stream")}else{xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}try{xhr.setRequestHeader("Accept","*/*")}catch(e){}if("withCredentials"in xhr){xhr.withCredentials=true}if(this.requestTimeout){xhr.timeout=this.requestTimeout}if(this.hasXDR()){xhr.onload=function(){self.onLoad()};xhr.onerror=function(){self.onError(xhr.responseText)}}else{xhr.onreadystatechange=function(){if(xhr.readyState===2){try{var contentType=xhr.getResponseHeader("Content-Type");if(self.supportsBinary&&contentType==="application/octet-stream"){xhr.responseType="arraybuffer"}}catch(e){}}if(4!==xhr.readyState)return;if(200===xhr.status||1223===xhr.status){self.onLoad()}else{setTimeout(function(){self.onError(xhr.status)},0)}}}debug("xhr data %s",this.data);xhr.send(this.data)}catch(e){setTimeout(function(){self.onError(e)},0);return}if(typeof document!=="undefined"){this.index=Request.requestsCount++;Request.requests[this.index]=this}};Request.prototype.onSuccess=function(){this.emit("success");this.cleanup()};Request.prototype.onData=function(data){this.emit("data",data);this.onSuccess()};Request.prototype.onError=function(err){this.emit("error",err);this.cleanup(true)};Request.prototype.cleanup=function(fromError){if("undefined"===typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=empty}else{this.xhr.onreadystatechange=empty}if(fromError){try{this.xhr.abort()}catch(e){}}if(typeof document!=="undefined"){delete Request.requests[this.index]}this.xhr=null};Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type")}catch(e){}if(contentType==="application/octet-stream"){data=this.xhr.response||this.xhr.responseText}else{data=this.xhr.responseText}}catch(e){this.onError(e)}if(null!=data){this.onData(data)}};Request.prototype.hasXDR=function(){return typeof XDomainRequest!=="undefined"&&!this.xs&&this.enablesXDR};Request.prototype.abort=function(){this.cleanup()};Request.requestsCount=0;Request.requests={};if(typeof document!=="undefined"){if(typeof attachEvent==="function"){attachEvent("onunload",unloadHandler)}else if(typeof addEventListener==="function"){var terminationEvent="onpagehide"in self?"pagehide":"unload";addEventListener(terminationEvent,unloadHandler,false)}}function unloadHandler(){for(var i in Request.requests){if(Request.requests.hasOwnProperty(i)){Request.requests[i].abort()}}}},{"./polling":62,"component-emitter":53,"component-inherit":54,debug:65,"xmlhttprequest-ssl":64}],62:[function(require,module,exports){var Transport=require("../transport");var parseqs=require("parseqs");var parser=require("engine.io-parser");var inherit=require("component-inherit");var yeast=require("yeast");var debug=require("debug")("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=require("xmlhttprequest-ssl");var xhr=new XMLHttpRequest({xdomain:false});return null!=xhr.responseType}();function Polling(opts){var forceBase64=opts&&opts.forceBase64;if(!hasXHR2||forceBase64){this.supportsBinary=false}Transport.call(this,opts)}inherit(Polling,Transport);Polling.prototype.name="polling";Polling.prototype.doOpen=function(){this.poll()};Polling.prototype.pause=function(onPause){var self=this;this.readyState="pausing";function pause(){debug("paused");self.readyState="paused";onPause()}if(this.polling||!this.writable){var total=0;if(this.polling){debug("we are currently polling - waiting to pause");total++;this.once("pollComplete",function(){debug("pre-pause polling complete");--total||pause()})}if(!this.writable){debug("we are currently writing - waiting to pause");total++;this.once("drain",function(){debug("pre-pause writing complete");--total||pause()})}}else{pause()}};Polling.prototype.poll=function(){debug("polling");this.polling=true;this.doPoll();this.emit("poll")};Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);var callback=function(packet,index,total){if("opening"===self.readyState){self.onOpen()}if("close"===packet.type){self.onClose();return false}self.onPacket(packet)};parser.decodePayload(data,this.socket.binaryType,callback);if("closed"!==this.readyState){this.polling=false;this.emit("pollComplete");if("open"===this.readyState){this.poll()}else{debug('ignoring poll - transport state "%s"',this.readyState)}}};Polling.prototype.doClose=function(){var self=this;function close(){debug("writing close packet");self.write([{type:"close"}])}if("open"===this.readyState){debug("transport open - closing");close()}else{debug("transport not open - deferring close");this.once("open",close)}};Polling.prototype.write=function(packets){var self=this;this.writable=false;var callbackfn=function(){self.writable=true;self.emit("drain")};parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})};Polling.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"https":"http";var port="";if(false!==this.timestampRequests){query[this.timestampParam]=yeast()}if(!this.supportsBinary&&!query.sid){query.b64=1}query=parseqs.encode(query);if(this.port&&("https"===schema&&Number(this.port)!==443||"http"===schema&&Number(this.port)!==80)){port=":"+this.port}if(query.length){query="?"+query}var ipv6=this.hostname.indexOf(":")!==-1;return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query}},{"../transport":58,"component-inherit":54,debug:65,"engine.io-parser":67,parseqs:81,"xmlhttprequest-ssl":64,yeast:102}],63:[function(require,module,exports){(function(Buffer){var Transport=require("../transport");var parser=require("engine.io-parser");var parseqs=require("parseqs");var inherit=require("component-inherit");var yeast=require("yeast");var debug=require("debug")("engine.io-client:websocket");var BrowserWebSocket,NodeWebSocket;if(typeof WebSocket!=="undefined"){BrowserWebSocket=WebSocket}else if(typeof self!=="undefined"){BrowserWebSocket=self.WebSocket||self.MozWebSocket}else{try{NodeWebSocket=require("ws")}catch(e){}}var WebSocketImpl=BrowserWebSocket||NodeWebSocket;module.exports=WS;function WS(opts){var forceBase64=opts&&opts.forceBase64;if(forceBase64){this.supportsBinary=false}this.perMessageDeflate=opts.perMessageDeflate;this.usingBrowserWebSocket=BrowserWebSocket&&!opts.forceNode;this.protocols=opts.protocols;if(!this.usingBrowserWebSocket){WebSocketImpl=NodeWebSocket}Transport.call(this,opts)}inherit(WS,Transport);WS.prototype.name="websocket";WS.prototype.supportsBinary=true;WS.prototype.doOpen=function(){if(!this.check()){return}var uri=this.uri();var protocols=this.protocols;var opts={agent:this.agent,perMessageDeflate:this.perMessageDeflate};opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){opts.headers=this.extraHeaders}if(this.localAddress){opts.localAddress=this.localAddress}try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?protocols?new WebSocketImpl(uri,protocols):new WebSocketImpl(uri):new WebSocketImpl(uri,protocols,opts)}catch(err){return this.emit("error",err)}if(this.ws.binaryType===undefined){this.supportsBinary=false}if(this.ws.supports&&this.ws.supports.binary){this.supportsBinary=true;this.ws.binaryType="nodebuffer"}else{this.ws.binaryType="arraybuffer"}this.addEventListeners()};WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()};this.ws.onclose=function(){self.onClose()};this.ws.onmessage=function(ev){self.onData(ev.data)};this.ws.onerror=function(e){self.onError("websocket error",e)}};WS.prototype.write=function(packets){var self=this;this.writable=false;var total=packets.length;for(var i=0,l=total;i<l;i++){(function(packet){parser.encodePacket(packet,self.supportsBinary,function(data){if(!self.usingBrowserWebSocket){var opts={};if(packet.options){opts.compress=packet.options.compress}if(self.perMessageDeflate){var len="string"===typeof data?Buffer.byteLength(data):data.length;if(len<self.perMessageDeflate.threshold){opts.compress=false}}}try{if(self.usingBrowserWebSocket){self.ws.send(data)}else{self.ws.send(data,opts)}}catch(e){debug("websocket closed before onclose event")}--total||done()})})(packets[i])}function done(){self.emit("flush");setTimeout(function(){self.writable=true;self.emit("drain")},0)}};WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)};WS.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};WS.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"wss":"ws";var port="";if(this.port&&("wss"===schema&&Number(this.port)!==443||"ws"===schema&&Number(this.port)!==80)){port=":"+this.port}if(this.timestampRequests){query[this.timestampParam]=yeast()}if(!this.supportsBinary){query.b64=1}query=parseqs.encode(query);if(query.length){query="?"+query}var ipv6=this.hostname.indexOf(":")!==-1;return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query};WS.prototype.check=function(){return!!WebSocketImpl&&!("__initialize"in WebSocketImpl&&this.name===WS.prototype.name)}}).call(this,require("buffer").Buffer)},{"../transport":58,buffer:3,"component-inherit":54,debug:65,"engine.io-parser":67,parseqs:81,ws:2,yeast:102}],64:[function(require,module,exports){var hasCORS=require("has-cors");module.exports=function(opts){var xdomain=opts.xdomain;var xscheme=opts.xscheme;var enablesXDR=opts.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!xdomain||hasCORS)){return new XMLHttpRequest}}catch(e){}try{if("undefined"!==typeof XDomainRequest&&!xscheme&&enablesXDR){return new XDomainRequest}}catch(e){}if(!xdomain){try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}},{"has-cors":73}],65:[function(require,module,exports){(function(process){exports=module.exports=require("./debug");exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&window.process.type==="renderer"){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}exports.formatters.j=function(v){try{return JSON.stringify(v)}catch(err){return"[UnexpectedJSONParseError]: "+err.message}};function formatArgs(args){var useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff);if(!useColors)return;var c="color: "+this.color;args.splice(1,0,c,"color: inherit");var index=0;var lastC=0;args[0].replace(/%[a-zA-Z%]/g,function(match){if("%%"===match)return;index++;if("%c"===match){lastC=index}});args.splice(lastC,0,c)}function log(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{if(null==namespaces){exports.storage.removeItem("debug")}else{exports.storage.debug=namespaces}}catch(e){}}function load(){var r;try{r=exports.storage.debug}catch(e){}if(!r&&typeof process!=="undefined"&&"env"in process){r=process.env.DEBUG}return r}exports.enable(load());function localstorage(){try{return window.localStorage}catch(e){}}}).call(this,require("_process"))},{"./debug":66,_process:5}],66:[function(require,module,exports){exports=module.exports=createDebug.debug=createDebug["default"]=createDebug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=require("ms");exports.instances=[];exports.names=[];exports.skips=[];exports.formatters={};function selectColor(namespace){var hash=0,i;for(i in namespace){hash=(hash<<5)-hash+namespace.charCodeAt(i);hash|=0}return exports.colors[Math.abs(hash)%exports.colors.length]}function createDebug(namespace){var prevTime;function debug(){if(!debug.enabled)return;var self=debug;var curr=+new Date;var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;var args=new Array(arguments.length);for(var i=0;i<args.length;i++){args[i]=arguments[i]}args[0]=exports.coerce(args[0]);if("string"!==typeof args[0]){args.unshift("%O")}var index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,function(match,format){if(match==="%%")return match;index++;var formatter=exports.formatters[format];if("function"===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match});exports.formatArgs.call(self,args);var logFn=debug.log||exports.log||console.log.bind(console);logFn.apply(self,args)}debug.namespace=namespace;debug.enabled=exports.enabled(namespace);debug.useColors=exports.useColors();debug.color=selectColor(namespace);debug.destroy=destroy;if("function"===typeof exports.init){exports.init(debug)}exports.instances.push(debug);return debug}function destroy(){var index=exports.instances.indexOf(this);if(index!==-1){exports.instances.splice(index,1);return true}else{return false}}function enable(namespaces){exports.save(namespaces);exports.names=[];exports.skips=[];var i;var split=(typeof namespaces==="string"?namespaces:"").split(/[\s,]+/);var len=split.length;for(i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$"))}else{exports.names.push(new RegExp("^"+namespaces+"$"))}}for(i=0;i<exports.instances.length;i++){var instance=exports.instances[i];instance.enabled=exports.enabled(instance.namespace)}}function disable(){exports.enable("")}function enabled(name){if(name[name.length-1]==="*"){return true}var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false}}for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true}}return false}function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}},{ms:78}],67:[function(require,module,exports){var keys=require("./keys");var hasBinary=require("has-binary2");var sliceBuffer=require("arraybuffer.slice");var after=require("after");var utf8=require("./utf8");var base64encoder;if(typeof ArrayBuffer!=="undefined"){base64encoder=require("base64-arraybuffer")}var isAndroid=typeof navigator!=="undefined"&&/Android/i.test(navigator.userAgent);var isPhantomJS=typeof navigator!=="undefined"&&/PhantomJS/i.test(navigator.userAgent);var dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var packetslist=keys(packets);var err={type:"error",data:"parser error"};var Blob=require("blob");exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){if(typeof supportsBinary==="function"){callback=supportsBinary;supportsBinary=false}if(typeof utf8encode==="function"){callback=utf8encode;utf8encode=null}var data=packet.data===undefined?undefined:packet.data.buffer||packet.data;if(typeof ArrayBuffer!=="undefined"&&data instanceof ArrayBuffer){return encodeArrayBuffer(packet,supportsBinary,callback)}else if(typeof Blob!=="undefined"&&data instanceof Blob){return encodeBlob(packet,supportsBinary,callback)}if(data&&data.base64){return encodeBase64Object(packet,callback)}var encoded=packets[packet.type];if(undefined!==packet.data){encoded+=utf8encode?utf8.encode(String(packet.data),{strict:false}):String(packet.data)}return callback(""+encoded)};function encodeBase64Object(packet,callback){var message="b"+exports.packets[packet.type]+packet.data.data;return callback(message)}function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var data=packet.data;var contentArray=new Uint8Array(data);var resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++){resultBuffer[i+1]=contentArray[i]}return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var fr=new FileReader;fr.onload=function(){exports.encodePacket({type:packet.type,data:fr.result},supportsBinary,true,callback)};return fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}if(dontSendBlobs){return encodeBlobAsArrayBuffer(packet,supportsBinary,callback)}var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(typeof Blob!=="undefined"&&packet.data instanceof Blob){var fr=new FileReader;fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)};return fr.readAsDataURL(packet.data)}var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){var typed=new Uint8Array(packet.data);var basic=new Array(typed.length);for(var i=0;i<typed.length;i++){basic[i]=typed[i]}b64data=String.fromCharCode.apply(null,basic)}message+=btoa(b64data);return callback(message)};exports.decodePacket=function(data,binaryType,utf8decode){if(data===undefined){return err}if(typeof data==="string"){if(data.charAt(0)==="b"){return exports.decodeBase64Packet(data.substr(1),binaryType)}if(utf8decode){data=tryDecode(data);if(data===false){return err}}var type=data.charAt(0);if(Number(type)!=type||!packetslist[type]){return err}if(data.length>1){return{type:packetslist[type],data:data.substring(1)}}else{return{type:packetslist[type]}}}var asArray=new Uint8Array(data);var type=asArray[0];var rest=sliceBuffer(data,1);if(Blob&&binaryType==="blob"){rest=new Blob([rest])}return{type:packetslist[type],data:rest}};function tryDecode(data){try{data=utf8.decode(data,{strict:false})}catch(e){return false}return data}exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!base64encoder){return{type:type,data:{base64:true,data:msg.substr(1)}}}var data=base64encoder.decode(msg.substr(1));if(binaryType==="blob"&&Blob){data=new Blob([data])}return{type:type,data:data}};exports.encodePayload=function(packets,supportsBinary,callback){if(typeof supportsBinary==="function"){callback=supportsBinary;supportsBinary=null}var isBinary=hasBinary(packets);if(supportsBinary&&isBinary){if(Blob&&!dontSendBlobs){return exports.encodePayloadAsBlob(packets,callback)}return exports.encodePayloadAsArrayBuffer(packets,callback)}if(!packets.length){return callback("0:")}function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,!isBinary?false:supportsBinary,false,function(message){doneCallback(null,setLengthHeader(message))})}map(packets,encodeOne,function(err,results){return callback(results.join(""))})};function map(ary,each,done){var result=new Array(ary.length);var next=after(ary.length,done);var eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg;cb(error,result)})};for(var i=0;i<ary.length;i++){eachWithIndex(i,ary[i],next)}}exports.decodePayload=function(data,binaryType,callback){if(typeof data!=="string"){return exports.decodePayloadAsBinary(data,binaryType,callback)}if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var packet;if(data===""){return callback(err,0,1)}var length="",n,msg;for(var i=0,l=data.length;i<l;i++){var chr=data.charAt(i);if(chr!==":"){length+=chr;continue}if(length===""||length!=(n=Number(length))){return callback(err,0,1)}msg=data.substr(i+1,n);if(length!=msg.length){return callback(err,0,1)}if(msg.length){packet=exports.decodePacket(msg,binaryType,false);if(err.type===packet.type&&err.data===packet.data){return callback(err,0,1)}var ret=callback(packet,i+n,l);if(false===ret)return}i+=n;length=""}if(length!==""){return callback(err,0,1)}};exports.encodePayloadAsArrayBuffer=function(packets,callback){if(!packets.length){return callback(new ArrayBuffer(0))}function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(data){return doneCallback(null,data)})}map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;if(typeof p==="string"){len=p.length}else{len=p.byteLength}return acc+len.toString().length+len+2},0);var resultArray=new Uint8Array(totalLength);var bufferIndex=0;encodedPackets.forEach(function(p){var isString=typeof p==="string";var ab=p;if(isString){var view=new Uint8Array(p.length);for(var i=0;i<p.length;i++){view[i]=p.charCodeAt(i)}ab=view.buffer}if(isString){resultArray[bufferIndex++]=0}else{resultArray[bufferIndex++]=1}var lenStr=ab.byteLength.toString();for(var i=0;i<lenStr.length;i++){resultArray[bufferIndex++]=parseInt(lenStr[i])}resultArray[bufferIndex++]=255;var view=new Uint8Array(ab);for(var i=0;i<view.length;i++){resultArray[bufferIndex++]=view[i]}});return callback(resultArray.buffer)})};exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(encoded){var binaryIdentifier=new Uint8Array(1);binaryIdentifier[0]=1;if(typeof encoded==="string"){var view=new Uint8Array(encoded.length);for(var i=0;i<encoded.length;i++){view[i]=encoded.charCodeAt(i)}encoded=view.buffer;binaryIdentifier[0]=0}var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size;var lenStr=len.toString();var lengthAry=new Uint8Array(lenStr.length+1);for(var i=0;i<lenStr.length;i++){lengthAry[i]=parseInt(lenStr[i])}lengthAry[lenStr.length]=255;if(Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})}map(packets,encodeOne,function(err,results){return callback(new Blob(results))})};exports.decodePayloadAsBinary=function(data,binaryType,callback){if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var bufferTail=data;var buffers=[];while(bufferTail.byteLength>0){var tailArray=new Uint8Array(bufferTail);var isString=tailArray[0]===0;var msgLength="";for(var i=1;;i++){if(tailArray[i]===255)break;if(msgLength.length>310){return callback(err,0,1)}msgLength+=tailArray[i]}bufferTail=sliceBuffer(bufferTail,2+msgLength.length);msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString){try{msg=String.fromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++){msg+=String.fromCharCode(typed[i])}}}buffers.push(msg);bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,true),i,total)})}},{"./keys":68,"./utf8":69,after:47,"arraybuffer.slice":48,"base64-arraybuffer":50,blob:51,"has-binary2":72}],68:[function(require,module,exports){module.exports=Object.keys||function keys(obj){var arr=[];var has=Object.prototype.hasOwnProperty;for(var i in obj){if(has.call(obj,i)){arr.push(i)}}return arr}},{}],69:[function(require,module,exports){var stringFromCharCode=String.fromCharCode;function ucs2decode(string){var output=[];var counter=0;var length=string.length;var value;var extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){var length=array.length;var index=-1;var value;var output="";while(++index<length){value=array[index];if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value)}return output}function checkScalarValue(codePoint,strict){if(codePoint>=55296&&codePoint<=57343){if(strict){throw Error("Lone surrogate U+"+codePoint.toString(16).toUpperCase()+" is not a scalar value")}return false}return true}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint,strict){if((codePoint&4294967168)==0){return stringFromCharCode(codePoint)}var symbol="";if((codePoint&4294965248)==0){symbol=stringFromCharCode(codePoint>>6&31|192)}else if((codePoint&4294901760)==0){if(!checkScalarValue(codePoint,strict)){codePoint=65533}symbol=stringFromCharCode(codePoint>>12&15|224);symbol+=createByte(codePoint,6)}else if((codePoint&4292870144)==0){symbol=stringFromCharCode(codePoint>>18&7|240);symbol+=createByte(codePoint,12);symbol+=createByte(codePoint,6)}symbol+=stringFromCharCode(codePoint&63|128);return symbol}function utf8encode(string,opts){opts=opts||{};var strict=false!==opts.strict;var codePoints=ucs2decode(string);var length=codePoints.length;var index=-1;var codePoint;var byteString="";while(++index<length){codePoint=codePoints[index];byteString+=encodeCodePoint(codePoint,strict)}return byteString}function readContinuationByte(){if(byteIndex>=byteCount){throw Error("Invalid byte index")}var continuationByte=byteArray[byteIndex]&255;byteIndex++;if((continuationByte&192)==128){return continuationByte&63}throw Error("Invalid continuation byte")}function decodeSymbol(strict){var byte1;var byte2;var byte3;var byte4;var codePoint;if(byteIndex>byteCount){throw Error("Invalid byte index")}if(byteIndex==byteCount){return false}byte1=byteArray[byteIndex]&255;byteIndex++;if((byte1&128)==0){return byte1}if((byte1&224)==192){byte2=readContinuationByte();codePoint=(byte1&31)<<6|byte2;if(codePoint>=128){return codePoint}else{throw Error("Invalid continuation byte")}}if((byte1&240)==224){byte2=readContinuationByte();byte3=readContinuationByte();codePoint=(byte1&15)<<12|byte2<<6|byte3;if(codePoint>=2048){return checkScalarValue(codePoint,strict)?codePoint:65533}else{throw Error("Invalid continuation byte")}}if((byte1&248)==240){byte2=readContinuationByte();byte3=readContinuationByte();byte4=readContinuationByte();codePoint=(byte1&7)<<18|byte2<<12|byte3<<6|byte4;if(codePoint>=65536&&codePoint<=1114111){return codePoint}}throw Error("Invalid UTF-8 detected")}var byteArray;var byteCount;var byteIndex;function utf8decode(byteString,opts){opts=opts||{};var strict=false!==opts.strict;byteArray=ucs2decode(byteString);byteCount=byteArray.length;byteIndex=0;var codePoints=[];var tmp;while((tmp=decodeSymbol(strict))!==false){codePoints.push(tmp)}return ucs2encode(codePoints)}module.exports={version:"2.1.2",encode:utf8encode,decode:utf8decode}},{}],70:[function(require,module,exports){(function(global,setImmediate){(function(global){var NativePromise=global["Promise"];var nativePromiseSupported=NativePromise&&"resolve"in NativePromise&&"reject"in NativePromise&&"all"in NativePromise&&"race"in NativePromise&&function(){var resolve;new NativePromise(function(r){resolve=r});return typeof resolve==="function"}();if(typeof exports!=="undefined"&&exports){exports.Promise=nativePromiseSupported?NativePromise:Promise;exports.Polyfill=Promise}else{if(typeof define=="function"&&define.amd){define(function(){return nativePromiseSupported?NativePromise:Promise})}else{if(!nativePromiseSupported)global["Promise"]=Promise}}var PENDING="pending";var SEALED="sealed";var FULFILLED="fulfilled";var REJECTED="rejected";var NOOP=function(){};function isArray(value){return Object.prototype.toString.call(value)==="[object Array]"}var asyncSetTimer=typeof setImmediate!=="undefined"?setImmediate:setTimeout;var asyncQueue=[];var asyncTimer;function asyncFlush(){for(var i=0;i<asyncQueue.length;i++)asyncQueue[i][0](asyncQueue[i][1]);asyncQueue=[];asyncTimer=false}function asyncCall(callback,arg){asyncQueue.push([callback,arg]);if(!asyncTimer){asyncTimer=true;asyncSetTimer(asyncFlush,0)}}function invokeResolver(resolver,promise){function resolvePromise(value){resolve(promise,value)}function rejectPromise(reason){reject(promise,reason)}try{resolver(resolvePromise,rejectPromise)}catch(e){rejectPromise(e)}}function invokeCallback(subscriber){var owner=subscriber.owner;var settled=owner.state_;var value=owner.data_;var callback=subscriber[settled];var promise=subscriber.then;if(typeof callback==="function"){settled=FULFILLED;try{value=callback(value)}catch(e){reject(promise,e)}}if(!handleThenable(promise,value)){if(settled===FULFILLED)resolve(promise,value);if(settled===REJECTED)reject(promise,value)}}function handleThenable(promise,value){var resolved;try{if(promise===value)throw new TypeError("A promises callback cannot return that same promise.");if(value&&(typeof value==="function"||typeof value==="object")){var then=value.then;if(typeof then==="function"){then.call(value,function(val){if(!resolved){resolved=true;if(value!==val)resolve(promise,val);else fulfill(promise,val)}},function(reason){if(!resolved){resolved=true;reject(promise,reason)}});return true}}}catch(e){if(!resolved)reject(promise,e);return true}return false}function resolve(promise,value){if(promise===value||!handleThenable(promise,value))fulfill(promise,value)}function fulfill(promise,value){if(promise.state_===PENDING){promise.state_=SEALED;promise.data_=value;asyncCall(publishFulfillment,promise)}}function reject(promise,reason){if(promise.state_===PENDING){promise.state_=SEALED;promise.data_=reason;asyncCall(publishRejection,promise)}}function publish(promise){var callbacks=promise.then_;promise.then_=undefined;for(var i=0;i<callbacks.length;i++){invokeCallback(callbacks[i])}}function publishFulfillment(promise){promise.state_=FULFILLED;publish(promise)}function publishRejection(promise){promise.state_=REJECTED;publish(promise)}function Promise(resolver){if(typeof resolver!=="function")throw new TypeError("Promise constructor takes a function argument");if(this instanceof Promise===false)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[];invokeResolver(resolver,this)}Promise.prototype={constructor:Promise,state_:PENDING,then_:null,data_:undefined,then:function(onFulfillment,onRejection){var subscriber={owner:this,then:new this.constructor(NOOP),fulfilled:onFulfillment,rejected:onRejection};if(this.state_===FULFILLED||this.state_===REJECTED){asyncCall(invokeCallback,subscriber)}else{this.then_.push(subscriber)}return subscriber.then},catch:function(onRejection){return this.then(null,onRejection)}};Promise.all=function(promises){var Class=this;if(!isArray(promises))throw new TypeError("You must pass an array to Promise.all().");return new Class(function(resolve,reject){var results=[];var remaining=0;function resolver(index){remaining++;return function(value){results[index]=value;if(!--remaining)resolve(results)}}for(var i=0,promise;i<promises.length;i++){promise=promises[i];if(promise&&typeof promise.then==="function")promise.then(resolver(i),reject);else results[i]=promise}if(!remaining)resolve(results)})};Promise.race=function(promises){var Class=this;if(!isArray(promises))throw new TypeError("You must pass an array to Promise.race().");return new Class(function(resolve,reject){for(var i=0,promise;i<promises.length;i++){promise=promises[i];if(promise&&typeof promise.then==="function")promise.then(resolve,reject);else resolve(promise)}})};Promise.resolve=function(value){var Class=this;if(value&&typeof value==="object"&&value.constructor===Class)return value;return new Class(function(resolve){resolve(value)})};Promise.reject=function(reason){var Class=this;return new Class(function(resolve,reject){reject(reason)})}})(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("timers").setImmediate)},{timers:10}],71:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}if(Object.create){Events.prototype=Object.create(null);if(!(new Events).__proto__)prefix=false}function EE(fn,context,once){this.fn=fn;this.context=context;this.once=once||false}function addListener(emitter,event,fn,context,once){if(typeof fn!=="function"){throw new TypeError("The listener must be a function")}var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;if(!emitter._events[evt])emitter._events[evt]=listener,emitter._eventsCount++;else if(!emitter._events[evt].fn)emitter._events[evt].push(listener);else emitter._events[evt]=[emitter._events[evt],listener];return emitter}function clearEvent(emitter,evt){if(--emitter._eventsCount===0)emitter._events=new Events;else delete emitter._events[evt]}function EventEmitter(){this._events=new Events;this._eventsCount=0}EventEmitter.prototype.eventNames=function eventNames(){var names=[],events,name;if(this._eventsCount===0)return names;for(name in events=this._events){if(has.call(events,name))names.push(prefix?name.slice(1):name)}if(Object.getOwnPropertySymbols){return names.concat(Object.getOwnPropertySymbols(events))}return names};EventEmitter.prototype.listeners=function listeners(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++){ee[i]=handlers[i].fn}return ee};EventEmitter.prototype.listenerCount=function listenerCount(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];if(!listeners)return 0;if(listeners.fn)return 1;return listeners.length};EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return false;var listeners=this._events[evt],len=arguments.length,args,i;if(listeners.fn){if(listeners.once)this.removeListener(event,listeners.fn,undefined,true);switch(len){case 1:return listeners.fn.call(listeners.context),true;case 2:return listeners.fn.call(listeners.context,a1),true;case 3:return listeners.fn.call(listeners.context,a1,a2),true;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),true;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),true;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),true}for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}listeners.fn.apply(listeners.context,args)}else{var length=listeners.length,j;for(i=0;i<length;i++){if(listeners[i].once)this.removeListener(event,listeners[i].fn,undefined,true);switch(len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++){args[j-1]=arguments[j]}listeners[i].fn.apply(listeners[i].context,args)}}}return true};EventEmitter.prototype.on=function on(event,fn,context){return addListener(this,event,fn,context,false)};EventEmitter.prototype.once=function once(event,fn,context){return addListener(this,event,fn,context,true)};EventEmitter.prototype.removeListener=function removeListener(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn){clearEvent(this,evt);return this}var listeners=this._events[evt];if(listeners.fn){if(listeners.fn===fn&&(!once||listeners.once)&&(!context||listeners.context===context)){clearEvent(this,evt)}}else{for(var i=0,events=[],length=listeners.length;i<length;i++){if(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context){events.push(listeners[i])}}if(events.length)this._events[evt]=events.length===1?events[0]:events;else clearEvent(this,evt)}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){var evt;if(event){evt=prefix?prefix+event:event;if(this._events[evt])clearEvent(this,evt)}else{this._events=new Events;this._eventsCount=0}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;if("undefined"!==typeof module){module.exports=EventEmitter}},{}],72:[function(require,module,exports){(function(Buffer){var isArray=require("isarray");var toString=Object.prototype.toString;var withNativeBlob=typeof Blob==="function"||typeof Blob!=="undefined"&&toString.call(Blob)==="[object BlobConstructor]";var withNativeFile=typeof File==="function"||typeof File!=="undefined"&&toString.call(File)==="[object FileConstructor]";module.exports=hasBinary;function hasBinary(obj){if(!obj||typeof obj!=="object"){return false}if(isArray(obj)){for(var i=0,l=obj.length;i<l;i++){if(hasBinary(obj[i])){return true}}return false}if(typeof Buffer==="function"&&Buffer.isBuffer&&Buffer.isBuffer(obj)||typeof ArrayBuffer==="function"&&obj instanceof ArrayBuffer||withNativeBlob&&obj instanceof Blob||withNativeFile&&obj instanceof File){return true}if(obj.toJSON&&typeof obj.toJSON==="function"&&arguments.length===1){return hasBinary(obj.toJSON(),true)}for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)&&hasBinary(obj[key])){return true}}return false}}).call(this,require("buffer").Buffer)},{buffer:3,isarray:75}],73:[function(require,module,exports){try{module.exports=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(err){module.exports=false}},{}],74:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}},{}],75:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},{}],76:[function(require,module,exports){!function(e){var n=/iPhone/i,t=/iPod/i,r=/iPad/i,a=/\bAndroid(?:.+)Mobile\b/i,p=/Android/i,b=/\bAndroid(?:.+)SD4930UR\b/i,l=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,f=/Windows Phone/i,s=/\bWindows(?:.+)ARM\b/i,u=/BlackBerry/i,c=/BB10/i,h=/Opera Mini/i,v=/\b(CriOS|Chrome)(?:.+)Mobile/i,w=/Mobile(?:.+)Firefox\b/i;function m(e,i){return e.test(i)}function i(e){var i=e||("undefined"!=typeof navigator?navigator.userAgent:""),o=i.split("[FBAN");void 0!==o[1]&&(i=o[0]),void 0!==(o=i.split("Twitter"))[1]&&(i=o[0]);var d={apple:{phone:m(n,i)&&!m(f,i),ipod:m(t,i),tablet:!m(n,i)&&m(r,i)&&!m(f,i),device:(m(n,i)||m(t,i)||m(r,i))&&!m(f,i)},amazon:{phone:m(b,i),tablet:!m(b,i)&&m(l,i),device:m(b,i)||m(l,i)},android:{phone:!m(f,i)&&m(b,i)||!m(f,i)&&m(a,i),tablet:!m(f,i)&&!m(b,i)&&!m(a,i)&&(m(l,i)||m(p,i)),device:!m(f,i)&&(m(b,i)||m(l,i)||m(a,i)||m(p,i))||m(/\bokhttp\b/i,i)},windows:{phone:m(f,i),tablet:m(s,i),device:m(f,i)||m(s,i)},other:{blackberry:m(u,i),blackberry10:m(c,i),opera:m(h,i),firefox:m(w,i),chrome:m(v,i),device:m(u,i)||m(c,i)||m(h,i)||m(w,i)||m(v,i)}};return d.any=d.apple.device||d.android.device||d.windows.device||d.other.device,d.phone=d.apple.phone||d.android.phone||d.windows.phone,d.tablet=d.apple.tablet||d.android.tablet||d.windows.tablet,d}"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=i:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?(module.exports=i(),module.exports.isMobile=i):"function"==typeof define&&define.amd?define([],e.isMobile=i()):e.isMobile=i()}(this)},{}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MiniSignalBinding=function(){function MiniSignalBinding(fn,once,thisArg){if(once===undefined)once=false;_classCallCheck(this,MiniSignalBinding);this._fn=fn;this._once=once;this._thisArg=thisArg;this._next=this._prev=this._owner=null}_createClass(MiniSignalBinding,[{key:"detach",value:function detach(){if(this._owner===null)return false;this._owner.detach(this);return true}}]);return MiniSignalBinding}();function _addMiniSignalBinding(self,node){if(!self._head){self._head=node;self._tail=node}else{self._tail._next=node;node._prev=self._tail;self._tail=node}node._owner=self;return node}var MiniSignal=function(){function MiniSignal(){_classCallCheck(this,MiniSignal);this._head=this._tail=undefined}_createClass(MiniSignal,[{key:"handlers",value:function handlers(){var exists=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var node=this._head;if(exists)return!!node;var ee=[];while(node){ee.push(node);node=node._next}return ee}},{key:"has",value:function has(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.")}return node._owner===this}},{key:"dispatch",value:function dispatch(){var node=this._head;if(!node)return false;while(node){if(node._once)this.detach(node);node._fn.apply(node._thisArg,arguments);node=node._next}return true}},{key:"add",value:function add(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#add(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,false,thisArg))}},{key:"once",value:function once(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#once(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,true,thisArg))}},{key:"detach",value:function detach(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.")}if(node._owner!==this)return this;if(node._prev)node._prev._next=node._next;if(node._next)node._next._prev=node._prev;if(node===this._head){this._head=node._next;if(node._next===null){this._tail=null}}else if(node===this._tail){this._tail=node._prev;this._tail._next=null}node._owner=null;return this}},{key:"detachAll",value:function detachAll(){var node=this._head;if(!node)return this;this._head=this._tail=null;while(node){node._owner=null;node=node._next}return this}}]);return MiniSignal}();MiniSignal.MiniSignalBinding=MiniSignalBinding;exports["default"]=MiniSignal;module.exports=exports["default"]},{}],78:[function(require,module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};var type=typeof val;if(type==="string"&&val.length>0){return parse(val)}else if(type==="number"&&isNaN(val)===false){return options.long?fmtLong(val):fmtShort(val)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))};function parse(str){str=String(str);if(str.length>100){return}var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match){return}var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return undefined}}function fmtShort(ms){if(ms>=d){return Math.round(ms/d)+"d"}if(ms>=h){return Math.round(ms/h)+"h"}if(ms>=m){return Math.round(ms/m)+"m"}if(ms>=s){return Math.round(ms/s)+"s"}return ms+"ms"}function fmtLong(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(ms<n){return}if(ms<n*1.5){return Math.floor(ms/n)+" "+name}return Math.ceil(ms/n)+" "+name+"s"}},{}],79:[function(require,module,exports){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},{}],80:[function(require,module,exports){"use strict";module.exports=function parseURI(str,opts){opts=opts||{};var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser[opts.strictMode?"strict":"loose"].exec(str);var uri={};var i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2});return uri}},{}],81:[function(require,module,exports){exports.encode=function(obj){var str="";for(var i in obj){if(obj.hasOwnProperty(i)){if(str.length)str+="&";str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i])}}return str};exports.decode=function(qs){var qry={};var pairs=qs.split("&");for(var i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},{}],82:[function(require,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function parseuri(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");if(b!=-1&&e!=-1){str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length)}var m=re.exec(str||""),uri={},i=14;while(i--){uri[parts[i]]=m[i]||""}if(b!=-1&&e!=-1){uri.source=src;uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":");uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":");uri.ipv6uri=true}return uri}},{}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});require("@pixi/polyfill");var accessibility=require("@pixi/accessibility");var extract=require("@pixi/extract");var interaction=require("@pixi/interaction");var prepare=require("@pixi/prepare");var utils=require("@pixi/utils");var app=require("@pixi/app");var core=require("@pixi/core");var loaders=require("@pixi/loaders");var particles=require("@pixi/particles");var spritesheet=require("@pixi/spritesheet");var spriteTiling=require("@pixi/sprite-tiling");var textBitmap=require("@pixi/text-bitmap");var ticker=require("@pixi/ticker");var filterAlpha=require("@pixi/filter-alpha");var filterBlur=require("@pixi/filter-blur");var filterColorMatrix=require("@pixi/filter-color-matrix");var filterDisplacement=require("@pixi/filter-displacement");var filterFxaa=require("@pixi/filter-fxaa");var filterNoise=require("@pixi/filter-noise");require("@pixi/mixin-cache-as-bitmap");require("@pixi/mixin-get-child-by-name");require("@pixi/mixin-get-global-position");var constants=require("@pixi/constants");var display=require("@pixi/display");var graphics=require("@pixi/graphics");var math=require("@pixi/math");var mesh=require("@pixi/mesh");var meshExtras=require("@pixi/mesh-extras");var runner=require("@pixi/runner");var sprite=require("@pixi/sprite");var spriteAnimated=require("@pixi/sprite-animated");var text=require("@pixi/text");var settings=require("@pixi/settings");var v5="5.0.0";function useDeprecated(){var PIXI=this;Object.defineProperties(PIXI,{SVG_SIZE:{get:function get(){utils.deprecation(v5,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE");return PIXI.SVGResource.SVG_SIZE}},TransformStatic:{get:function get(){utils.deprecation(v5,"PIXI.TransformStatic class has been removed, use PIXI.Transform");return PIXI.Transform}},TransformBase:{get:function get(){utils.deprecation(v5,"PIXI.TransformBase class has been removed, use PIXI.Transform");return PIXI.Transform}},TRANSFORM_MODE:{get:function get(){utils.deprecation(v5,"PIXI.TRANSFORM_MODE property has been removed");return{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function get(){utils.deprecation(v5,"PIXI.WebGLRenderer class has moved to PIXI.Renderer");return PIXI.Renderer}},CanvasRenderTarget:{get:function get(){utils.deprecation(v5,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget");return PIXI.utils.CanvasRenderTarget}},loader:{get:function get(){utils.deprecation(v5,"PIXI.loader instance has moved to PIXI.Loader.shared");return PIXI.Loader.shared}},FilterManager:{get:function get(){utils.deprecation(v5,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem");return PIXI.systems.FilterSystem}}});PIXI.extras={};Object.defineProperties(PIXI.extras,{TilingSprite:{get:function get(){utils.deprecation(v5,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite");return PIXI.TilingSprite}},TilingSpriteRenderer:{get:function get(){utils.deprecation(v5,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer");return PIXI.TilingSpriteRenderer}},AnimatedSprite:{get:function get(){utils.deprecation(v5,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite");return PIXI.AnimatedSprite}},BitmapText:{get:function get(){utils.deprecation(v5,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText");return PIXI.BitmapText}}});Object.defineProperties(PIXI.utils,{getSvgSize:{get:function get(){utils.deprecation(v5,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize");return PIXI.SVGResource.getSize}}});PIXI.mesh={};Object.defineProperties(PIXI.mesh,{Mesh:{get:function get(){utils.deprecation(v5,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh");return PIXI.SimpleMesh}},NineSlicePlane:{get:function get(){utils.deprecation(v5,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane");return PIXI.NineSlicePlane}},Plane:{get:function get(){utils.deprecation(v5,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane");return PIXI.SimplePlane}},Rope:{get:function get(){utils.deprecation(v5,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope");return PIXI.SimpleRope}},RawMesh:{get:function get(){utils.deprecation(v5,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh");return PIXI.Mesh}},CanvasMeshRenderer:{get:function get(){utils.deprecation(v5,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer");return PIXI.CanvasMeshRenderer}},MeshRenderer:{get:function get(){utils.deprecation(v5,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer");return PIXI.MeshRenderer}}});PIXI.particles={};Object.defineProperties(PIXI.particles,{ParticleContainer:{get:function get(){utils.deprecation(v5,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer");return PIXI.ParticleContainer}},ParticleRenderer:{get:function get(){utils.deprecation(v5,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer");return PIXI.ParticleRenderer}}});PIXI.ticker={};Object.defineProperties(PIXI.ticker,{Ticker:{get:function get(){utils.deprecation(v5,"PIXI.ticker.Ticker class has moved to PIXI.Ticker");return PIXI.Ticker}},shared:{get:function get(){utils.deprecation(v5,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared");return PIXI.Ticker.shared}}});PIXI.loaders={};Object.defineProperties(PIXI.loaders,{Loader:{get:function get(){utils.deprecation(v5,"PIXI.loaders.Loader class has moved to PIXI.Loader");return PIXI.Loader}},Resource:{get:function get(){utils.deprecation(v5,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource");return PIXI.LoaderResource}},bitmapFontParser:{get:function get(){utils.deprecation(v5,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use");return PIXI.BitmapFontLoader.use}},parseBitmapFontData:{get:function get(){utils.deprecation(v5,"PIXI.loaders.parseBitmapFontData function has moved to PIXI.BitmapFontLoader.parse");return PIXI.BitmapFontLoader.parse}},spritesheetParser:{get:function get(){utils.deprecation(v5,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use");return PIXI.SpritesheetLoader.use}},getResourcePath:{get:function get(){utils.deprecation(v5,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath");return PIXI.SpritesheetLoader.getResourcePath}}});PIXI.Loader.addPixiMiddleware=function addPixiMiddleware(middleware){utils.deprecation(v5,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin");return PIXI.loaders.Loader.registerPlugin({use:middleware()})};Object.defineProperty(PIXI.extract,"WebGLExtract",{get:function get(){utils.deprecation(v5,"PIXI.extract.WebGLExtract method has moved to PIXI.extract.Extract");return PIXI.extract.Extract}});Object.defineProperty(PIXI.prepare,"WebGLPrepare",{get:function get(){utils.deprecation(v5,"PIXI.prepare.WebGLPrepare class has moved to PIXI.prepare.Prepare");return PIXI.prepare.Prepare}});PIXI.Container.prototype._renderWebGL=function _renderWebGL(renderer){utils.deprecation(v5,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render");this._render(renderer)};PIXI.Container.prototype.renderWebGL=function renderWebGL(renderer){utils.deprecation(v5,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render");this.render(renderer)};PIXI.DisplayObject.prototype.renderWebGL=function renderWebGL(renderer){utils.deprecation(v5,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render");this.render(renderer)};PIXI.Container.prototype.renderAdvancedWebGL=function renderAdvancedWebGL(renderer){utils.deprecation(v5,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced");this.renderAdvanced(renderer)};Object.defineProperties(PIXI.settings,{TRANSFORM_MODE:{get:function get(){utils.deprecation(v5,"PIXI.settings.TRANSFORM_MODE property has been removed");return 0},set:function set(){utils.deprecation(v5,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var BaseTexture=PIXI.BaseTexture;BaseTexture.prototype.loadSource=function loadSource(image){utils.deprecation(v5,"PIXI.BaseTexture.loadSource method has been deprecated");var resource=PIXI.resources.autoDetectResource(image);resource.internal=true;this.setResource(resource);this.update()};Object.defineProperties(BaseTexture.prototype,{hasLoaded:{get:function get(){utils.deprecation(v5,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid");return this.valid}},imageUrl:{get:function get(){utils.deprecation(v5,"PIXI.BaseTexture.imageUrl property has been removed, use resource.url");return this.resource&&this.resource.url}},source:{get:function get(){utils.deprecation(v5,"PIXI.BaseTexture.source property has been moved, use `resource.source`");return this.resource&&this.resource.source},set:function set(source){utils.deprecation(v5,"PIXI.BaseTexture.source property has been moved, use `resource.source` "+"if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture.");if(this.resource){this.resource.source=source}}}});BaseTexture.fromImage=function fromImage(canvas,crossorigin,scaleMode,scale){utils.deprecation(v5,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var resourceOptions={scale:scale,crossorigin:crossorigin};return BaseTexture.from(canvas,{scaleMode:scaleMode,resourceOptions:resourceOptions})};BaseTexture.fromCanvas=function fromCanvas(canvas,scaleMode){utils.deprecation(v5,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from");return BaseTexture.from(canvas,{scaleMode:scaleMode})};BaseTexture.fromSVG=function fromSVG(canvas,crossorigin,scaleMode,scale){utils.deprecation(v5,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var resourceOptions={scale:scale,crossorigin:crossorigin};return BaseTexture.from(canvas,{scaleMode:scaleMode,resourceOptions:resourceOptions})};PIXI.Point.prototype.copy=function copy(p){utils.deprecation(v5,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom");return this.copyFrom(p)};PIXI.ObservablePoint.prototype.copy=function copy(p){utils.deprecation(v5,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom");return this.copyFrom(p)};PIXI.Rectangle.prototype.copy=function copy(p){utils.deprecation(v5,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom");return this.copyFrom(p)};PIXI.Matrix.prototype.copy=function copy(p){utils.deprecation(v5,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo");return this.copyTo(p)};Object.assign(PIXI.systems.FilterSystem.prototype,{getRenderTarget:function getRenderTarget(clear,resolution){utils.deprecation(v5,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture");return this.getFilterTexture(resolution)},returnRenderTarget:function returnRenderTarget(renderTexture){utils.deprecation(v5,"PIXI.FilterManager.returnRenderTarget method has been replaced with "+"PIXI.systems.FilterSystem.returnFilterTexture");this.returnFilterTexture(renderTexture)},calculateScreenSpaceMatrix:function calculateScreenSpaceMatrix(outputMatrix){utils.deprecation(v5,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, "+"use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var mappedMatrix=outputMatrix.identity();var ref=this.activeState;var sourceFrame=ref.sourceFrame;var destinationFrame=ref.destinationFrame;mappedMatrix.translate(sourceFrame.x/destinationFrame.width,sourceFrame.y/destinationFrame.height);mappedMatrix.scale(destinationFrame.width,destinationFrame.height);return mappedMatrix},calculateNormalizedScreenSpaceMatrix:function calculateNormalizedScreenSpaceMatrix(outputMatrix){utils.deprecation(v5,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, "+"use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var ref=this.activeState;var sourceFrame=ref.sourceFrame;var destinationFrame=ref.destinationFrame;var mappedMatrix=outputMatrix.identity();mappedMatrix.translate(sourceFrame.x/destinationFrame.width,sourceFrame.y/destinationFrame.height);var translateScaleX=destinationFrame.width/sourceFrame.width;var translateScaleY=destinationFrame.height/sourceFrame.height;mappedMatrix.scale(translateScaleX,translateScaleY);return mappedMatrix}});Object.defineProperties(PIXI.RenderTexture.prototype,{sourceFrame:{get:function get(){utils.deprecation(v5,"PIXI.RenderTexture.sourceFrame property has been removed");return this.filterFrame}},size:{get:function get(){utils.deprecation(v5,"PIXI.RenderTexture.size property has been removed");return this._frame}}});var BlurXFilter=function(superclass){function BlurXFilter(strength,quality,resolution,kernelSize){utils.deprecation(v5,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass");superclass.call(this,true,strength,quality,resolution,kernelSize)}if(superclass)BlurXFilter.__proto__=superclass;BlurXFilter.prototype=Object.create(superclass&&superclass.prototype);BlurXFilter.prototype.constructor=BlurXFilter;return BlurXFilter}(PIXI.filters.BlurFilterPass);var BlurYFilter=function(superclass){function BlurYFilter(strength,quality,resolution,kernelSize){utils.deprecation(v5,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass");superclass.call(this,false,strength,quality,resolution,kernelSize)}if(superclass)BlurYFilter.__proto__=superclass;BlurYFilter.prototype=Object.create(superclass&&superclass.prototype);BlurYFilter.prototype.constructor=BlurYFilter;return BlurYFilter}(PIXI.filters.BlurFilterPass);Object.assign(PIXI.filters,{BlurXFilter:BlurXFilter,BlurYFilter:BlurYFilter});var Sprite=PIXI.Sprite;var Texture=PIXI.Texture;var Graphics=PIXI.Graphics;if(!Graphics.prototype.generateCanvasTexture){Graphics.prototype.generateCanvasTexture=function generateCanvasTexture(){utils.deprecation(v5,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}}function spriteFrom(name,source,crossorigin,scaleMode){utils.deprecation(v5,"PIXI.Sprite."+name+" method is deprecated, use PIXI.Sprite.from");return Sprite.from(source,{resourceOptions:{scale:scaleMode,crossorigin:crossorigin}})}Sprite.fromImage=spriteFrom.bind(null,"fromImage");Sprite.fromSVG=spriteFrom.bind(null,"fromSVG");Sprite.fromCanvas=spriteFrom.bind(null,"fromCanvas");Sprite.fromVideo=spriteFrom.bind(null,"fromVideo");Sprite.fromFrame=spriteFrom.bind(null,"fromFrame");function textureFrom(name,source,crossorigin,scaleMode){utils.deprecation(v5,"PIXI.Texture."+name+" method is deprecated, use PIXI.Texture.from");return Texture.from(source,{resourceOptions:{scale:scaleMode,crossorigin:crossorigin}})}Texture.fromImage=textureFrom.bind(null,"fromImage");Texture.fromSVG=textureFrom.bind(null,"fromSVG");Texture.fromCanvas=textureFrom.bind(null,"fromCanvas");Texture.fromVideo=textureFrom.bind(null,"fromVideo");Texture.fromFrame=textureFrom.bind(null,"fromFrame");Object.defineProperty(PIXI.AbstractRenderer.prototype,"autoResize",{get:function get(){utils.deprecation(v5,"PIXI.AbstractRenderer.autoResize property is deprecated, use autoDensity");return this.autoDensity},set:function set(value){utils.deprecation(v5,"PIXI.AbstractRenderer.autoResize property is deprecated, use autoDensity");this.autoDensity=value}});PIXI.utils.mixins={mixin:function mixin(){utils.deprecation(v5,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function delayMixin(){utils.deprecation(v5,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function performMixins(){utils.deprecation(v5,"PIXI.utils.mixins.performMixins function is no longer available")}}}core.Renderer.registerPlugin("accessibility",accessibility.AccessibilityManager);core.Renderer.registerPlugin("extract",extract.Extract);core.Renderer.registerPlugin("interaction",interaction.InteractionManager);core.Renderer.registerPlugin("particle",particles.ParticleRenderer);core.Renderer.registerPlugin("prepare",prepare.Prepare);core.Renderer.registerPlugin("batch",core.BatchRenderer);core.Renderer.registerPlugin("tilingSprite",spriteTiling.TilingSpriteRenderer);loaders.Loader.registerPlugin(textBitmap.BitmapFontLoader);loaders.Loader.registerPlugin(spritesheet.SpritesheetLoader);app.Application.registerPlugin(ticker.TickerPlugin);app.Application.registerPlugin(loaders.AppLoaderPlugin);var VERSION="5.0.4";var filters={AlphaFilter:filterAlpha.AlphaFilter,BlurFilter:filterBlur.BlurFilter,BlurFilterPass:filterBlur.BlurFilterPass,ColorMatrixFilter:filterColorMatrix.ColorMatrixFilter,DisplacementFilter:filterDisplacement.DisplacementFilter,FXAAFilter:filterFxaa.FXAAFilter,NoiseFilter:filterNoise.NoiseFilter};Object.keys(app).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return app[key]}})});Object.keys(core).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return core[key]}})});Object.keys(loaders).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return loaders[key]}})});Object.keys(particles).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return particles[key]}})});Object.keys(spritesheet).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return spritesheet[key]}})});Object.keys(spriteTiling).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return spriteTiling[key]}})});Object.keys(textBitmap).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return textBitmap[key]}})});Object.keys(ticker).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return ticker[key]}})});Object.keys(constants).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return constants[key]}})});Object.keys(display).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return display[key]}})});Object.keys(graphics).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return graphics[key]}})});Object.keys(math).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return math[key]}})});Object.keys(mesh).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return mesh[key]}})});Object.keys(meshExtras).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return meshExtras[key]}})});Object.keys(runner).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return runner[key]}})});Object.keys(sprite).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return sprite[key]}})});Object.keys(spriteAnimated).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return spriteAnimated[key]}})});Object.keys(text).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return text[key]}})});Object.keys(settings).forEach(function(key){Object.defineProperty(exports,key,{enumerable:true,get:function(){return settings[key]}})});exports.accessibility=accessibility;exports.extract=extract;exports.interaction=interaction;exports.prepare=prepare;exports.utils=utils;exports.VERSION=VERSION;exports.filters=filters;exports.useDeprecated=useDeprecated},{"@pixi/accessibility":13,"@pixi/app":14,"@pixi/constants":15,"@pixi/core":16,"@pixi/display":17,"@pixi/extract":18,"@pixi/filter-alpha":19,"@pixi/filter-blur":20,"@pixi/filter-color-matrix":21,"@pixi/filter-displacement":22,"@pixi/filter-fxaa":23,"@pixi/filter-noise":24,"@pixi/graphics":25,"@pixi/interaction":26,"@pixi/loaders":27,"@pixi/math":28,"@pixi/mesh":30,"@pixi/mesh-extras":29,"@pixi/mixin-cache-as-bitmap":31,"@pixi/mixin-get-child-by-name":32,"@pixi/mixin-get-global-position":33,"@pixi/particles":34,"@pixi/polyfill":35,"@pixi/prepare":36,"@pixi/runner":37,"@pixi/settings":38,"@pixi/sprite":41,"@pixi/sprite-animated":39,"@pixi/sprite-tiling":40,"@pixi/spritesheet":42,"@pixi/text":44,"@pixi/text-bitmap":43,"@pixi/ticker":45,"@pixi/utils":46}],84:[function(require,module,exports){"use strict";exports.__esModule=true;exports.Loader=undefined;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _miniSignals=require("mini-signals");var _miniSignals2=_interopRequireDefault(_miniSignals);var _parseUri=require("parse-uri");var _parseUri2=_interopRequireDefault(_parseUri);var _async=require("./async");var async=_interopRequireWildcard(_async);var _Resource=require("./Resource");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MAX_PROGRESS=100;var rgxExtractUrlHash=/(#[\w-]+)?$/;var Loader=exports.Loader=function(){function Loader(){var _this=this;var baseUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var concurrency=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;_classCallCheck(this,Loader);this.baseUrl=baseUrl;this.progress=0;this.loading=false;this.defaultQueryString="";this._beforeMiddleware=[];this._afterMiddleware=[];this._resourcesParsing=[];this._boundLoadResource=function(r,d){return _this._loadResource(r,d)};this._queue=async.queue(this._boundLoadResource,concurrency);this._queue.pause();this.resources={};this.onProgress=new _miniSignals2.default;this.onError=new _miniSignals2.default;this.onLoad=new _miniSignals2.default;this.onStart=new _miniSignals2.default;this.onComplete=new _miniSignals2.default;for(var i=0;i<Loader._defaultBeforeMiddleware.length;++i){this.pre(Loader._defaultBeforeMiddleware[i])}for(var _i=0;_i<Loader._defaultAfterMiddleware.length;++_i){this.use(Loader._defaultAfterMiddleware[_i])}}Loader.prototype.add=function add(name,url,options,cb){if(Array.isArray(name)){for(var i=0;i<name.length;++i){this.add(name[i])}return this}if((typeof name==="undefined"?"undefined":_typeof(name))==="object"){cb=url||name.callback||name.onComplete;options=name;url=name.url;name=name.name||name.key||name.url}if(typeof url!=="string"){cb=options;options=url;url=name}if(typeof url!=="string"){throw new Error("No url passed to add resource to loader.")}if(typeof options==="function"){cb=options;options=null}if(this.loading&&(!options||!options.parentResource)){throw new Error("Cannot add resources while the loader is running.")}if(this.resources[name]){throw new Error('Resource named "'+name+'" already exists.')}url=this._prepareUrl(url);this.resources[name]=new _Resource.Resource(name,url,options);if(typeof cb==="function"){this.resources[name].onAfterMiddleware.once(cb)}if(this.loading){var parent=options.parentResource;var incompleteChildren=[];for(var _i2=0;_i2<parent.children.length;++_i2){if(!parent.children[_i2].isComplete){incompleteChildren.push(parent.children[_i2])}}var fullChunk=parent.progressChunk*(incompleteChildren.length+1);var eachChunk=fullChunk/(incompleteChildren.length+2);parent.children.push(this.resources[name]);parent.progressChunk=eachChunk;for(var _i3=0;_i3<incompleteChildren.length;++_i3){incompleteChildren[_i3].progressChunk=eachChunk}this.resources[name].progressChunk=eachChunk}this._queue.push(this.resources[name]);return this};Loader.prototype.pre=function pre(fn){this._beforeMiddleware.push(fn);return this};Loader.prototype.use=function use(fn){this._afterMiddleware.push(fn);return this};Loader.prototype.reset=function reset(){this.progress=0;this.loading=false;this._queue.kill();this._queue.pause();for(var k in this.resources){var res=this.resources[k];if(res._onLoadBinding){res._onLoadBinding.detach()}if(res.isLoading){res.abort()}}this.resources={};return this};Loader.prototype.load=function load(cb){if(typeof cb==="function"){this.onComplete.once(cb)}if(this.loading){return this}if(this._queue.idle()){this._onStart();this._onComplete()}else{var numTasks=this._queue._tasks.length;var chunk=MAX_PROGRESS/numTasks;for(var i=0;i<this._queue._tasks.length;++i){this._queue._tasks[i].data.progressChunk=chunk}this._onStart();this._queue.resume()}return this};Loader.prototype._prepareUrl=function _prepareUrl(url){var parsedUrl=(0,_parseUri2.default)(url,{strictMode:true});var result=void 0;if(parsedUrl.protocol||!parsedUrl.path||url.indexOf("//")===0){result=url}else if(this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&url.charAt(0)!=="/"){result=this.baseUrl+"/"+url}else{result=this.baseUrl+url}if(this.defaultQueryString){var hash=rgxExtractUrlHash.exec(result)[0];result=result.substr(0,result.length-hash.length);if(result.indexOf("?")!==-1){result+="&"+this.defaultQueryString}else{result+="?"+this.defaultQueryString}result+=hash}return result};Loader.prototype._loadResource=function _loadResource(resource,dequeue){var _this2=this;resource._dequeue=dequeue;async.eachSeries(this._beforeMiddleware,function(fn,next){fn.call(_this2,resource,function(){next(resource.isComplete?{}:null)})},function(){if(resource.isComplete){_this2._onLoad(resource)}else{resource._onLoadBinding=resource.onComplete.once(_this2._onLoad,_this2);resource.load()}},true)};Loader.prototype._onStart=function _onStart(){this.progress=0;this.loading=true;this.onStart.dispatch(this)};Loader.prototype._onComplete=function _onComplete(){this.progress=MAX_PROGRESS;this.loading=false;this.onComplete.dispatch(this,this.resources)};Loader.prototype._onLoad=function _onLoad(resource){var _this3=this;resource._onLoadBinding=null;this._resourcesParsing.push(resource);resource._dequeue();async.eachSeries(this._afterMiddleware,function(fn,next){fn.call(_this3,resource,next)},function(){resource.onAfterMiddleware.dispatch(resource);_this3.progress=Math.min(MAX_PROGRESS,_this3.progress+resource.progressChunk);_this3.onProgress.dispatch(_this3,resource);if(resource.error){_this3.onError.dispatch(resource.error,_this3,resource)}else{_this3.onLoad.dispatch(_this3,resource)}_this3._resourcesParsing.splice(_this3._resourcesParsing.indexOf(resource),1);if(_this3._queue.idle()&&_this3._resourcesParsing.length===0){_this3._onComplete()}},true)};_createClass(Loader,[{key:"concurrency",get:function get(){return this._queue.concurrency},set:function set(concurrency){this._queue.concurrency=concurrency}}]);return Loader}();Loader._defaultBeforeMiddleware=[];Loader._defaultAfterMiddleware=[];Loader.pre=function LoaderPreStatic(fn){Loader._defaultBeforeMiddleware.push(fn);return Loader};Loader.use=function LoaderUseStatic(fn){Loader._defaultAfterMiddleware.push(fn);return Loader}},{"./Resource":85,"./async":86,"mini-signals":77,"parse-uri":80}],85:[function(require,module,exports){"use strict";exports.__esModule=true;exports.Resource=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _parseUri=require("parse-uri");var _parseUri2=_interopRequireDefault(_parseUri);var _miniSignals=require("mini-signals");var _miniSignals2=_interopRequireDefault(_miniSignals);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var useXdr=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest));var tempAnchor=null;var STATUS_NONE=0;var STATUS_OK=200;var STATUS_EMPTY=204;var STATUS_IE_BUG_EMPTY=1223;var STATUS_TYPE_OK=2;function _noop(){}var Resource=exports.Resource=function(){Resource.setExtensionLoadType=function setExtensionLoadType(extname,loadType){setExtMap(Resource._loadTypeMap,extname,loadType)};Resource.setExtensionXhrType=function setExtensionXhrType(extname,xhrType){setExtMap(Resource._xhrTypeMap,extname,xhrType)};function Resource(name,url,options){_classCallCheck(this,Resource);if(typeof name!=="string"||typeof url!=="string"){throw new Error("Both name and url are required for constructing a resource.")}options=options||{};this._flags=0;this._setFlag(Resource.STATUS_FLAGS.DATA_URL,url.indexOf("data:")===0);this.name=name;this.url=url;this.extension=this._getExtension();this.data=null;this.crossOrigin=options.crossOrigin===true?"anonymous":options.crossOrigin;this.timeout=options.timeout||0;this.loadType=options.loadType||this._determineLoadType();this.xhrType=options.xhrType;this.metadata=options.metadata||{};this.error=null;this.xhr=null;this.children=[];this.type=Resource.TYPE.UNKNOWN;this.progressChunk=0;this._dequeue=_noop;this._onLoadBinding=null;this._elementTimer=0;this._boundComplete=this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundOnTimeout=this._onTimeout.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this.onStart=new _miniSignals2.default;this.onProgress=new _miniSignals2.default;this.onComplete=new _miniSignals2.default;this.onAfterMiddleware=new _miniSignals2.default}Resource.prototype.complete=function complete(){this._clearEvents();this._finish()};Resource.prototype.abort=function abort(message){if(this.error){return}this.error=new Error(message);this._clearEvents();if(this.xhr){this.xhr.abort()}else if(this.xdr){this.xdr.abort()}else if(this.data){if(this.data.src){this.data.src=Resource.EMPTY_GIF}else{while(this.data.firstChild){this.data.removeChild(this.data.firstChild)}}}this._finish()};Resource.prototype.load=function load(cb){var _this=this;if(this.isLoading){return}if(this.isComplete){if(cb){setTimeout(function(){return cb(_this)},1)}return}else if(cb){this.onComplete.once(cb)}this._setFlag(Resource.STATUS_FLAGS.LOADING,true);this.onStart.dispatch(this);if(this.crossOrigin===false||typeof this.crossOrigin!=="string"){this.crossOrigin=this._determineCrossOrigin(this.url)}switch(this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE;this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO;this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO;this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:if(useXdr&&this.crossOrigin){this._loadXdr()}else{this._loadXhr()}break}};Resource.prototype._hasFlag=function _hasFlag(flag){return(this._flags&flag)!==0};Resource.prototype._setFlag=function _setFlag(flag,value){this._flags=value?this._flags|flag:this._flags&~flag};Resource.prototype._clearEvents=function _clearEvents(){clearTimeout(this._elementTimer);if(this.data&&this.data.removeEventListener){this.data.removeEventListener("error",this._boundOnError,false);this.data.removeEventListener("load",this._boundComplete,false);this.data.removeEventListener("progress",this._boundOnProgress,false);this.data.removeEventListener("canplaythrough",this._boundComplete,false)}if(this.xhr){if(this.xhr.removeEventListener){this.xhr.removeEventListener("error",this._boundXhrOnError,false);this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,false);this.xhr.removeEventListener("abort",this._boundXhrOnAbort,false);this.xhr.removeEventListener("progress",this._boundOnProgress,false);this.xhr.removeEventListener("load",this._boundXhrOnLoad,false)}else{this.xhr.onerror=null;this.xhr.ontimeout=null;this.xhr.onprogress=null;this.xhr.onload=null}}};Resource.prototype._finish=function _finish(){if(this.isComplete){throw new Error("Complete called again for an already completed resource.")}this._setFlag(Resource.STATUS_FLAGS.COMPLETE,true);this._setFlag(Resource.STATUS_FLAGS.LOADING,false);this.onComplete.dispatch(this)};Resource.prototype._loadElement=function _loadElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="image"&&typeof window.Image!=="undefined"){this.data=new Image}else{this.data=document.createElement(type)}if(this.crossOrigin){this.data.crossOrigin=this.crossOrigin}if(!this.metadata.skipSource){this.data.src=this.url}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);if(this.timeout){this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout)}};Resource.prototype._loadSourceElement=function _loadSourceElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="audio"&&typeof window.Audio!=="undefined"){this.data=new Audio}else{this.data=document.createElement(type)}if(this.data===null){this.abort("Unsupported element: "+type);return}if(this.crossOrigin){this.data.crossOrigin=this.crossOrigin}if(!this.metadata.skipSource){if(navigator.isCocoonJS){this.data.src=Array.isArray(this.url)?this.url[0]:this.url}else if(Array.isArray(this.url)){var mimeTypes=this.metadata.mimeType;for(var i=0;i<this.url.length;++i){this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes))}}else{var _mimeTypes=this.metadata.mimeType;this.data.appendChild(this._createSource(type,this.url,Array.isArray(_mimeTypes)?_mimeTypes[0]:_mimeTypes))}}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);this.data.addEventListener("canplaythrough",this._boundComplete,false);this.data.load();if(this.timeout){this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout)}};Resource.prototype._loadXhr=function _loadXhr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,true);xhr.timeout=this.timeout;if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){xhr.responseType=Resource.XHR_RESPONSE_TYPE.TEXT}else{xhr.responseType=this.xhrType}xhr.addEventListener("error",this._boundXhrOnError,false);xhr.addEventListener("timeout",this._boundXhrOnTimeout,false);xhr.addEventListener("abort",this._boundXhrOnAbort,false);xhr.addEventListener("progress",this._boundOnProgress,false);xhr.addEventListener("load",this._boundXhrOnLoad,false);xhr.send()};Resource.prototype._loadXdr=function _loadXdr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xdr=this.xhr=new XDomainRequest;xdr.timeout=this.timeout||5e3;xdr.onerror=this._boundXhrOnError;xdr.ontimeout=this._boundXhrOnTimeout;xdr.onprogress=this._boundOnProgress;xdr.onload=this._boundXhrOnLoad;xdr.open("GET",this.url,true);setTimeout(function(){return xdr.send()},1)};Resource.prototype._createSource=function _createSource(type,url,mime){if(!mime){mime=type+"/"+this._getExtension(url)}var source=document.createElement("source");source.src=url;source.type=mime;return source};Resource.prototype._onError=function _onError(event){this.abort("Failed to load element using: "+event.target.nodeName)};Resource.prototype._onProgress=function _onProgress(event){if(event&&event.lengthComputable){this.onProgress.dispatch(this,event.loaded/event.total)}};Resource.prototype._onTimeout=function _onTimeout(){this.abort("Load timed out.")};Resource.prototype._xhrOnError=function _xhrOnError(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')};Resource.prototype._xhrOnTimeout=function _xhrOnTimeout(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request timed out.")};Resource.prototype._xhrOnAbort=function _xhrOnAbort(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request was aborted by the user.")};Resource.prototype._xhrOnLoad=function _xhrOnLoad(){var xhr=this.xhr;var text="";var status=typeof xhr.status==="undefined"?STATUS_OK:xhr.status;if(xhr.responseType===""||xhr.responseType==="text"||typeof xhr.responseType==="undefined"){text=xhr.responseText}if(status===STATUS_NONE&&(text.length>0||xhr.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)){status=STATUS_OK}else if(status===STATUS_IE_BUG_EMPTY){status=STATUS_EMPTY}var statusType=status/100|0;if(statusType===STATUS_TYPE_OK){if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT){this.data=text;this.type=Resource.TYPE.TEXT}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON){try{this.data=JSON.parse(text);this.type=Resource.TYPE.JSON}catch(e){this.abort("Error trying to parse loaded json: "+e);return}}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){try{if(window.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(text,"text/xml")}else{var div=document.createElement("div");div.innerHTML=text;this.data=div}this.type=Resource.TYPE.XML}catch(e){this.abort("Error trying to parse loaded xml: "+e);return}}else{this.data=xhr.response||text}}else{this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL);return}this.complete()};Resource.prototype._determineCrossOrigin=function _determineCrossOrigin(url,loc){if(url.indexOf("data:")===0){return""}if(window.origin!==window.location.origin){return"anonymous"}loc=loc||window.location;if(!tempAnchor){tempAnchor=document.createElement("a")}tempAnchor.href=url;url=(0,_parseUri2.default)(tempAnchor.href,{strictMode:true});var samePort=!url.port&&loc.port===""||url.port===loc.port;var protocol=url.protocol?url.protocol+":":"";if(url.host!==loc.hostname||!samePort||protocol!==loc.protocol){return"anonymous"}return""};Resource.prototype._determineXhrType=function _determineXhrType(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT};Resource.prototype._determineLoadType=function _determineLoadType(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR};Resource.prototype._getExtension=function _getExtension(){var url=this.url;var ext="";if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?");var hashStart=url.indexOf("#");var index=Math.min(queryStart>-1?queryStart:url.length,hashStart>-1?hashStart:url.length);url=url.substring(0,index);ext=url.substring(url.lastIndexOf(".")+1)}return ext.toLowerCase()};Resource.prototype._getMimeFromXhrType=function _getMimeFromXhrType(type){switch(type){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}};_createClass(Resource,[{key:"isDataUrl",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]);return Resource}();Resource.STATUS_FLAGS={NONE:0,DATA_URL:1<<0,COMPLETE:1<<1,LOADING:1<<2};Resource.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6};Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE,svg:Resource.LOAD_TYPE.IMAGE,"svg+xml":Resource.LOAD_TYPE.IMAGE,mp3:Resource.LOAD_TYPE.AUDIO,ogg:Resource.LOAD_TYPE.AUDIO,wav:Resource.LOAD_TYPE.AUDIO,mp4:Resource.LOAD_TYPE.VIDEO,webm:Resource.LOAD_TYPE.VIDEO};Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT,ttf:Resource.XHR_RESPONSE_TYPE.BUFFER,otf:Resource.XHR_RESPONSE_TYPE.BUFFER};Resource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function setExtMap(map,extname,val){if(extname&&extname.indexOf(".")===0){extname=extname.substring(1)}if(!extname){return}map[extname]=val}function reqType(xhr){return xhr.toString().replace("object ","")}if(typeof module!=="undefined"){module.exports.default=Resource}},{"mini-signals":77,"parse-uri":80}],86:[function(require,module,exports){"use strict";exports.__esModule=true;exports.eachSeries=eachSeries;exports.queue=queue;function _noop(){}function eachSeries(array,iterator,callback,deferNext){var i=0;var len=array.length;(function next(err){if(err||i===len){if(callback){callback(err)}return}if(deferNext){setTimeout(function(){iterator(array[i++],next)},1)}else{iterator(array[i++],next)}})()}function onlyOnce(fn){return function onceWrapper(){if(fn===null){throw new Error("Callback was already called.")}var callFn=fn;fn=null;callFn.apply(this,arguments)}}function queue(worker,concurrency){if(concurrency==null){concurrency=1}else if(concurrency===0){throw new Error("Concurrency must not be zero")}var workers=0;var q={_tasks:[],concurrency:concurrency,saturated:_noop,unsaturated:_noop,buffer:concurrency/4,empty:_noop,drain:_noop,error:_noop,started:false,paused:false,push:function push(data,callback){_insert(data,false,callback)},kill:function kill(){workers=0;q.drain=_noop;q.started=false;q._tasks=[]},unshift:function unshift(data,callback){_insert(data,true,callback)},process:function process(){while(!q.paused&&workers<q.concurrency&&q._tasks.length){var task=q._tasks.shift();if(q._tasks.length===0){q.empty()}workers+=1;if(workers===q.concurrency){q.saturated()}worker(task.data,onlyOnce(_next(task)))}},length:function length(){return q._tasks.length},running:function running(){return workers},idle:function idle(){return q._tasks.length+workers===0},pause:function pause(){if(q.paused===true){return}q.paused=true},resume:function resume(){if(q.paused===false){return}q.paused=false;for(var w=1;w<=q.concurrency;w++){q.process()}}};function _insert(data,insertAtFront,callback){if(callback!=null&&typeof callback!=="function"){throw new Error("task callback must be a function")}q.started=true;if(data==null&&q.idle()){setTimeout(function(){return q.drain()},1);return}var item={data:data,callback:typeof callback==="function"?callback:_noop};if(insertAtFront){q._tasks.unshift(item)}else{q._tasks.push(item)}setTimeout(function(){return q.process()},1)}function _next(task){return function next(){workers-=1;task.callback.apply(task,arguments);if(arguments[0]!=null){q.error(arguments[0],task.data)}if(workers<=q.concurrency-q.buffer){q.unsaturated()}if(q.idle()){q.drain()}q.process()}}return q}},{}],87:[function(require,module,exports){"use strict";exports.__esModule=true;exports.encodeBinary=encodeBinary;var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(input){var output="";var inx=0;while(inx<input.length){var bytebuffer=[0,0,0];var encodedCharIndexes=[0,0,0,0];for(var jnx=0;jnx<bytebuffer.length;++jnx){if(inx<input.length){bytebuffer[jnx]=input.charCodeAt(inx++)&255}else{bytebuffer[jnx]=0}}encodedCharIndexes[0]=bytebuffer[0]>>2;encodedCharIndexes[1]=(bytebuffer[0]&3)<<4|bytebuffer[1]>>4;encodedCharIndexes[2]=(bytebuffer[1]&15)<<2|bytebuffer[2]>>6;encodedCharIndexes[3]=bytebuffer[2]&63;var paddingBytes=inx-(input.length-1);switch(paddingBytes){case 2:encodedCharIndexes[3]=64;encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64;break;default:break}for(var _jnx=0;_jnx<encodedCharIndexes.length;++_jnx){output+=_keyStr.charAt(encodedCharIndexes[_jnx])}}return output}if(typeof module!=="undefined"){module.exports.default=encodeBinary}},{}],88:[function(require,module,exports){"use strict";var Loader=require("./Loader").Loader;var Resource=require("./Resource").Resource;var async=require("./async");var b64=require("./b64");Loader.Resource=Resource;Loader.async=async;Loader.encodeBinary=b64;Loader.base64=b64;module.exports=Loader;module.exports.Loader=Loader;module.exports.default=Loader},{"./Loader":84,"./Resource":85,"./async":86,"./b64":87}],89:[function(require,module,exports){var url=require("./url");var parser=require("socket.io-parser");var Manager=require("./manager");var debug=require("debug")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};function lookup(uri,opts){if(typeof uri==="object"){opts=uri;uri=undefined}opts=opts||{};var parsed=url(uri);var source=parsed.source;var id=parsed.id;var path=parsed.path;var sameNamespace=cache[id]&&path in cache[id].nsps;var newConnection=opts.forceNew||opts["force new connection"]||false===opts.multiplex||sameNamespace;var io;if(newConnection){debug("ignoring socket cache for %s",source);io=Manager(source,opts)}else{if(!cache[id]){debug("new io instance for %s",source);cache[id]=Manager(source,opts)}io=cache[id]}if(parsed.query&&!opts.query){opts.query=parsed.query}return io.socket(parsed.path,opts)}exports.protocol=parser.protocol;exports.connect=lookup;exports.Manager=require("./manager");exports.Socket=require("./socket")},{"./manager":90,"./socket":92,"./url":93,debug:94,"socket.io-parser":97}],90:[function(require,module,exports){var eio=require("engine.io-client");var Socket=require("./socket");var Emitter=require("component-emitter");var parser=require("socket.io-parser");var on=require("./on");var bind=require("component-bind");var debug=require("debug")("socket.io-client:manager");var indexOf=require("indexof");var Backoff=require("backo2");var has=Object.prototype.hasOwnProperty;module.exports=Manager;function Manager(uri,opts){if(!(this instanceof Manager))return new Manager(uri,opts);if(uri&&"object"===typeof uri){opts=uri;uri=undefined}opts=opts||{};opts.path=opts.path||"/socket.io";this.nsps={};this.subs=[];this.opts=opts;this.reconnection(opts.reconnection!==false);this.reconnectionAttempts(opts.reconnectionAttempts||Infinity);this.reconnectionDelay(opts.reconnectionDelay||1e3);this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3);this.randomizationFactor(opts.randomizationFactor||.5);this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==opts.timeout?2e4:opts.timeout);this.readyState="closed";this.uri=uri;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];var _parser=opts.parser||parser;this.encoder=new _parser.Encoder;this.decoder=new _parser.Decoder;this.autoConnect=opts.autoConnect!==false;if(this.autoConnect)this.open()}Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)}}};Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].id=this.generateId(nsp)}}};Manager.prototype.generateId=function(nsp){return(nsp==="/"?"":nsp+"#")+this.engine.id};Emitter(Manager.prototype);Manager.prototype.reconnection=function(v){if(!arguments.length)return this._reconnection;this._reconnection=!!v;return this};Manager.prototype.reconnectionAttempts=function(v){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=v;return this};Manager.prototype.reconnectionDelay=function(v){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=v;this.backoff&&this.backoff.setMin(v);return this};Manager.prototype.randomizationFactor=function(v){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=v;this.backoff&&this.backoff.setJitter(v);return this};Manager.prototype.reconnectionDelayMax=function(v){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=v;this.backoff&&this.backoff.setMax(v);return this};Manager.prototype.timeout=function(v){if(!arguments.length)return this._timeout;this._timeout=v;return this};Manager.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}};Manager.prototype.open=Manager.prototype.connect=function(fn,opts){debug("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri);this.engine=eio(this.uri,this.opts);var socket=this.engine;var self=this;this.readyState="opening";this.skipReconnect=false;var openSub=on(socket,"open",function(){self.onopen();fn&&fn()});var errorSub=on(socket,"error",function(data){debug("connect_error");self.cleanup();self.readyState="closed";self.emitAll("connect_error",data);if(fn){var err=new Error("Connection error");err.data=data;fn(err)}else{self.maybeReconnectOnOpen()}});if(false!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout);openSub.destroy();socket.close();socket.emit("error","timeout");self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}this.subs.push(openSub);this.subs.push(errorSub);return this};Manager.prototype.onopen=function(){debug("open");this.cleanup();this.readyState="open";this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata")));this.subs.push(on(socket,"ping",bind(this,"onping")));this.subs.push(on(socket,"pong",bind(this,"onpong")));this.subs.push(on(socket,"error",bind(this,"onerror")));this.subs.push(on(socket,"close",bind(this,"onclose")));this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded")))};Manager.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};Manager.prototype.ondata=function(data){this.decoder.add(data)};Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)};Manager.prototype.onerror=function(err){debug("error",err);this.emitAll("error",err)};Manager.prototype.socket=function(nsp,opts){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp,opts);this.nsps[nsp]=socket;var self=this;socket.on("connecting",onConnecting);socket.on("connect",function(){socket.id=self.generateId(nsp)});if(this.autoConnect){onConnecting()}}function onConnecting(){if(!~indexOf(self.connecting,socket)){self.connecting.push(socket)}}return socket};Manager.prototype.destroy=function(socket){var index=indexOf(this.connecting,socket);if(~index)this.connecting.splice(index,1);if(this.connecting.length)return;this.close()};Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;if(packet.query&&packet.type===0)packet.nsp+="?"+packet.query;if(!self.encoding){self.encoding=true;this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++){self.engine.write(encodedPackets[i],packet.options)}self.encoding=false;self.processPacketQueue()})}else{self.packetBuffer.push(packet)}};Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}};Manager.prototype.cleanup=function(){debug("cleanup");var subsLength=this.subs.length;for(var i=0;i<subsLength;i++){var sub=this.subs.shift();sub.destroy()}this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy()};Manager.prototype.close=Manager.prototype.disconnect=function(){debug("disconnect");this.skipReconnect=true;this.reconnecting=false;if("opening"===this.readyState){this.cleanup()}this.backoff.reset();this.readyState="closed";if(this.engine)this.engine.close()};Manager.prototype.onclose=function(reason){debug("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",reason);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts){debug("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting=false}else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay);this.reconnecting=true;var timer=setTimeout(function(){if(self.skipReconnect)return;debug("attempting reconnect");self.emitAll("reconnect_attempt",self.backoff.attempts);self.emitAll("reconnecting",self.backoff.attempts);if(self.skipReconnect)return;self.open(function(err){if(err){debug("reconnect attempt error");self.reconnecting=false;self.reconnect();self.emitAll("reconnect_error",err.data)}else{debug("reconnect success");self.onreconnect()}})},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}};Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",attempt)}},{"./on":91,"./socket":92,backo2:49,"component-bind":52,"component-emitter":53,debug:94,"engine.io-client":56,indexof:74,"socket.io-parser":97}],91:[function(require,module,exports){module.exports=on;function on(obj,ev,fn){obj.on(ev,fn);return{destroy:function(){obj.removeListener(ev,fn)}}}},{}],92:[function(require,module,exports){var parser=require("socket.io-parser");var Emitter=require("component-emitter");var toArray=require("to-array");var on=require("./on");var bind=require("component-bind");var debug=require("debug")("socket.io-client:socket");var parseqs=require("parseqs");var hasBin=require("has-binary2");module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var emit=Emitter.prototype.emit;function Socket(io,nsp,opts){this.io=io;this.nsp=nsp;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;this.flags={};if(opts&&opts.query){this.query=opts.query}if(this.io.autoConnect)this.open()}Emitter(Socket.prototype);Socket.prototype.subEvents=function(){if(this.subs)return;var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]};Socket.prototype.open=Socket.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"===this.io.readyState)this.onopen();this.emit("connecting");return this};Socket.prototype.send=function(){var args=toArray(arguments);args.unshift("message");this.emit.apply(this,args);return this};Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev)){emit.apply(this,arguments);return this}var args=toArray(arguments);var packet={type:(this.flags.binary!==undefined?this.flags.binary:hasBin(args))?parser.BINARY_EVENT:parser.EVENT,data:args};packet.options={};packet.options.compress=!this.flags||false!==this.flags.compress;if("function"===typeof args[args.length-1]){debug("emitting packet with ack id %d",this.ids);this.acks[this.ids]=args.pop();packet.id=this.ids++}if(this.connected){this.packet(packet)}else{this.sendBuffer.push(packet)}this.flags={};return this};Socket.prototype.packet=function(packet){packet.nsp=this.nsp;this.io.packet(packet)};Socket.prototype.onopen=function(){debug("transport is open - connecting");if("/"!==this.nsp){if(this.query){var query=typeof this.query==="object"?parseqs.encode(this.query):this.query;debug("sending connect packet with query %s",query);this.packet({type:parser.CONNECT,query:query})}else{this.packet({type:parser.CONNECT})}}};Socket.prototype.onclose=function(reason){debug("close (%s)",reason);this.connected=false;this.disconnected=true;delete this.id;this.emit("disconnect",reason)};Socket.prototype.onpacket=function(packet){var sameNamespace=packet.nsp===this.nsp;var rootNamespaceError=packet.type===parser.ERROR&&packet.nsp==="/";if(!sameNamespace&&!rootNamespaceError)return;switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data);break}};Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args);if(null!=packet.id){debug("attaching ack callback to event");args.push(this.ack(packet.id))}if(this.connected){emit.apply(this,args)}else{this.receiveBuffer.push(args)}};Socket.prototype.ack=function(id){var self=this;var sent=false;return function(){if(sent)return;sent=true;var args=toArray(arguments);debug("sending ack %j",args);self.packet({type:hasBin(args)?parser.BINARY_ACK:parser.ACK,id:id,data:args})}};Socket.prototype.onack=function(packet){var ack=this.acks[packet.id];if("function"===typeof ack){debug("calling ack %s with %j",packet.id,packet.data);ack.apply(this,packet.data);delete this.acks[packet.id]}else{debug("bad ack %s",packet.id)}};Socket.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++){emit.apply(this,this.receiveBuffer[i])}this.receiveBuffer=[];for(i=0;i<this.sendBuffer.length;i++){this.packet(this.sendBuffer[i])}this.sendBuffer=[]};Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++){this.subs[i].destroy()}this.subs=null}this.io.destroy(this)};Socket.prototype.close=Socket.prototype.disconnect=function(){if(this.connected){debug("performing disconnect (%s)",this.nsp);this.packet({type:parser.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this};Socket.prototype.compress=function(compress){this.flags.compress=compress;return this};Socket.prototype.binary=function(binary){this.flags.binary=binary;return this}},{"./on":91,"component-bind":52,"component-emitter":53,debug:94,"has-binary2":72,parseqs:81,"socket.io-parser":97,"to-array":101}],93:[function(require,module,exports){var parseuri=require("parseuri");var debug=require("debug")("socket.io-client:url");module.exports=url;function url(uri,loc){var obj=uri;loc=loc||typeof location!=="undefined"&&location;if(null==uri)uri=loc.protocol+"//"+loc.host;if("string"===typeof uri){if("/"===uri.charAt(0)){if("/"===uri.charAt(1)){uri=loc.protocol+uri}else{uri=loc.host+uri}}if(!/^(https?|wss?):\/\//.test(uri)){debug("protocol-less url %s",uri);if("undefined"!==typeof loc){uri=loc.protocol+"//"+uri}else{uri="https://"+uri}}debug("parse %s",uri);obj=parseuri(uri)}if(!obj.port){if(/^(http|ws)$/.test(obj.protocol)){obj.port="80"}else if(/^(http|ws)s$/.test(obj.protocol)){obj.port="443"}}obj.path=obj.path||"/";var ipv6=obj.host.indexOf(":")!==-1;var host=ipv6?"["+obj.host+"]":obj.host;obj.id=obj.protocol+"://"+host+":"+obj.port;obj.href=obj.protocol+"://"+host+(loc&&loc.port===obj.port?"":":"+obj.port);return obj}},{debug:94,parseuri:82}],94:[function(require,module,exports){arguments[4][65][0].apply(exports,arguments)},{"./debug":95,_process:5,dup:65}],95:[function(require,module,exports){arguments[4][66][0].apply(exports,arguments)},{dup:66,ms:78}],96:[function(require,module,exports){var isArray=require("isarray");var isBuf=require("./is-buffer");var toString=Object.prototype.toString;var withNativeBlob=typeof Blob==="function"||typeof Blob!=="undefined"&&toString.call(Blob)==="[object BlobConstructor]";var withNativeFile=typeof File==="function"||typeof File!=="undefined"&&toString.call(File)==="[object FileConstructor]";exports.deconstructPacket=function(packet){var buffers=[];var packetData=packet.data;var pack=packet;pack.data=_deconstructPacket(packetData,buffers);pack.attachments=buffers.length;return{packet:pack,buffers:buffers}};function _deconstructPacket(data,buffers){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:true,num:buffers.length};buffers.push(data);return placeholder}else if(isArray(data)){var newData=new Array(data.length);for(var i=0;i<data.length;i++){newData[i]=_deconstructPacket(data[i],buffers)}return newData}else if(typeof data==="object"&&!(data instanceof Date)){var newData={};for(var key in data){newData[key]=_deconstructPacket(data[key],buffers)}return newData}return data}exports.reconstructPacket=function(packet,buffers){packet.data=_reconstructPacket(packet.data,buffers);packet.attachments=undefined;return packet};function _reconstructPacket(data,buffers){if(!data)return data;if(data&&data._placeholder){return buffers[data.num]}else if(isArray(data)){for(var i=0;i<data.length;i++){data[i]=_reconstructPacket(data[i],buffers)}}else if(typeof data==="object"){for(var key in data){data[key]=_reconstructPacket(data[key],buffers)}}return data}exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(withNativeBlob&&obj instanceof Blob||withNativeFile&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){if(containingObject){containingObject[curKey]=this.result}else{bloblessData=this.result}if(!--pendingBlobs){callback(bloblessData)}};fileReader.readAsArrayBuffer(obj)}else if(isArray(obj)){for(var i=0;i<obj.length;i++){_removeBlobs(obj[i],i,obj)}}else if(typeof obj==="object"&&!isBuf(obj)){for(var key in obj){_removeBlobs(obj[key],key,obj)}}}var pendingBlobs=0;var bloblessData=data;_removeBlobs(bloblessData);if(!pendingBlobs){callback(bloblessData)}}},{"./is-buffer":98,isarray:75}],97:[function(require,module,exports){var debug=require("debug")("socket.io-parser");var Emitter=require("component-emitter");var binary=require("./binary");var isArray=require("isarray");var isBuf=require("./is-buffer");exports.protocol=4;exports.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"];exports.CONNECT=0;exports.DISCONNECT=1;exports.EVENT=2;exports.ACK=3;exports.ERROR=4;exports.BINARY_EVENT=5;exports.BINARY_ACK=6;exports.Encoder=Encoder;exports.Decoder=Decoder;function Encoder(){}var ERROR_PACKET=exports.ERROR+'"encode error"';Encoder.prototype.encode=function(obj,callback){debug("encoding packet %j",obj);if(exports.BINARY_EVENT===obj.type||exports.BINARY_ACK===obj.type){encodeAsBinary(obj,callback)}else{var encoding=encodeAsString(obj);callback([encoding])}};function encodeAsString(obj){var str=""+obj.type;if(exports.BINARY_EVENT===obj.type||exports.BINARY_ACK===obj.type){str+=obj.attachments+"-"}if(obj.nsp&&"/"!==obj.nsp){str+=obj.nsp+","}if(null!=obj.id){str+=obj.id}if(null!=obj.data){var payload=tryStringify(obj.data);if(payload!==false){str+=payload}else{return ERROR_PACKET}}debug("encoded %j as %s",obj,str);return str}function tryStringify(str){try{return JSON.stringify(str)}catch(e){return false}}function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData);var pack=encodeAsString(deconstruction.packet);var buffers=deconstruction.buffers;buffers.unshift(pack);callback(buffers)}binary.removeBlobs(obj,writeEncoding)}function Decoder(){this.reconstructor=null}Emitter(Decoder.prototype);Decoder.prototype.add=function(obj){var packet;if(typeof obj==="string"){packet=decodeString(obj);if(exports.BINARY_EVENT===packet.type||exports.BINARY_ACK===packet.type){this.reconstructor=new BinaryReconstructor(packet);if(this.reconstructor.reconPack.attachments===0){this.emit("decoded",packet)}}else{this.emit("decoded",packet)}}else if(isBuf(obj)||obj.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{packet=this.reconstructor.takeBinaryData(obj);if(packet){this.reconstructor=null;this.emit("decoded",packet)}}}else{throw new Error("Unknown type: "+obj)}};function decodeString(str){var i=0;var p={type:Number(str.charAt(0))};if(null==exports.types[p.type]){return error("unknown packet type "+p.type)}if(exports.BINARY_EVENT===p.type||exports.BINARY_ACK===p.type){var buf="";while(str.charAt(++i)!=="-"){buf+=str.charAt(i);if(i==str.length)break}if(buf!=Number(buf)||str.charAt(i)!=="-"){throw new Error("Illegal attachments")}p.attachments=Number(buf)}if("/"===str.charAt(i+1)){p.nsp="";while(++i){var c=str.charAt(i);if(","===c)break;p.nsp+=c;if(i===str.length)break}}else{p.nsp="/"}var next=str.charAt(i+1);if(""!==next&&Number(next)==next){p.id="";while(++i){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break}p.id+=str.charAt(i);if(i===str.length)break}p.id=Number(p.id)}if(str.charAt(++i)){var payload=tryParse(str.substr(i));var isPayloadValid=payload!==false&&(p.type===exports.ERROR||isArray(payload));if(isPayloadValid){p.data=payload}else{return error("invalid payload")}}debug("decoded %s as %j",str,p);return p}function tryParse(str){try{return JSON.parse(str)}catch(e){return false}}Decoder.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function BinaryReconstructor(packet){this.reconPack=packet;this.buffers=[]}BinaryReconstructor.prototype.takeBinaryData=function(binData){this.buffers.push(binData);if(this.buffers.length===this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return packet}return null};BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function error(msg){return{type:exports.ERROR,data:"parser error: "+msg}}},{"./binary":96,"./is-buffer":98,"component-emitter":53,debug:99,isarray:75}],98:[function(require,module,exports){(function(Buffer){module.exports=isBuf;var withNativeBuffer=typeof Buffer==="function"&&typeof Buffer.isBuffer==="function";var withNativeArrayBuffer=typeof ArrayBuffer==="function";var isView=function(obj){return typeof ArrayBuffer.isView==="function"?ArrayBuffer.isView(obj):obj.buffer instanceof ArrayBuffer};function isBuf(obj){return withNativeBuffer&&Buffer.isBuffer(obj)||withNativeArrayBuffer&&(obj instanceof ArrayBuffer||isView(obj))}}).call(this,require("buffer").Buffer)},{buffer:3}],99:[function(require,module,exports){arguments[4][65][0].apply(exports,arguments)},{"./debug":100,_process:5,dup:65}],100:[function(require,module,exports){arguments[4][66][0].apply(exports,arguments)},{dup:66,ms:78}],101:[function(require,module,exports){module.exports=toArray;function toArray(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++){array[i-index]=list[i]}return array}},{}],102:[function(require,module,exports){"use strict";var alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={},seed=0,i=0,prev;function encode(num){var encoded="";do{encoded=alphabet[num%length]+encoded;num=Math.floor(num/length)}while(num>0);return encoded}function decode(str){var decoded=0;for(i=0;i<str.length;i++){decoded=decoded*length+map[str.charAt(i)]}return decoded}function yeast(){var now=encode(+new Date);if(now!==prev)return seed=0,prev=now;return now+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode;yeast.decode=decode;module.exports=yeast},{}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var PIXI=require("pixijs");var io=require("socket.io-client");var Output_1=require("../../shared/Output");var Game=function(){function Game(){this._socket=io.connect();this._socket.on("server_message",function(data){Output_1.Output.Instance.Print("JSON message from the remote server: "+JSON.stringify(data))});var renderer=PIXI.autoDetectRenderer({width:300,height:300});document.body.appendChild(renderer.view);var stage=new PIXI.Container;PIXI.Loader.shared.add("../assets/zero.png").load(function(){var texture=PIXI.utils.TextureCache["../assets/zero.png"];var sprite=new PIXI.Sprite(texture);sprite.position.set(100,100);stage.addChild(sprite);renderer.render(stage)});renderer.render(stage)}return Game}();exports.Game=Game},{"../../shared/Output":105,pixijs:83,"socket.io-client":89}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Game_1=require("./Game");var Program=function(){function Program(){}Program.Main=function(){var game=new Game_1.Game};return Program}();window.onload=function(){return Program.Main()}},{"./Game":103}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Output=function(){function Output(){}Object.defineProperty(Output,"Instance",{get:function(){if(this._instance===undefined||this._instance===null){this._instance=new Output;this._instance.Initialize()}return this._instance},enumerable:true,configurable:true});Output.prototype.Print=function(text){this._output.innerHTML+=text;this._output.innerHTML+="<br>"};Output.prototype.Initialize=function(){this._output=document.getElementById("output");if(this._output===null){this._output=document.createElement("div");this._output.id="output";document.body.appendChild(this._output)}};return Output}();exports.Output=Output},{}]},{},[104]);